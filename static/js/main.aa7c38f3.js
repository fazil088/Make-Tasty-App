/*! For license information please see main.aa7c38f3.js.LICENSE.txt */
!function(){"use strict";var e={463:function(e,t,n){var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function k(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function j(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(1!==o||1!==u)do{if(o--,0>--u||i[o]!==a[u]){var s="\n"+i[o].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=o&&0<=u);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function q(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case b:return"Portal";case E:return"Profiler";case I:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function J(e,t){$(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,xe=null,Ie=null;function Ee(e){if(e=ki(e)){if("function"!==typeof be)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),be(e.stateNode,e.type,t))}}function Te(e){xe?Ie?Ie.push(e):Ie=[e]:xe=e}function Se(){if(xe){var e=xe,t=Ie;if(Ie=xe=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ce(e,t,n)}finally{Re=!1,(null!==xe||null!==Ie)&&(Ne(),Se())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var De=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){De=!1}function Le(e,t,n,r,i,a,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Me=!1,Fe=null,Ue=!1,Ve=null,je={onError:function(e){Me=!0,Fe=e}};function qe(e,t,n,r,i,a,o,u,s){Me=!1,Fe=null,Le.apply(je,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return We(i),e;if(o===r)return We(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var u=!1,s=i.child;s;){if(s===n){u=!0,n=i,r=o;break}if(s===r){u=!0,r=i,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=i;break}if(s===r){u=!0,r=o,n=i;break}s=s.sibling}if(!u)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,$e=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ut(e)/st|0)|0},ut=Math.log,st=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var u=o&~i;0!==u?r=ht(u):0!==(a&=o)&&(r=ht(a))}else 0!==(o=n&~i)?r=ht(o):0!==a&&(r=ht(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,bt,xt,It,Et,Tt=!1,St=[],Ct=null,Nt=null,Rt=null,At=new Map,Pt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&bt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=gi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void Et(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&bt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Vt(e,t,n){Ut(e)&&n.delete(t)}function jt(){Tt=!1,null!==Ct&&Ut(Ct)&&(Ct=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==Rt&&Ut(Rt)&&(Rt=null),At.forEach(Vt),Pt.forEach(Vt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function Bt(e){function t(t){return qt(t,e)}if(0<St.length){qt(St[0],e);for(var n=1;n<St.length;n++){var r=St[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&qt(Ct,e),null!==Nt&&qt(Nt,e),null!==Rt&&qt(Rt,e),At.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var zt=_.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=1,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Kt(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=4,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Gt(e,t,n,r){if(Wt){var i=Yt(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Mt(Ct,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return Rt=Mt(Rt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return At.set(a,Mt(At.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pt.set(a,Mt(Pt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var a=ki(i);if(null!==a&&wt(a),null===(a=Yt(e,t,n,r))&&Wr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=gi(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,i="value"in $t?$t.value:$t.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,un,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),hn=F({},cn,{view:0,detail:0}),fn=an(hn),dn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,un=e.screenY-sn.screenY):un=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:un}}),pn=an(dn),vn=an(F({},dn,{dataTransfer:0})),yn=an(F({},hn,{relatedTarget:0})),mn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(gn),_n=an(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function En(){return In}var Tn=F({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=an(Tn),Cn=an(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Rn=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(An),Dn=[9,13,27,32],On=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ln,Fn=l&&(!On||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Vn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Hn(e,t,n,r){Te(r),0<(t=Kr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Gn=null;function Qn(e){Ur(e,0)}function Yn(e){if(G(_i(e)))return e}function Xn(e,t){if("change"===e)return t}var $n=!1;if(l){var Jn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Gn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Hn(t,Gn,e,we(e)),Ae(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function ar(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,yr=null,mr=null,gr=null,kr=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==yr||yr!==Q(r)||("selectionStart"in(r=yr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Kr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},xr={},Ir={};function Er(e){if(xr[e])return xr[e];if(!br[e])return e;var t,n=br[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return xr[e]=n[t];return e}l&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Tr=Er("animationend"),Sr=Er("animationiteration"),Cr=Er("animationstart"),Nr=Er("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Rr.set(e,t),s(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Or=Ar[Dr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(Tr,"onAnimationEnd"),Pr(Sr,"onAnimationIteration"),Pr(Cr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,u,s,c){if(qe.apply(this,arguments),Me){if(!Me)throw Error(a(198));var l=Fe;Me=!1,Fe=null,Ue||(Ue=!0,Ve=l)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function Vr(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[qr]){e[qr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,jr("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Xt(t)){case 1:var i=Ht;break;case 4:i=Kt;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===i||8===u.nodeType&&u.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===i||8===s.nodeType&&s.parentNode===i))return;o=o.return}for(;null!==u;){if(null===(o=gi(u)))return;if(5===(s=o.tag)||6===s){r=a=o;continue e}u=u.parentNode}}r=r.return}Ae((function(){var r=a,i=we(n),o=[];e:{var u=Rr.get(e);if(void 0!==u){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=Sn;break;case"focusin":c="focus",s=yn;break;case"focusout":c="blur",s=yn;break;case"beforeblur":case"afterblur":s=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Nn;break;case Tr:case Sr:case Cr:s=mn;break;case Nr:s=Rn;break;case"scroll":s=fn;break;case"wheel":s=Pn;break;case"copy":case"cut":case"paste":s=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Cn}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==u?u+"Capture":null:u;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==f&&(null!=(v=Pe(p,f))&&l.push(Hr(p,v,d)))),h)break;p=p.return}0<l.length&&(u=new s(u,c,null,n,i),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!gi(c)&&!c[pi])&&(s||u)&&(u=i.window===i?i:(u=i.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?gi(c):null)&&(c!==(h=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=pn,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Cn,v="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==s?u:_i(s),d=null==c?u:_i(c),(u=new l(v,p+"leave",s,n,i)).target=h,u.relatedTarget=d,v=null,gi(i)===r&&((l=new l(f,p+"enter",c,n,i)).target=d,l.relatedTarget=h,v=l),h=v,s&&c)e:{for(f=c,p=0,d=l=s;d;d=Gr(d))p++;for(d=0,v=f;v;v=Gr(v))d++;for(;0<p-d;)l=Gr(l),p--;for(;0<d-p;)f=Gr(f),d--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=Gr(l),f=Gr(f)}l=null}else l=null;null!==s&&Qr(o,u,s,l,!1),null!==c&&null!==h&&Qr(o,h,c,l,!0)}if("select"===(s=(u=r?_i(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var y=Xn;else if(Wn(u))if($n)y=or;else{y=ir;var m=rr}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(y=ar);switch(y&&(y=y(e,r))?Hn(o,y,n,i):(m&&m(e,u,r),"focusout"===e&&(m=u._wrapperState)&&m.controlled&&"number"===u.type&&ee(u,"number",u.value)),m=r?_i(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(yr=m,mr=r,gr=null);break;case"focusout":gr=mr=yr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,_r(o,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":_r(o,n,i)}var g;if(On)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Bn?jn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Bn&&(g=en()):(Jt="value"in($t=i)?$t.value:$t.textContent,Bn=!0)),0<(m=Kr(r,k)).length&&(k=new _n(k,e,null,n,i),o.push({event:k,listeners:m}),g?k.data=g:null!==(g=qn(n))&&(k.data=g))),(g=Mn?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Un);case"textInput":return(e=t.data)===Un&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&jn(e,t)?(e=en(),Zt=Jt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Ur(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Pe(e,n))&&r.unshift(Hr(e,a,i)),null!=(a=Pe(e,t))&&r.push(Hr(e,a,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,i?null!=(s=Pe(n,a))&&o.unshift(Hr(n,s,u)):i||null!=(s=Pe(n,a))&&o.push(Hr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function Jr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(ui)}:ri;function ui(e){setTimeout((function(){throw e}))}function si(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,di="__reactProps$"+hi,pi="__reactContainer$"+hi,vi="__reactEvents$"+hi,yi="__reactListeners$"+hi,mi="__reactHandles$"+hi;function gi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[fi])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[fi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[di]||null}var bi=[],xi=-1;function Ii(e){return{current:e}}function Ei(e){0>xi||(e.current=bi[xi],bi[xi]=null,xi--)}function Ti(e,t){xi++,bi[xi]=e.current,e.current=t}var Si={},Ci=Ii(Si),Ni=Ii(!1),Ri=Si;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Si;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ei(Ni),Ei(Ci)}function Oi(e,t,n){if(Ci.current!==Si)throw Error(a(168));Ti(Ci,t),Ti(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,z(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Si,Ri=Ci.current,Ti(Ci,e),Ti(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Li(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ni),Ei(Ci),Ti(Ci,e)):Ei(Ni),Ti(Ni,n)}var Ui=null,Vi=!1,ji=!1;function qi(e){null===Ui?Ui=[e]:Ui.push(e)}function Bi(){if(!ji&&null!==Ui){ji=!0;var e=0,t=kt;try{var n=Ui;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Vi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ge(Ze,Bi),i}finally{kt=t,ji=!1}}return null}var zi=[],Wi=0,Hi=null,Ki=0,Gi=[],Qi=0,Yi=null,Xi=1,$i="";function Ji(e,t){zi[Wi++]=Ki,zi[Wi++]=Hi,Hi=e,Ki=t}function Zi(e,t,n){Gi[Qi++]=Xi,Gi[Qi++]=$i,Gi[Qi++]=Yi,Yi=e;var r=Xi;e=$i;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xi=1<<32-ot(t)+i|n<<i|r,$i=a+e}else Xi=1<<a|n<<i|r,$i=e}function ea(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ta(e){for(;e===Hi;)Hi=zi[--Wi],zi[Wi]=null,Ki=zi[--Wi],zi[Wi]=null;for(;e===Yi;)Yi=Gi[--Qi],Gi[Qi]=null,$i=Gi[--Qi],Gi[Qi]=null,Xi=Gi[--Qi],Gi[Qi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ua(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Xi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function sa(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!ua(e,t)){if(sa(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&ua(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(sa(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!ia)return la(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(sa(e))throw fa(),Error(a(418));for(;t;)oa(e,t),t=ci(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=ra;e;)e=ci(e.nextSibling)}function da(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var va=_.ReactCurrentBatchConfig;function ya(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=Ii(null),ga=null,ka=null,_a=null;function wa(){_a=ka=ga=null}function ba(e){var t=ma.current;Ei(ma),e._currentValue=t}function xa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t){ga=e,_a=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_u=!0),e.firstContext=null)}function Ea(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===ga)throw Error(a(308));ka=e,ga.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Ta=null;function Sa(e){null===Ta?Ta=[e]:Ta.push(e)}function Ca(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Sa(t)):(n.next=i.next,i.next=n),t.interleaved=n,Na(e,r)}function Na(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Aa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oa(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ns)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Na(e,n)}return null===(i=r.interleaved)?(t.next=t,Sa(r)):(t.next=i.next,i.next=t),r.interleaved=t,Na(e,n)}function La(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Ma(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fa(e,t,n,r){var i=e.updateQueue;Ra=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var s=u,c=s.next;s.next=null,null===o?a=c:o.next=c,o=s;var l=e.alternate;null!==l&&((u=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===u?l.firstBaseUpdate=c:u.next=c,l.lastBaseUpdate=s))}if(null!==a){var h=i.baseState;for(o=0,l=c=s=null,u=a;;){var f=u.lane,d=u.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:d,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var p=e,v=u;switch(f=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=v.payload)?p.call(d,h,f):p)||void 0===f)break e;h=F({},h,f);break e;case 2:Ra=!0}}null!==u.callback&&0!==u.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[u]:f.push(u))}else d={eventTime:d,lane:f,tag:u.tag,payload:u.payload,callback:u.callback,next:null},null===l?(c=l=d,s=h):l=l.next=d,o|=f;if(null===(u=u.next)){if(null===(u=i.shared.pending))break;u=(f=u).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===l&&(s=h),i.baseState=s,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Fs|=o,e.lanes=o,e.memoizedState=h}}function Ua(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Va=(new r.Component).refs;function ja(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var qa={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Da(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Oa(e,a,i))&&(rc(t,e,i,r),La(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Da(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Oa(e,a,i))&&(rc(t,e,i,r),La(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Da(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Oa(e,i,r))&&(rc(t,e,r,n),La(t,e,r))}};function Ba(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(i,a))}function za(e,t,n){var r=!1,i=Si,a=t.contextType;return"object"===typeof a&&null!==a?a=Ea(a):(i=Pi(t)?Ri:Ci.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Si),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qa.enqueueReplaceState(t,t.state,null)}function Ha(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Va,Aa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ea(a):(a=Pi(t)?Ri:Ci.current,i.context=Ai(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ja(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&qa.enqueueReplaceState(i,i.state,null),Fa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ka(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Va&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ga(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qa(e){return(0,e._init)(e._payload)}function Ya(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function u(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===x?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===P&&Qa(a)===t.type)?((r=i(t,n.props)).ref=Ka(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=Ka(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=Ka(e,null,t),n.return=e,n;case b:return(t=Vc(t,e.mode,n)).return=e,t;case P:return f(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Mc(t,e.mode,n,null)).return=e,t;Ga(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case b:return n.key===i?l(e,t,n,r):null;case P:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);Ga(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);Ga(t,r)}return null}function v(i,a,u,s){for(var c=null,l=null,h=a,v=a=0,y=null;null!==h&&v<u.length;v++){h.index>v?(y=h,h=null):y=h.sibling;var m=d(i,h,u[v],s);if(null===m){null===h&&(h=y);break}e&&h&&null===m.alternate&&t(i,h),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m,h=y}if(v===u.length)return n(i,h),ia&&Ji(i,v),c;if(null===h){for(;v<u.length;v++)null!==(h=f(i,u[v],s))&&(a=o(h,a,v),null===l?c=h:l.sibling=h,l=h);return ia&&Ji(i,v),c}for(h=r(i,h);v<u.length;v++)null!==(y=p(h,i,v,u[v],s))&&(e&&null!==y.alternate&&h.delete(null===y.key?v:y.key),a=o(y,a,v),null===l?c=y:l.sibling=y,l=y);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,v),c}function y(i,u,s,c){var l=L(s);if("function"!==typeof l)throw Error(a(150));if(null==(s=l.call(s)))throw Error(a(151));for(var h=l=null,v=u,y=u=0,m=null,g=s.next();null!==v&&!g.done;y++,g=s.next()){v.index>y?(m=v,v=null):m=v.sibling;var k=d(i,v,g.value,c);if(null===k){null===v&&(v=m);break}e&&v&&null===k.alternate&&t(i,v),u=o(k,u,y),null===h?l=k:h.sibling=k,h=k,v=m}if(g.done)return n(i,v),ia&&Ji(i,y),l;if(null===v){for(;!g.done;y++,g=s.next())null!==(g=f(i,g.value,c))&&(u=o(g,u,y),null===h?l=g:h.sibling=g,h=g);return ia&&Ji(i,y),l}for(v=r(i,v);!g.done;y++,g=s.next())null!==(g=p(v,i,y,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?y:g.key),u=o(g,u,y),null===h?l=g:h.sibling=g,h=g);return e&&v.forEach((function(e){return t(i,e)})),ia&&Ji(i,y),l}return function e(r,a,o,s){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=a;null!==l;){if(l.key===c){if((c=o.type)===x){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&Qa(c)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=Ka(r,l,o),a.return=r,r=a;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===x?((a=Mc(o.props.children,r.mode,s,o.key)).return=r,r=a):((s=Lc(o.type,o.key,o.props,null,r.mode,s)).ref=Ka(r,a,o),s.return=r,r=s)}return u(r);case b:e:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Vc(o,r.mode,s)).return=r,r=a}return u(r);case P:return e(r,a,(l=o._init)(o._payload),s)}if(te(o))return v(r,a,o,s);if(L(o))return y(r,a,o,s);Ga(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Uc(o,r.mode,s)).return=r,r=a),u(r)):n(r,a)}}var Xa=Ya(!0),$a=Ya(!1),Ja={},Za=Ii(Ja),eo=Ii(Ja),to=Ii(Ja);function no(e){if(e===Ja)throw Error(a(174));return e}function ro(e,t){switch(Ti(to,t),Ti(eo,e),Ti(Za,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Za),Ti(Za,t)}function io(){Ei(Za),Ei(eo),Ei(to)}function ao(e){no(to.current);var t=no(Za.current),n=se(t,e.type);t!==n&&(Ti(eo,e),Ti(Za,n))}function oo(e){eo.current===e&&(Ei(Za),Ei(eo))}var uo=Ii(0);function so(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=_.ReactCurrentDispatcher,fo=_.ReactCurrentBatchConfig,po=0,vo=null,yo=null,mo=null,go=!1,ko=!1,_o=0,wo=0;function bo(){throw Error(a(321))}function xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function Io(e,t,n,r,i,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?uu:su,e=n(r,i),ko){o=0;do{if(ko=!1,_o=0,25<=o)throw Error(a(301));o+=1,mo=yo=null,t.updateQueue=null,ho.current=cu,e=n(r,i)}while(ko)}if(ho.current=ou,t=null!==yo&&null!==yo.next,po=0,mo=yo=vo=null,go=!1,t)throw Error(a(300));return e}function Eo(){var e=0!==_o;return _o=0,e}function To(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function So(){if(null===yo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=yo.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,yo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(yo=e).memoizedState,baseState:yo.baseState,baseQueue:yo.baseQueue,queue:yo.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function Co(e,t){return"function"===typeof t?t(e):t}function No(e){var t=So(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=yo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var u=i.next;i.next=o.next,o.next=u}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var s=u=null,c=null,l=o;do{var h=l.lane;if((po&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=f,u=r):c=c.next=f,vo.lanes|=h,Fs|=h}l=l.next}while(null!==l&&l!==o);null===c?u=r:c.next=s,ur(r,t.memoizedState)||(_u=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,vo.lanes|=o,Fs|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=So(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var u=i=i.next;do{o=e(o,u.action),u=u.next}while(u!==i);ur(o,t.memoizedState)||(_u=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Po(e,t){var n=vo,r=So(),i=t(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,_u=!0),r=r.queue,Wo(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,Vo(9,Oo.bind(null,n,r,i,t),void 0,null),null===Rs)throw Error(a(349));0!==(30&po)||Do(n,t,i)}return i}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&Fo(e)}function Lo(e,t,n){return n((function(){Mo(t)&&Fo(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Fo(e){var t=Na(e,1);null!==t&&rc(t,e,1,-1)}function Uo(e){var t=To();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=nu.bind(null,vo,e),[t.memoizedState,e]}function Vo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function jo(){return So().memoizedState}function qo(e,t,n,r){var i=To();vo.flags|=e,i.memoizedState=Vo(1|t,n,void 0,void 0===r?null:r)}function Bo(e,t,n,r){var i=So();r=void 0===r?null:r;var a=void 0;if(null!==yo){var o=yo.memoizedState;if(a=o.destroy,null!==r&&xo(r,o.deps))return void(i.memoizedState=Vo(t,n,a,r))}vo.flags|=e,i.memoizedState=Vo(1|t,n,a,r)}function zo(e,t){return qo(8390656,8,e,t)}function Wo(e,t){return Bo(2048,8,e,t)}function Ho(e,t){return Bo(4,2,e,t)}function Ko(e,t){return Bo(4,4,e,t)}function Go(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4,4,Go.bind(null,t,e),n)}function Yo(){}function Xo(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,_u=!0),e.memoizedState=n):(ur(n,t)||(n=vt(),vo.lanes|=n,Fs|=n,e.baseState=!0),t)}function Zo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{kt=n,fo.transition=r}}function eu(){return So().memoizedState}function tu(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ru(e))iu(t,n);else if(null!==(n=Ca(e,t,n,r))){rc(n,e,r,tc()),au(n,t,r)}}function nu(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ru(e))iu(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,ur(u,o)){var s=t.interleaved;return null===s?(i.next=i,Sa(t)):(i.next=s.next,s.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ca(e,t,i,r))&&(rc(n,e,r,i=tc()),au(n,t,r))}}function ru(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function iu(e,t){ko=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function au(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var ou={readContext:Ea,useCallback:bo,useContext:bo,useEffect:bo,useImperativeHandle:bo,useInsertionEffect:bo,useLayoutEffect:bo,useMemo:bo,useReducer:bo,useRef:bo,useState:bo,useDebugValue:bo,useDeferredValue:bo,useTransition:bo,useMutableSource:bo,useSyncExternalStore:bo,useId:bo,unstable_isNewReconciler:!1},uu={readContext:Ea,useCallback:function(e,t){return To().memoizedState=[e,void 0===t?null:t],e},useContext:Ea,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return qo(4194308,4,e,t)},useInsertionEffect:function(e,t){return qo(4,2,e,t)},useMemo:function(e,t){var n=To();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=To();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tu.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},To().memoizedState=e},useState:Uo,useDebugValue:Yo,useDeferredValue:function(e){return To().memoizedState=e},useTransition:function(){var e=Uo(!1),t=e[0];return e=Zo.bind(null,e[1]),To().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,i=To();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Rs)throw Error(a(349));0!==(30&po)||Do(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,zo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,Vo(9,Oo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=To(),t=Rs.identifierPrefix;if(ia){var n=$i;t=":"+t+"R"+(n=(Xi&~(1<<32-ot(Xi)-1)).toString(32)+n),0<(n=_o++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},su={readContext:Ea,useCallback:Xo,useContext:Ea,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:$o,useReducer:No,useRef:jo,useState:function(){return No(Co)},useDebugValue:Yo,useDeferredValue:function(e){return Jo(So(),yo.memoizedState,e)},useTransition:function(){return[No(Co)[0],So().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Po,useId:eu,unstable_isNewReconciler:!1},cu={readContext:Ea,useCallback:Xo,useContext:Ea,useEffect:Wo,useImperativeHandle:Qo,useInsertionEffect:Ho,useLayoutEffect:Ko,useMemo:$o,useReducer:Ro,useRef:jo,useState:function(){return Ro(Co)},useDebugValue:Yo,useDeferredValue:function(e){var t=So();return null===yo?t.memoizedState=e:Jo(t,yo.memoizedState,e)},useTransition:function(){return[Ro(Co)[0],So().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Po,useId:eu,unstable_isNewReconciler:!1};function lu(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function hu(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var du="function"===typeof WeakMap?WeakMap:Map;function pu(e,t,n){(n=Da(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hs||(Hs=!0,Ks=r),fu(0,t)},n}function vu(e,t,n){(n=Da(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fu(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){fu(0,t),"function"!==typeof r&&(null===Gs?Gs=new Set([this]):Gs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new du;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function mu(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gu(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Da(-1,1)).tag=2,Oa(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ku=_.ReactCurrentOwner,_u=!1;function wu(e,t,n,r){t.child=null===e?$a(t,null,n,r):Xa(t,e.child,n,r)}function bu(e,t,n,r,i){n=n.render;var a=t.ref;return Ia(t,i),r=Io(e,t,n,r,a,i),n=Eo(),null===e||_u?(ia&&n&&ea(t),t.flags|=1,wu(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hu(e,t,i))}function xu(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Dc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Iu(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(o,r)&&e.ref===t.ref)return Hu(e,t,i)}return t.flags|=1,(e=Oc(a,r)).ref=t.ref,e.return=t,t.child=e}function Iu(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(sr(a,r)&&e.ref===t.ref){if(_u=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Hu(e,t,i);0!==(131072&e.flags)&&(_u=!0)}}return Su(e,t,n,r,i)}function Eu(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Os,Ds),Ds|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Os,Ds),Ds|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ti(Os,Ds),Ds|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ti(Os,Ds),Ds|=r;return wu(e,t,i,n),t.child}function Tu(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Su(e,t,n,r,i){var a=Pi(n)?Ri:Ci.current;return a=Ai(t,a),Ia(t,i),n=Io(e,t,n,r,a,i),r=Eo(),null===e||_u?(ia&&r&&ea(t),t.flags|=1,wu(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hu(e,t,i))}function Cu(e,t,n,r,i){if(Pi(n)){var a=!0;Mi(t)}else a=!1;if(Ia(t,i),null===t.stateNode)Wu(e,t),za(t,n,r),Ha(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ea(c):c=Ai(t,c=Pi(n)?Ri:Ci.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&Wa(t,o,r,c),Ra=!1;var f=t.memoizedState;o.state=f,Fa(t,r,o,i),s=t.memoizedState,u!==r||f!==s||Ni.current||Ra?("function"===typeof l&&(ja(t,n,l,r),s=t.memoizedState),(u=Ra||Ba(t,n,u,r,f,s,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Pa(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:ya(t.type,u),o.props=c,h=t.pendingProps,f=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=Ea(s):s=Ai(t,s=Pi(n)?Ri:Ci.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==h||f!==s)&&Wa(t,o,r,s),Ra=!1,f=t.memoizedState,o.state=f,Fa(t,r,o,i);var p=t.memoizedState;u!==h||f!==p||Ni.current||Ra?("function"===typeof d&&(ja(t,n,d,r),p=t.memoizedState),(c=Ra||Ba(t,n,c,r,f,p,s)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Nu(e,t,n,r,a,i)}function Nu(e,t,n,r,i,a){Tu(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Hu(e,t,a);r=t.stateNode,ku.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Xa(t,e.child,null,a),t.child=Xa(t,null,u,a)):wu(e,t,u,a),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ru(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),ro(e,t.containerInfo)}function Au(e,t,n,r,i){return da(),pa(i),t.flags|=256,wu(e,t,n,r),t.child}var Pu,Du,Ou,Lu,Mu={dehydrated:null,treeContext:null,retryLane:0};function Fu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uu(e,t,n){var r,i=t.pendingProps,o=uo.current,u=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(u=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(uo,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=i.children,e=i.fallback,u?(i=t.mode,u=t.child,s={mode:"hidden",children:s},0===(1&i)&&null!==u?(u.childLanes=0,u.pendingProps=s):u=Fc(s,i,0,null),e=Mc(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=Fu(n),t.memoizedState=Mu,e):Vu(t,s));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,u){if(n)return 256&t.flags?(t.flags&=-257,ju(e,t,u,r=hu(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(o=Mc(o,i,u,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Xa(t,e.child,null,u),t.child.memoizedState=Fu(u),t.memoizedState=Mu,o);if(0===(1&t.mode))return ju(e,t,u,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var s=r.dgst;return r=s,ju(e,t,u,r=hu(o=Error(a(419)),r,void 0))}if(s=0!==(u&e.childLanes),_u||s){if(null!==(r=Rs)){switch(u&-u){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|u))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Na(e,i),rc(r,e,i,-1))}return yc(),ju(e,t,u,r=hu(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Gi[Qi++]=Xi,Gi[Qi++]=$i,Gi[Qi++]=Yi,Xi=e.id,$i=e.overflow,Yi=t),t=Vu(t,r.children),t.flags|=4096,t)}(e,t,s,i,r,o,n);if(u){u=i.fallback,s=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&s)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?u=Oc(r,u):(u=Mc(u,s,n,null)).flags|=2,u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,s=null===(s=e.child.memoizedState)?Fu(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},u.memoizedState=s,u.childLanes=e.childLanes&~n,t.memoizedState=Mu,i}return e=(u=e.child).sibling,i=Oc(u,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Vu(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function ju(e,t,n,r){return null!==r&&pa(r),Xa(t,e.child,null,n),(e=Vu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qu(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xa(e.return,t,n)}function Bu(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function zu(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(wu(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qu(e,n,t);else if(19===e.tag)qu(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(uo,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===so(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bu(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===so(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bu(t,!0,n,null,a);break;case"together":Bu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wu(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fs|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ku(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qu(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gu(t),null;case 1:case 17:return Pi(t.type)&&Di(),Gu(t),null;case 3:return r=t.stateNode,io(),Ei(Ni),Ei(Ci),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(uc(aa),aa=null))),Du(e,t),Gu(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ou(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Gu(t),null}if(e=no(Za.current),ha(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fi]=t,r[di]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":X(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var s in ge(n,o),i=null,o)if(o.hasOwnProperty(s)){var c=o[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):u.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&Vr("scroll",r)}switch(n){case"input":K(r),Z(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ue(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[fi]=t,e[di]=r,Pu(e,t,!1,!1),t.stateNode=e;e:{switch(s=ke(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":X(e,r),i=Y(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ge(n,i),c=i)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ye(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Vr("scroll",e):null!=l&&k(e,o,l,s))}switch(n){case"input":K(e),Z(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gu(t),null;case 6:if(e&&null!=t.stateNode)Lu(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=no(to.current),no(Za.current),ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return Gu(t),null;case 13:if(Ei(uo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))fa(),da(),t.flags|=98560,o=!1;else if(o=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[fi]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gu(t),o=!1}else null!==aa&&(uc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&uo.current)?0===Ls&&(Ls=3):yc())),null!==t.updateQueue&&(t.flags|=4),Gu(t),null);case 4:return io(),Du(e,t),null===e&&Br(t.stateNode.containerInfo),Gu(t),null;case 10:return ba(t.type._context),Gu(t),null;case 19:if(Ei(uo),null===(o=t.memoizedState))return Gu(t),null;if(r=0!==(128&t.flags),null===(s=o.rendering))if(r)Ku(o,!1);else{if(0!==Ls||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=so(e))){for(t.flags|=128,Ku(o,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(uo,1&uo.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>zs&&(t.flags|=128,r=!0,Ku(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=so(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ku(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!ia)return Gu(t),null}else 2*$e()-o.renderingStartTime>zs&&1073741824!==n&&(t.flags|=128,r=!0,Ku(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=uo.current,Ti(uo,r?1&n|2:1&n),t):(Gu(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ds)&&(Gu(t),6&t.subtreeFlags&&(t.flags|=8192)):Gu(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Yu(e,t){switch(ta(t),t.tag){case 1:return Pi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Ei(Ni),Ei(Ci),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ei(uo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(uo),null;case 4:return io(),null;case 10:return ba(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Pu=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Du=function(){},Ou=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Za.current);var a,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ge(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(u.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(a in s)!s.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&s[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(u.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Vr("scroll",e),o||s===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Lu=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xu=!1,$u=!1,Ju="function"===typeof WeakSet?WeakSet:Set,Zu=null;function es(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function ts(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var ns=!1;function rs(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&ts(t,n,a)}i=i.next}while(i!==r)}}function is(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function as(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function os(e){var t=e.alternate;null!==t&&(e.alternate=null,os(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[di],delete t[vi],delete t[yi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function us(e){return 5===e.tag||3===e.tag||4===e.tag}function ss(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||us(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cs(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cs(e,t,n),e=e.sibling;null!==e;)cs(e,t,n),e=e.sibling}function ls(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ls(e,t,n),e=e.sibling;null!==e;)ls(e,t,n),e=e.sibling}var hs=null,fs=!1;function ds(e,t,n){for(n=n.child;null!==n;)ps(e,t,n),n=n.sibling}function ps(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(u){}switch(n.tag){case 5:$u||es(n,t);case 6:var r=hs,i=fs;hs=null,ds(e,t,n),fs=i,null!==(hs=r)&&(fs?(e=hs,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hs.removeChild(n.stateNode));break;case 18:null!==hs&&(fs?(e=hs,n=n.stateNode,8===e.nodeType?si(e.parentNode,n):1===e.nodeType&&si(e,n),Bt(e)):si(hs,n.stateNode));break;case 4:r=hs,i=fs,hs=n.stateNode.containerInfo,fs=!0,ds(e,t,n),hs=r,fs=i;break;case 0:case 11:case 14:case 15:if(!$u&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&ts(n,t,o),i=i.next}while(i!==r)}ds(e,t,n);break;case 1:if(!$u&&(es(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ec(n,t,u)}ds(e,t,n);break;case 21:ds(e,t,n);break;case 22:1&n.mode?($u=(r=$u)||null!==n.memoizedState,ds(e,t,n),$u=r):ds(e,t,n);break;default:ds(e,t,n)}}function vs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ju),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ys(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,u=t,s=u;e:for(;null!==s;){switch(s.tag){case 5:hs=s.stateNode,fs=!1;break e;case 3:case 4:hs=s.stateNode.containerInfo,fs=!0;break e}s=s.return}if(null===hs)throw Error(a(160));ps(o,u,i),hs=null,fs=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Ec(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ms(t,e),t=t.sibling}function ms(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ys(t,e),gs(e),4&r){try{rs(3,e,e.return),is(3,e)}catch(y){Ec(e,e.return,y)}try{rs(5,e,e.return)}catch(y){Ec(e,e.return,y)}}break;case 1:ys(t,e),gs(e),512&r&&null!==n&&es(n,n.return);break;case 5:if(ys(t,e),gs(e),512&r&&null!==n&&es(n,n.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(y){Ec(e,e.return,y)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,u=null!==n?n.memoizedProps:o,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===o.type&&null!=o.name&&$(i,o),ke(s,u);var l=ke(s,o);for(u=0;u<c.length;u+=2){var h=c[u],f=c[u+1];"style"===h?ye(i,f):"dangerouslySetInnerHTML"===h?he(i,f):"children"===h?fe(i,f):k(i,h,f,l)}switch(s){case"input":J(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[di]=o}catch(y){Ec(e,e.return,y)}}break;case 6:if(ys(t,e),gs(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(y){Ec(e,e.return,y)}}break;case 3:if(ys(t,e),gs(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(y){Ec(e,e.return,y)}break;case 4:default:ys(t,e),gs(e);break;case 13:ys(t,e),gs(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Bs=$e())),4&r&&vs(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($u=(l=$u)||h,ys(t,e),$u=l):ys(t,e),gs(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!h&&0!==(1&e.mode))for(Zu=e,h=e.child;null!==h;){for(f=Zu=h;null!==Zu;){switch(p=(d=Zu).child,d.tag){case 0:case 11:case 14:case 15:rs(4,d,d.return);break;case 1:es(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(y){Ec(r,n,y)}}break;case 5:es(d,d.return);break;case 22:if(null!==d.memoizedState){bs(f);continue}}null!==p?(p.return=d,Zu=p):bs(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,l?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(s=f.stateNode,u=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",u))}catch(y){Ec(e,e.return,y)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(y){Ec(e,e.return,y)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ys(t,e),gs(e),4&r&&vs(e);case 21:}}function gs(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(us(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(fe(i,""),r.flags&=-33),ls(e,ss(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cs(e,ss(e),o);break;default:throw Error(a(161))}}catch(u){Ec(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ks(e,t,n){Zu=e,_s(e,t,n)}function _s(e,t,n){for(var r=0!==(1&e.mode);null!==Zu;){var i=Zu,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Xu;if(!o){var u=i.alternate,s=null!==u&&null!==u.memoizedState||$u;u=Xu;var c=$u;if(Xu=o,($u=s)&&!c)for(Zu=i;null!==Zu;)s=(o=Zu).child,22===o.tag&&null!==o.memoizedState?xs(i):null!==s?(s.return=o,Zu=s):xs(i);for(;null!==a;)Zu=a,_s(a,t,n),a=a.sibling;Zu=i,Xu=u,$u=c}ws(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Zu=a):ws(e)}}function ws(e){for(;null!==Zu;){var t=Zu;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$u||is(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$u)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ya(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ua(t,o,r);break;case 3:var u=t.updateQueue;if(null!==u){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ua(t,u,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&Bt(f)}}}break;default:throw Error(a(163))}$u||512&t.flags&&as(t)}catch(d){Ec(t,t.return,d)}}if(t===e){Zu=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zu=n;break}Zu=t.return}}function bs(e){for(;null!==Zu;){var t=Zu;if(t===e){Zu=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zu=n;break}Zu=t.return}}function xs(e){for(;null!==Zu;){var t=Zu;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{is(4,t)}catch(s){Ec(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(s){Ec(t,i,s)}}var a=t.return;try{as(t)}catch(s){Ec(t,a,s)}break;case 5:var o=t.return;try{as(t)}catch(s){Ec(t,o,s)}}}catch(s){Ec(t,t.return,s)}if(t===e){Zu=null;break}var u=t.sibling;if(null!==u){u.return=t.return,Zu=u;break}Zu=t.return}}var Is,Es=Math.ceil,Ts=_.ReactCurrentDispatcher,Ss=_.ReactCurrentOwner,Cs=_.ReactCurrentBatchConfig,Ns=0,Rs=null,As=null,Ps=0,Ds=0,Os=Ii(0),Ls=0,Ms=null,Fs=0,Us=0,Vs=0,js=null,qs=null,Bs=0,zs=1/0,Ws=null,Hs=!1,Ks=null,Gs=null,Qs=!1,Ys=null,Xs=0,$s=0,Js=null,Zs=-1,ec=0;function tc(){return 0!==(6&Ns)?$e():-1!==Zs?Zs:Zs=$e()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Ns)&&0!==Ps?Ps&-Ps:null!==va.transition?(0===ec&&(ec=vt()),ec):0!==(e=kt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,n,r){if(50<$s)throw $s=0,Js=null,Error(a(185));mt(e,n,r),0!==(2&Ns)&&e===Rs||(e===Rs&&(0===(2&Ns)&&(Us|=n),4===Ls&&sc(e,Ps)),ic(e,r),1===n&&0===Ns&&0===(1&t.mode)&&(zs=$e()+500,Vi&&Bi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),u=1<<o,s=i[o];-1===s?0!==(u&n)&&0===(u&r)||(i[o]=dt(u,t)):s<=t&&(e.expiredLanes|=u),a&=~u}}(e,t);var r=ft(e,e===Rs?Ps:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Vi=!0,qi(e)}(cc.bind(null,e)):qi(cc.bind(null,e)),oi((function(){0===(6&Ns)&&Bi()})),n=null;else{switch(_t(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Zs=-1,ec=0,0!==(6&Ns))throw Error(a(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=ft(e,e===Rs?Ps:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var i=Ns;Ns|=2;var o=vc();for(Rs===e&&Ps===t||(Ws=null,zs=$e()+500,dc(e,t));;)try{kc();break}catch(s){pc(e,s)}wa(),Ts.current=o,Ns=i,null!==As?t=0:(Rs=null,Ps=0,t=Ls)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=oc(e,i))),1===t)throw n=Ms,dc(e,0),sc(e,r),ic(e,$e()),n;if(6===t)sc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ur(a(),i))return!1}catch(u){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Ms,dc(e,0),sc(e,r),ic(e,$e()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:bc(e,qs,Ws);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Bs+500-$e())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bc.bind(null,e,qs,Ws),t);break}bc(e,qs,Ws);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var u=31-ot(r);o=1<<u,(u=t[u])>i&&(i=u),r&=~o}if(r=i,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Es(r/1960))-r)){e.timeoutHandle=ri(bc.bind(null,e,qs,Ws),r);break}bc(e,qs,Ws);break;default:throw Error(a(329))}}}return ic(e,$e()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=js;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=qs,qs=n,null!==t&&uc(t)),e}function uc(e){null===qs?qs=e:qs.push.apply(qs,e)}function sc(e,t){for(t&=~Vs,t&=~Us,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Ns))throw Error(a(327));xc();var t=ft(e,0);if(0===(1&t))return ic(e,$e()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ms,dc(e,0),sc(e,t),ic(e,$e()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,qs,Ws),ic(e,$e()),null}function lc(e,t){var n=Ns;Ns|=1;try{return e(t)}finally{0===(Ns=n)&&(zs=$e()+500,Vi&&Bi())}}function hc(e){null!==Ys&&0===Ys.tag&&0===(6&Ns)&&xc();var t=Ns;Ns|=1;var n=Cs.transition,r=kt;try{if(Cs.transition=null,kt=1,e)return e()}finally{kt=r,Cs.transition=n,0===(6&(Ns=t))&&Bi()}}function fc(){Ds=Os.current,Ei(Os)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==As)for(n=As.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:io(),Ei(Ni),Ei(Ci),lo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Ei(uo);break;case 10:ba(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Rs=e,As=e=Oc(e.current,null),Ps=Ds=t,Ls=0,Ms=null,Vs=Us=Fs=0,qs=js=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(r=(n=Ta[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ta=null}return e}function pc(e,t){for(;;){var n=As;try{if(wa(),ho.current=ou,go){for(var r=vo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}go=!1}if(po=0,mo=yo=vo=null,ko=!1,_o=0,Ss.current=null,null===n||null===n.return){Ls=1,Ms=t,As=null;break}e:{var o=e,u=n.return,s=n,c=t;if(t=Ps,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=s,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=mu(u);if(null!==p){p.flags&=-257,gu(p,u,s,0,t),1&p.mode&&yu(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break e}if(0===(1&t)){yu(o,l,t),yc();break e}c=Error(a(426))}else if(ia&&1&s.mode){var m=mu(u);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),gu(m,u,s,0,t),pa(lu(c,s));break e}}o=c=lu(c,s),4!==Ls&&(Ls=2),null===js?js=[o]:js.push(o),o=u;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ma(o,pu(0,c,t));break e;case 1:s=c;var g=o.type,k=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Gs||!Gs.has(k)))){o.flags|=65536,t&=-t,o.lanes|=t,Ma(o,vu(o,s,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(_){t=_,As===n&&null!==n&&(As=n=n.return);continue}break}}function vc(){var e=Ts.current;return Ts.current=ou,null===e?ou:e}function yc(){0!==Ls&&3!==Ls&&2!==Ls||(Ls=4),null===Rs||0===(268435455&Fs)&&0===(268435455&Us)||sc(Rs,Ps)}function mc(e,t){var n=Ns;Ns|=2;var r=vc();for(Rs===e&&Ps===t||(Ws=null,dc(e,t));;)try{gc();break}catch(i){pc(e,i)}if(wa(),Ns=n,Ts.current=r,null!==As)throw Error(a(261));return Rs=null,Ps=0,Ls}function gc(){for(;null!==As;)_c(As)}function kc(){for(;null!==As&&!Ye();)_c(As)}function _c(e){var t=Is(e.alternate,e,Ds);e.memoizedProps=e.pendingProps,null===t?wc(e):As=t,Ss.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qu(n,t,Ds)))return void(As=n)}else{if(null!==(n=Yu(n,t)))return n.flags&=32767,void(As=n);if(null===e)return Ls=6,void(As=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(As=t);As=t=e}while(null!==t);0===Ls&&(Ls=5)}function bc(e,t,n){var r=kt,i=Cs.transition;try{Cs.transition=null,kt=1,function(e,t,n,r){do{xc()}while(null!==Ys);if(0!==(6&Ns))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Rs&&(As=Rs=null,Ps=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Qs||(Qs=!0,Rc(tt,(function(){return xc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cs.transition,Cs.transition=null;var u=kt;kt=1;var s=Ns;Ns|=4,Ss.current=null,function(e,t){if(ei=Wt,dr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var u=0,s=-1,c=-1,l=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==i&&3!==f.nodeType||(s=u+i),f!==o||0!==r&&3!==f.nodeType||(c=u+r),3===f.nodeType&&(u+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++l===i&&(s=u),d===o&&++h===r&&(c=u),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Zu=t;null!==Zu;)if(e=(t=Zu).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zu=e;else for(;null!==Zu;){t=Zu;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var y=v.memoizedProps,m=v.memoizedState,g=t.stateNode,k=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:ya(t.type,y),m);g.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(w){Ec(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zu=e;break}Zu=t.return}v=ns,ns=!1}(e,n),ms(n,e),pr(ti),Wt=!!ei,ti=ei=null,e.current=n,ks(n,e,i),Xe(),Ns=s,kt=u,Cs.transition=o}else e.current=n;if(Qs&&(Qs=!1,Ys=e,Xs=i),o=e.pendingLanes,0===o&&(Gs=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hs)throw Hs=!1,e=Ks,Ks=null,e;0!==(1&Xs)&&0!==e.tag&&xc(),o=e.pendingLanes,0!==(1&o)?e===Js?$s++:($s=0,Js=e):$s=0,Bi()}(e,t,n,r)}finally{Cs.transition=i,kt=r}return null}function xc(){if(null!==Ys){var e=_t(Xs),t=Cs.transition,n=kt;try{if(Cs.transition=null,kt=16>e?16:e,null===Ys)var r=!1;else{if(e=Ys,Ys=null,Xs=0,0!==(6&Ns))throw Error(a(331));var i=Ns;for(Ns|=4,Zu=e.current;null!==Zu;){var o=Zu,u=o.child;if(0!==(16&Zu.flags)){var s=o.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Zu=l;null!==Zu;){var h=Zu;switch(h.tag){case 0:case 11:case 15:rs(8,h,o)}var f=h.child;if(null!==f)f.return=h,Zu=f;else for(;null!==Zu;){var d=(h=Zu).sibling,p=h.return;if(os(h),h===l){Zu=null;break}if(null!==d){d.return=p,Zu=d;break}Zu=p}}}var v=o.alternate;if(null!==v){var y=v.child;if(null!==y){v.child=null;do{var m=y.sibling;y.sibling=null,y=m}while(null!==y)}}Zu=o}}if(0!==(2064&o.subtreeFlags)&&null!==u)u.return=o,Zu=u;else e:for(;null!==Zu;){if(0!==(2048&(o=Zu).flags))switch(o.tag){case 0:case 11:case 15:rs(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Zu=g;break e}Zu=o.return}}var k=e.current;for(Zu=k;null!==Zu;){var _=(u=Zu).child;if(0!==(2064&u.subtreeFlags)&&null!==_)_.return=u,Zu=_;else e:for(u=k;null!==Zu;){if(0!==(2048&(s=Zu).flags))try{switch(s.tag){case 0:case 11:case 15:is(9,s)}}catch(b){Ec(s,s.return,b)}if(s===u){Zu=null;break e}var w=s.sibling;if(null!==w){w.return=s.return,Zu=w;break e}Zu=s.return}}if(Ns=i,Bi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(b){}r=!0}return r}finally{kt=n,Cs.transition=t}}return!1}function Ic(e,t,n){e=Oa(e,t=pu(0,t=lu(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),ic(e,t))}function Ec(e,t,n){if(3===e.tag)Ic(e,e,n);else for(;null!==t;){if(3===t.tag){Ic(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gs||!Gs.has(r))){t=Oa(t,e=vu(t,e=lu(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),ic(t,e));break}}t=t.return}}function Tc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Rs===e&&(Ps&n)===n&&(4===Ls||3===Ls&&(130023424&Ps)===Ps&&500>$e()-Bs?dc(e,0):Vs|=n),ic(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Na(e,t))&&(mt(e,t,n),ic(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Sc(e,n)}function Rc(e,t){return Ge(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var u=2;if(r=e,"function"===typeof e)Dc(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case x:return Mc(n.children,i,o,t);case I:u=8,i|=8;break;case E:return(e=Pc(12,n,t,2|i)).elementType=E,e.lanes=o,e;case N:return(e=Pc(13,n,t,i)).elementType=N,e.lanes=o,e;case R:return(e=Pc(19,n,t,i)).elementType=R,e.lanes=o,e;case D:return Fc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:u=10;break e;case S:u=9;break e;case C:u=11;break e;case A:u=14;break e;case P:u=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Pc(u,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qc(e,t,n,r,i,a,o,u,s){return e=new jc(e,t,n,u,s),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Pc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Aa(a),e}function Bc(e){if(!e)return Si;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Li(e,n,t)}return t}function zc(e,t,n,r,i,a,o,u,s){return(e=qc(n,r,!0,e,0,a,0,u,s)).context=Bc(null),n=e.current,(a=Da(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Oa(n,a,i),e.current.lanes=i,mt(e,i,r),ic(e,r),e}function Wc(e,t,n,r){var i=t.current,a=tc(),o=nc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Da(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oa(i,t,o))&&(rc(e,i,o,a),La(e,i,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}Is=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)_u=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _u=!1,function(e,t,n){switch(t.tag){case 3:Ru(t),da();break;case 5:ao(t);break;case 1:Pi(t.type)&&Mi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(uo,1&uo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uu(e,t,n):(Ti(uo,1&uo.current),null!==(e=Hu(e,t,n))?e.sibling:null);Ti(uo,1&uo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return zu(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Eu(e,t,n)}return Hu(e,t,n)}(e,t,n);_u=0!==(131072&e.flags)}else _u=!1,ia&&0!==(1048576&t.flags)&&Zi(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wu(e,t),e=t.pendingProps;var i=Ai(t,Ci.current);Ia(t,n),i=Io(null,t,r,e,i,n);var o=Eo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Aa(t),i.updater=qa,t.stateNode=i,i._reactInternals=t,Ha(t,r,e,n),t=Nu(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),wu(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wu(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=ya(r,e),i){case 0:t=Su(null,t,r,e,n);break e;case 1:t=Cu(null,t,r,e,n);break e;case 11:t=bu(null,t,r,e,n);break e;case 14:t=xu(null,t,r,ya(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Su(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 1:return r=t.type,i=t.pendingProps,Cu(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 3:e:{if(Ru(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Pa(e,t),Fa(t,r,null,n);var u=t.memoizedState;if(r=u.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Au(e,t,r,n,i=lu(Error(a(423)),t));break e}if(r!==i){t=Au(e,t,r,n,i=lu(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=$a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===i){t=Hu(e,t,n);break e}wu(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&ca(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,u=i.children,ni(r,i)?u=null:null!==o&&ni(r,o)&&(t.flags|=32),Tu(e,t),wu(e,t,u,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Uu(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Xa(t,null,r,n):wu(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,bu(e,t,r,i=t.elementType===r?i:ya(r,i),n);case 7:return wu(e,t,t.pendingProps,n),t.child;case 8:case 12:return wu(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,u=i.value,Ti(ma,r._currentValue),r._currentValue=u,null!==o)if(ur(o.value,u)){if(o.children===i.children&&!Ni.current){t=Hu(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var s=o.dependencies;if(null!==s){u=o.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Da(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),xa(o.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===o.tag)u=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(u=o.return))throw Error(a(341));u.lanes|=n,null!==(s=u.alternate)&&(s.lanes|=n),xa(u,n,t),u=o.sibling}else u=o.child;if(null!==u)u.return=o;else for(u=o;null!==u;){if(u===t){u=null;break}if(null!==(o=u.sibling)){o.return=u.return,u=o;break}u=u.return}o=u}wu(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ia(t,n),r=r(i=Ea(i)),t.flags|=1,wu(e,t,r,n),t.child;case 14:return i=ya(r=t.type,t.pendingProps),xu(e,t,r,i=ya(r.type,i),n);case 15:return Iu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ya(r,i),Wu(e,t),t.tag=1,Pi(r)?(e=!0,Mi(t)):e=!1,Ia(t,n),za(t,r,i),Ha(t,r,i,n),Nu(null,t,r,!0,e,n);case 19:return zu(e,t,n);case 22:return Eu(e,t,n)}throw Error(a(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function el(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var u=i;i=function(){var e=Hc(o);u.call(e)}}Wc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Hc(o);a.call(e)}}var o=zc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[pi]=o.current,Br(8===e.nodeType?e.parentNode:e),hc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var u=r;r=function(){var e=Hc(s);u.call(e)}}var s=qc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=s,e[pi]=s.current,Br(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,s,n,r)})),s}(n,t,e,i,r);return Hc(o)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wc(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[pi]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(gt(t,1|n),ic(t,$e()),0===(6&Ns)&&(zs=$e()+500,Bi()))}break;case 13:hc((function(){var t=Na(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Gc(e,1)}},bt=function(e){if(13===e.tag){var t=Na(e,134217728);if(null!==t)rc(t,e,134217728,tc());Gc(e,134217728)}},xt=function(e){if(13===e.tag){var t=nc(e),n=Na(e,t);if(null!==n)rc(n,e,t,tc());Gc(e,t)}},It=function(){return kt},Et=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},be=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(a(90));G(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=lc,Ne=hc;var tl={usingClientEntryPoint:!1,Events:[ki,_i,wi,Te,Se,lc]},nl={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(rl),at=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(a(299));var n=!1,r="",i=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=qc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",u=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(u=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,o,u),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(hc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:u.current}}t.jsx=c,t.jsxs=c},117:function(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function g(){}function k(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var _=k.prototype=new g;_.constructor=k,v(_,m.prototype),_.isPureReactComponent=!0;var w=Array.isArray,b=Object.prototype.hasOwnProperty,x={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,a={},o=null,u=null;if(null!=t)for(i in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)b.call(t,i)&&!I.hasOwnProperty(i)&&(a[i]=t[i]);var s=arguments.length-2;if(1===s)a.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===a[i]&&(a[i]=s[i]);return{$$typeof:n,type:e,key:o,ref:u,props:a,_owner:x.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,a,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return o=o(s=e),e=""===a?"."+C(s,0):a,w(o)?(i="",null!=e&&(i=e.replace(S,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(s=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var l=a+C(u=e[c],c);s+=N(u,t,i,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=N(u=u.value,t,i,l=a+C(u,c++),o);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function R(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:x};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=k,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=x.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)b.call(t,c)&&!I.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];i.children=s}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:u}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){e.exports=n(117)},184:function(e,t,n){e.exports=n(374)},813:function(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var u=2*(r+1)-1,s=e[u],c=u+1,l=e[c];if(0>a(s,n))c<i&&0>a(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[u]=n,r=u);else{if(!(c<i&&0>a(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var c=[],l=[],h=1,f=null,d=3,p=!1,v=!1,y=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(y=!1,_(e),!v)if(null!==r(c))v=!0,D(b);else{var t=r(l);null!==t&&O(w,t.startTime-e)}}function b(e,n){v=!1,y&&(y=!1,g(T),T=-1),p=!0;var a=d;try{for(_(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!N());){var o=f.callback;if("function"===typeof o){f.callback=null,d=f.priorityLevel;var u=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?f.callback=u:f===r(c)&&i(c),_(n)}else i(c);f=r(c)}if(null!==f)var s=!0;else{var h=r(l);null!==h&&O(w,h.startTime-n),s=!1}return s}finally{f=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,I=!1,E=null,T=-1,S=5,C=-1;function N(){return!(t.unstable_now()-C<S)}function R(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?x():(I=!1,E=null)}}else I=!1}if("function"===typeof k)x=function(){k(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=R,x=function(){P.postMessage(null)}}else x=function(){m(R,0)};function D(e){E=e,I||(I=!0,x())}function O(e,n){T=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,D(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:u=a+u,sortIndex:-1},a>o?(e.sortIndex=a,n(l,e),null===r(c)&&e===r(l)&&(y?(g(T),T=-1):y=!0,O(w,a-o))):(e.sortIndex=u,n(c,e),v||p||(v=!0,D(b))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},296:function(e,t,n){e.exports=n(813)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/Make-Tasty-App/",function(){var e={};n.r(e),n.d(e,{FirebaseError:function(){return Wt},SDK_VERSION:function(){return vr},_DEFAULT_ENTRY_NAME:function(){return nr},_addComponent:function(){return or},_addOrOverwriteComponent:function(){return ur},_apps:function(){return ir},_clearComponents:function(){return hr},_components:function(){return ar},_getProvider:function(){return cr},_registerComponent:function(){return sr},_removeServiceInstance:function(){return lr},deleteApp:function(){return kr},getApp:function(){return mr},getApps:function(){return gr},initializeApp:function(){return yr},onLog:function(){return br},registerVersion:function(){return wr},setLogLevel:function(){return xr}});var t,r=n(791),i=n(250);function a(e){if(Array.isArray(e))return e}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){return a(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,u=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(l){c=!0,i=l}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return u}}(e,t)||u(e,t)||s()}function l(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e){return function(e){if(Array.isArray(e))return o(e)}(e)||l(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function y(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function g(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){var t=_();return function(){var n,r=k(e);if(t){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,n)}}function x(e,t,n){return x=_()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&m(i,n.prototype),i},x.apply(null,arguments)}function I(e){var t="function"===typeof Map?new Map:void 0;return I=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return x(e,arguments,k(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),m(n,e)},I(e)}function E(e){return a(e)||l(e)||u(e)||s()}function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(t||(t={}));var C,N="popstate";function R(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function A(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function P(e,t){return{usr:e.state,key:e.key,idx:t}}function D(e,t,n,r){return void 0===n&&(n=null),S({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?L(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function O(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,o=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function L(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function M(e,n,r,i){void 0===i&&(i={});var a=i,o=a.window,u=void 0===o?document.defaultView:o,s=a.v5Compat,c=void 0!==s&&s,l=u.history,h=t.Pop,f=null,d=p();function p(){return(l.state||{idx:null}).idx}function v(){h=t.Pop;var e=p(),n=null==e?null:e-d;d=e,f&&f({action:h,location:m.location,delta:n})}function y(e){var t="null"!==u.location.origin?u.location.origin:u.location.href,n="string"===typeof e?e:O(e);return R(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==d&&(d=0,l.replaceState(S({},l.state,{idx:d}),""));var m={get action(){return h},get location(){return e(u,l)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return u.addEventListener(N,v),f=e,function(){u.removeEventListener(N,v),f=null}},createHref:function(e){return n(u,e)},createURL:y,encodeLocation:function(e){var t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,n){h=t.Push;var i=D(m.location,e,n);r&&r(i,e);var a=P(i,d=p()+1),o=m.createHref(i);try{l.pushState(a,"",o)}catch(vA){u.location.assign(o)}c&&f&&f({action:h,location:m.location,delta:1})},replace:function(e,n){h=t.Replace;var i=D(m.location,e,n);r&&r(i,e);var a=P(i,d=p()),o=m.createHref(i);l.replaceState(a,"",o),c&&f&&f({action:h,location:m.location,delta:0})},go:function(e){return l.go(e)}};return m}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(C||(C={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function F(e,t,n){void 0===n&&(n="/");var r=$(("string"===typeof t?L(t):t).pathname||"/",n);if(null==r)return null;var i=U(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,o=0;null==a&&o<i.length;++o)a=Q(i[o],X(r));return a}function U(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var i=function(e,i,a){var o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(R(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var u=te([r,o.relativePath]),s=n.concat(o);e.children&&e.children.length>0&&(R(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+u+'".'),U(e.children,t,s,u)),(null!=e.path||e.index)&&t.push({path:u,score:G(u,e.index),routesMeta:s})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,a=T(V(e.path));try{for(a.s();!(r=a.n()).done;){var o=r.value;i(e,t,o)}}catch(u){a.e(u)}finally{a.f()}}else i(e,t)})),t}function V(e){var t=e.split("/");if(0===t.length)return[];var n=E(t),r=n[0],i=n.slice(1),a=r.endsWith("?"),o=r.replace(/\?$/,"");if(0===i.length)return a?[o,""]:[o];var u=V(i.join("/")),s=[];return s.push.apply(s,h(u.map((function(e){return""===e?o:[o,e].join("/")})))),a&&s.push.apply(s,h(u)),s.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}var j=/^:\w+$/,q=3,B=2,z=1,W=10,H=-2,K=function(e){return"*"===e};function G(e,t){var n=e.split("/"),r=n.length;return n.some(K)&&(r+=H),t&&(r+=B),n.filter((function(e){return!K(e)})).reduce((function(e,t){return e+(j.test(t)?q:""===t?z:W)}),r)}function Q(e,t){for(var n=e.routesMeta,r={},i="/",a=[],o=0;o<n.length;++o){var u=n[o],s=o===n.length-1,c="/"===i?t:t.slice(i.length)||"/",l=Y({path:u.relativePath,caseSensitive:u.caseSensitive,end:s},c);if(!l)return null;Object.assign(r,l.params);var h=u.route;a.push({params:r,pathname:te([i,l.pathname]),pathnameBase:ne(te([i,l.pathnameBase])),route:h}),"/"!==l.pathnameBase&&(i=te([i,l.pathnameBase]))}return a}function Y(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);A("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");var a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),r=c(n,2),i=r[0],a=r[1],o=t.match(i);if(!o)return null;var u=o[0],s=u.replace(/(.)\/+$/,"$1"),l=o.slice(1),h=a.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";s=u.slice(0,u.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(vA){return A(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+vA+")."),e}}(l[n]||"",t),e}),{});return{params:h,pathname:u,pathnameBase:s,pattern:e}}function X(e){try{return decodeURI(e)}catch(vA){return A(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+vA+")."),e}}function $(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function J(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Z(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function ee(e,t,n,r){var i;void 0===r&&(r=!1),"string"===typeof e?i=L(e):(R(!(i=S({},e)).pathname||!i.pathname.includes("?"),J("?","pathname","search",i)),R(!i.pathname||!i.pathname.includes("#"),J("#","pathname","hash",i)),R(!i.search||!i.search.includes("#"),J("#","search","hash",i)));var a,o=""===e||""===i.pathname,u=o?"/":i.pathname;if(r||null==u)a=n;else{var s=t.length-1;if(u.startsWith("..")){for(var c=u.split("/");".."===c[0];)c.shift(),s-=1;i.pathname=c.join("/")}a=s>=0?t[s]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?L(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,o=n.hash,u=void 0===o?"":o,s=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:s,search:re(a),hash:ie(u)}}(i,a),h=u&&"/"!==u&&u.endsWith("/"),f=(o||"."===u)&&n.endsWith("/");return l.pathname.endsWith("/")||!h&&!f||(l.pathname+="/"),l}var te=function(e){return e.join("/").replace(/\/\/+/g,"/")},ne=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},re=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},ie=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},ae=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n)}(I(Error));function oe(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var ue=["post","put","patch","delete"],se=(new Set(ue),["get"].concat(ue));new Set(se),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;Symbol("deferred");function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ce.apply(this,arguments)}var le=r.createContext(null);var he=r.createContext(null);var fe=r.createContext(null);var de=r.createContext(null);var pe=r.createContext(null);var ve=r.createContext({outlet:null,matches:[],isDataRoute:!1});var ye=r.createContext(null);function me(){return null!=r.useContext(pe)}function ge(){return me()||R(!1),r.useContext(pe).location}function ke(e){r.useContext(de).static||r.useLayoutEffect(e)}function _e(){return r.useContext(ve).isDataRoute?function(){var e=Re(Ie.UseNavigateStable).router,t=Pe(Ee.UseNavigateStable),n=r.useRef(!1);ke((function(){n.current=!0}));var i=r.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,ce({fromRouteId:t},i)))}),[e,t]);return i}():function(){me()||R(!1);var e=r.useContext(le),t=r.useContext(de),n=t.basename,i=t.navigator,a=r.useContext(ve).matches,o=ge().pathname,u=JSON.stringify(Z(a).map((function(e){return e.pathnameBase}))),s=r.useRef(!1);ke((function(){s.current=!0}));var c=r.useCallback((function(t,r){if(void 0===r&&(r={}),s.current)if("number"!==typeof t){var a=ee(t,JSON.parse(u),o,"path"===r.relative);null==e&&"/"!==n&&(a.pathname="/"===a.pathname?n:te([n,a.pathname])),(r.replace?i.replace:i.push)(a,r.state,r)}else i.go(t)}),[n,i,u,o,e]);return c}()}function we(e,t){var n=(void 0===t?{}:t).relative,i=r.useContext(ve).matches,a=ge().pathname,o=JSON.stringify(Z(i).map((function(e){return e.pathnameBase})));return r.useMemo((function(){return ee(e,JSON.parse(o),a,"path"===n)}),[e,o,a,n])}function be(e,n,i){me()||R(!1);var a,o=r.useContext(de).navigator,u=r.useContext(ve).matches,s=u[u.length-1],c=s?s.params:{},l=(s&&s.pathname,s?s.pathnameBase:"/"),h=(s&&s.route,ge());if(n){var f,d="string"===typeof n?L(n):n;"/"===l||(null==(f=d.pathname)?void 0:f.startsWith(l))||R(!1),a=d}else a=h;var p=a.pathname||"/",v=F(e,{pathname:"/"===l?p:p.slice(l.length)||"/"});var y=Ne(v&&v.map((function(e){return Object.assign({},e,{params:Object.assign({},c,e.params),pathname:te([l,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:te([l,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),u,i);return n&&y?r.createElement(pe.Provider,{value:{location:ce({pathname:"/",search:"",hash:"",state:null,key:"default"},a),navigationType:t.Pop}},y):y}function xe(){var e=function(){var e,t=r.useContext(ye),n=Ae(Ee.UseRouteError),i=Pe(Ee.UseRouteError);if(t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=oe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:a},n):null,null)}var Ie,Ee,Te=r.createElement(xe,null),Se=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},r}return y(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?r.createElement(ve.Provider,{value:this.props.routeContext},r.createElement(ye.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}}]),n}(r.Component);function Ce(e){var t=e.routeContext,n=e.match,i=e.children,a=r.useContext(le);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(ve.Provider,{value:t},i)}function Ne(e,t,n){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),null==e){var a;if(null==(a=n)||!a.errors)return null;e=n.matches}var o=e,u=null==(i=n)?void 0:i.errors;if(null!=u){var s=o.findIndex((function(e){return e.route.id&&(null==u?void 0:u[e.route.id])}));s>=0||R(!1),o=o.slice(0,Math.min(o.length,s+1))}return o.reduceRight((function(e,i,a){var s=i.route.id?null==u?void 0:u[i.route.id]:null,c=null;n&&(c=i.route.errorElement||Te);var l=t.concat(o.slice(0,a+1)),h=function(){var t;return t=s?c:i.route.Component?r.createElement(i.route.Component,null):i.route.element?i.route.element:e,r.createElement(Ce,{match:i,routeContext:{outlet:e,matches:l,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?r.createElement(Se,{location:n.location,revalidation:n.revalidation,component:c,error:s,children:h(),routeContext:{outlet:null,matches:l,isDataRoute:!0}}):h()}),null)}function Re(e){var t=r.useContext(le);return t||R(!1),t}function Ae(e){var t=r.useContext(he);return t||R(!1),t}function Pe(e){var t=function(e){var t=r.useContext(ve);return t||R(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||R(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"}(Ie||(Ie={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"}(Ee||(Ee={}));var De;function Oe(e){R(!1)}function Le(e){var n=e.basename,i=void 0===n?"/":n,a=e.children,o=void 0===a?null:a,u=e.location,s=e.navigationType,c=void 0===s?t.Pop:s,l=e.navigator,h=e.static,f=void 0!==h&&h;me()&&R(!1);var d=i.replace(/^\/*/,"/"),p=r.useMemo((function(){return{basename:d,navigator:l,static:f}}),[d,l,f]);"string"===typeof u&&(u=L(u));var v=u,y=v.pathname,m=void 0===y?"/":y,g=v.search,k=void 0===g?"":g,_=v.hash,w=void 0===_?"":_,b=v.state,x=void 0===b?null:b,I=v.key,E=void 0===I?"default":I,T=r.useMemo((function(){var e=$(m,d);return null==e?null:{location:{pathname:e,search:k,hash:w,state:x,key:E},navigationType:c}}),[d,m,k,w,x,E,c]);return null==T?null:r.createElement(de.Provider,{value:p},r.createElement(pe.Provider,{children:o,value:T}))}function Me(e){var t=e.children,n=e.location;return be(Ue(t),n)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(De||(De={}));var Fe=new Promise((function(){}));r.Component;function Ue(e,t){void 0===t&&(t=[]);var n=[];return r.Children.forEach(e,(function(e,i){if(r.isValidElement(e)){var a=[].concat(h(t),[i]);if(e.type!==r.Fragment){e.type!==Oe&&R(!1),e.props.index&&e.props.children&&R(!1);var o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Ue(e.props.children,a)),n.push(o)}else n.push.apply(n,Ue(e.props.children,a))}})),n}function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ve.apply(this,arguments)}function je(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var qe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Be(e){var t,n=e.basename,i=e.children,a=e.window,o=r.useRef();null==o.current&&(o.current=(void 0===(t={window:a,v5Compat:!0})&&(t={}),M((function(e,t){var n=e.location;return D("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:O(t)}),null,t)));var u=o.current,s=c(r.useState({action:u.action,location:u.location}),2),l=s[0],h=s[1];return r.useLayoutEffect((function(){return u.listen(h)}),[u]),r.createElement(Le,{basename:n,children:i,location:l.location,navigationType:l.action,navigator:u})}var ze="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,We=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,He=r.forwardRef((function(e,t){var n,i=e.onClick,a=e.relative,o=e.reloadDocument,u=e.replace,s=e.state,c=e.target,l=e.to,h=e.preventScrollReset,f=je(e,qe),d=r.useContext(de).basename,p=!1;if("string"===typeof l&&We.test(l)&&(n=l,ze))try{var v=new URL(window.location.href),y=l.startsWith("//")?new URL(v.protocol+l):new URL(l),m=$(y.pathname,d);y.origin===v.origin&&null!=m?l=m+y.search+y.hash:p=!0}catch(_){}var g=function(e,t){var n=(void 0===t?{}:t).relative;me()||R(!1);var i=r.useContext(de),a=i.basename,o=i.navigator,u=we(e,{relative:n}),s=u.hash,c=u.pathname,l=u.search,h=c;return"/"!==a&&(h="/"===c?a:te([a,c])),o.createHref({pathname:h,search:l,hash:s})}(l,{relative:a}),k=function(e,t){var n=void 0===t?{}:t,i=n.target,a=n.replace,o=n.state,u=n.preventScrollReset,s=n.relative,c=_e(),l=ge(),h=we(e,{relative:s});return r.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();var n=void 0!==a?a:O(l)===O(h);c(e,{replace:n,state:o,preventScrollReset:u,relative:s})}}),[l,c,h,a,o,i,e,u,s])}(l,{replace:u,state:s,target:c,preventScrollReset:h,relative:a});return r.createElement("a",Ve({},f,{href:n||g,onClick:p||o?i:function(e){i&&i(e),e.defaultPrevented||k(e)},ref:t,target:c}))}));var Ke,Ge;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Ke||(Ke={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ge||(Ge={}));var Qe=n(184),Ye=(0,r.createContext)(null),Xe=(0,r.createContext)(null);var $e=function(e){var t=e.children,n=c((0,r.useState)(null),2),i=n[0],a=n[1];return(0,Qe.jsx)(Xe.Provider,{value:{user:i,setUser:a},children:t})},Je={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function Ze(e){if("number"===typeof e)return{value:e,unit:"px"};var t,n=(e.match(/^[0-9.]*/)||"").toString();t=n.includes(".")?parseFloat(n):parseInt(n,10);var r=(e.match(/[^0-9]*$/)||"").toString();return Je[r]?{value:t,unit:r}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}function et(e){var t=Ze(e);return"".concat(t.value).concat(t.unit)}var tt=function(e,t,n){var r="react-spinners-".concat(e,"-").concat(n);if("undefined"==typeof window||!window.document)return r;var i=document.createElement("style");document.head.appendChild(i);var a=i.sheet,o="\n    @keyframes ".concat(r," {\n      ").concat(t,"\n    }\n  ");return a&&a.insertRule(o,0),r},nt=function(){return nt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},nt.apply(this,arguments)},rt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},it=tt("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");var at=function(e){var t=e.loading,n=void 0===t||t,i=e.color,a=void 0===i?"#000000":i,o=e.speedMultiplier,u=void 0===o?1:o,s=e.cssOverride,c=void 0===s?{}:s,l=e.size,h=void 0===l?15:l,f=e.margin,d=void 0===f?2:f,p=rt(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),v=nt({display:"inherit"},c),y=function(e){return{display:"inline-block",backgroundColor:a,width:et(h),height:et(h),margin:et(d),borderRadius:"100%",animation:"".concat(it," ").concat(.7/u,"s ").concat(e%2?"0s":"".concat(.35/u,"s")," infinite linear"),animationFillMode:"both"}};return n?r.createElement("span",nt({style:v},p),r.createElement("span",{style:y(1)}),r.createElement("span",{style:y(2)}),r.createElement("span",{style:y(3)})):null},ot=n.p+"static/media/logo.9ddbdfbbff0c7150569c.jpg";var ut=function(e){var t=e.isVisible,n=(0,r.useContext)(Ye).firebase,i=(0,r.useContext)(Xe).user,a=c((0,r.useState)(!1),2),o=a[0],u=a[1],s=c((0,r.useState)(null),2),l=s[0],h=s[1],f=c((0,r.useState)("https://th.bing.com/th?id=OIP.dNfuZjZeZUmYxsqHRhYtSQHaHa&w=250&h=250&c=8&rs=1&qlt=90&o=6&dpr=1.3&pid=3.1&rm=2"),2),d=f[0],p=f[1],v=_e();return(0,r.useEffect)((function(){null!==i&&void 0!==i&&i.photoURL&&p(i.photoURL)}),[i]),(0,Qe.jsxs)("div",{className:"navbarBody ".concat(t?"visible":"hidden"),children:[i?(0,Qe.jsxs)("div",{className:"profileImage",children:[i&&(0,Qe.jsx)("img",{src:d,alt:""}),(0,Qe.jsxs)("div",{className:"selectProfile",children:[(0,Qe.jsx)("input",{className:"fileUpload",type:"file",onChange:function(e){return h(e.target.files[0])}}),(0,Qe.jsx)("i",{className:"bi bi-camera"})]}),o?(0,Qe.jsx)("div",{children:(0,Qe.jsx)(at,{className:"profileLoader",size:8,color:"#006ba6"})}):l&&(0,Qe.jsx)("button",{className:"uploadButton",onClick:function(){u(!0),n.storage().ref(i.uid+".png").put(l).then((function(e){e.ref.getDownloadURL().then((function(e){i.updateProfile({photoURL:e}),p(e)}))})).catch((function(e){alert(e.message)})).finally((function(){u(!1),h(null)}))},children:"Upload"})]}):(0,Qe.jsx)("div",{className:"navLogo",children:(0,Qe.jsx)("img",{src:ot,alt:""})}),(0,Qe.jsxs)("ul",{children:[(0,Qe.jsx)("li",{onClick:function(){return v("/Make-Tasty-App")},children:"Home"}),(0,Qe.jsx)("li",{children:"Settings"}),i?(0,Qe.jsx)("li",{onClick:function(){i&&(n.auth().signOut(),v("/login"))},children:"Logout"}):(0,Qe.jsx)("li",{children:(0,Qe.jsx)(He,{className:"loginLink",to:"/login",children:"Login"})})]})]})};var st=function(){var e=c((0,r.useState)(!1),2),t=e[0],n=e[1],i=(0,r.useContext)(Xe).user;return(0,Qe.jsx)("div",{className:"header",children:(0,Qe.jsxs)("div",{className:"child_header",children:[(0,Qe.jsx)("div",{className:"logoHeader",children:(0,Qe.jsx)("img",{src:ot,alt:""})}),(0,Qe.jsxs)("div",{className:"menu_section",children:[(0,Qe.jsxs)("div",{className:"signUpOrLogin",children:[(0,Qe.jsx)("i",{className:"bi bi-person-circle"}),i?(0,Qe.jsx)("h5",{children:i&&i.displayName.charAt(0).toUpperCase()+i.displayName.slice(1)}):(0,Qe.jsx)(He,{className:"linkLogin",to:"/login",children:"Login/SignUp"})]}),(0,Qe.jsx)("i",{className:t?"bi bi-x":"bi bi-list",onClick:function(){n(!t)}}),t&&(0,Qe.jsx)(ut,{})]})]})})};var ct=function(){return(0,Qe.jsx)("div",{className:"parentDivofBanner"})};var lt=function(){return(0,Qe.jsxs)("div",{children:[(0,Qe.jsx)(st,{}),(0,Qe.jsx)(ct,{})]})},ht=function(){return ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ht.apply(this,arguments)},ft=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},dt=[tt("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(-44deg)}","pacman-1"),tt("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(44deg)}","pacman-2")];var pt=function(e){var t=e.loading,n=void 0===t||t,i=e.color,a=void 0===i?"#000000":i,o=e.speedMultiplier,u=void 0===o?1:o,s=e.cssOverride,c=void 0===s?{}:s,l=e.size,h=void 0===l?25:l,f=e.margin,d=void 0===f?2:f,p=ft(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),v=Ze(h),y=v.value,m=v.unit,g=ht({display:"inherit",position:"relative",fontSize:0,height:"".concat(2*y).concat(m),width:"".concat(2*y).concat(m)},c),k=tt("PacmanLoader","75% {opacity: 0.7}\n    100% {transform: translate(".concat("".concat(-4*y).concat(m),", ").concat("".concat(-y/4).concat(m),")}"),"ball"),_=function(e){return{width:"".concat(y/3).concat(m),height:"".concat(y/3).concat(m),backgroundColor:a,margin:et(d),borderRadius:"100%",transform:"translate(0, ".concat("".concat(-y/4).concat(m),")"),position:"absolute",top:"".concat(y).concat(m),left:"".concat(4*y).concat(m),animation:"".concat(k," ").concat(1/u,"s ").concat(.25*e,"s infinite linear"),animationFillMode:"both"}},w="".concat(et(h)," solid transparent"),b="".concat(et(h)," solid ").concat(a),x=function(e){return{width:0,height:0,borderRight:w,borderTop:0===e?w:b,borderLeft:b,borderBottom:0===e?b:w,borderRadius:et(h),position:"absolute",animation:"".concat(dt[e]," ").concat(.8/u,"s infinite ease-in-out"),animationFillMode:"both"}},I=x(0),E=x(1);return n?r.createElement("span",ht({style:g},p),r.createElement("span",{style:I}),r.createElement("span",{style:E}),r.createElement("span",{style:_(2)}),r.createElement("span",{style:_(3)}),r.createElement("span",{style:_(4)}),r.createElement("span",{style:_(5)})):null};var vt=function(){var e=c((0,r.useState)(!1),2),t=e[0],n=e[1],i=c((0,r.useState)(!1),2),a=i[0],o=i[1],u=c((0,r.useState)(!0),2),s=u[0],l=u[1],h=c((0,r.useState)(""),2),f=h[0],d=h[1],p=c((0,r.useState)(""),2),v=p[0],y=p[1],m=c((0,r.useState)(""),2),g=m[0],k=m[1],_=c((0,r.useState)(""),2),w=_[0],b=_[1],x=c((0,r.useState)(!1),2),I=x[0],E=x[1],T=(0,r.useContext)(Ye).firebase,S=c((0,r.useState)(""),2),C=S[0],N=S[1],R=c((0,r.useState)(""),2),A=R[0],P=R[1],D=_e();return(0,r.useEffect)((function(){var e=setTimeout((function(){l(!1)}),2e3);return function(){return clearTimeout(e)}}),[]),s||I?(0,Qe.jsx)("div",{className:"loader",children:(0,Qe.jsx)(pt,{className:"loaderItem",color:"#79AEB2"})}):(0,Qe.jsxs)(r.Fragment,{children:[(0,Qe.jsx)("div",{className:"CompanyLogo"}),(0,Qe.jsxs)("div",{className:"signupPage",children:[(0,Qe.jsxs)("div",{className:"login ".concat(t&&"signup_bg"),children:[a&&(0,Qe.jsx)("div",{className:"signupInfo ".concat(a&&"visible2"),children:(0,Qe.jsxs)("form",{id:"form",onSubmit:function(e){e.preventDefault(),E(!0),T.auth().createUserWithEmailAndPassword(v,w).then((function(e){e.user.updateProfile({displayName:f}).then((function(){T.firestore().collection("users").add({id:e.user.uid,name:f,phoneNumber:g,password:w,email:v}).finally((function(){E(!1),o(!1),n(!0)}))})).catch((function(e){alert(e.message)}))})).catch((function(e){alert(e.message),E(!1),o(!0),n(!1)}))},children:[(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"User Name"}),(0,Qe.jsx)("input",{type:"text",required:!0,value:f,onChange:function(e){return d(e.target.value)}})]}),(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"E-mail"}),(0,Qe.jsx)("input",{type:"email",required:!0,value:v,onChange:function(e){return y(e.target.value)}})]}),(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"Mobile Number"}),(0,Qe.jsx)("input",{type:"tel",required:!0,value:g,onChange:function(e){return k(e.target.value)}})]}),(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"Password"}),(0,Qe.jsx)("input",{type:"password",required:!0,value:w,onChange:function(e){return b(e.target.value)},placeholder:"password must be 6 characters"})]}),(0,Qe.jsx)("button",{className:"Btn",type:"submit",children:"Sign Up"})]})}),(0,Qe.jsx)("button",{className:"loginClick",onClick:function(){n(!t)},children:"Login"}),(0,Qe.jsx)("p",{children:"Already have an account"})]}),(0,Qe.jsxs)("div",{className:"signup ".concat(a&&"login_bg"),children:[t&&(0,Qe.jsx)("div",{className:"loginInfo ".concat(t&&"visible1"),children:(0,Qe.jsxs)("form",{className:"loginItems",onSubmit:function(e){e.preventDefault(),E(!0),T.auth().signInWithEmailAndPassword(C,A).then((function(){D("/Make-Tasty-App")})).catch((function(e){alert(e.message)})).finally((function(){E(!1)}))},children:[(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"E-mail"}),(0,Qe.jsx)("input",{type:"email",required:!0,value:C,onChange:function(e){return N(e.target.value)}})]}),(0,Qe.jsxs)("div",{className:"inputFields",children:[(0,Qe.jsx)("label",{htmlFor:"",children:"Password"}),(0,Qe.jsx)("input",{type:"password",required:!0,value:A,onChange:function(e){return P(e.target.value)}})]}),(0,Qe.jsx)("button",{className:"Btn",children:"Sign In"})]})}),(0,Qe.jsx)("button",{className:"signupClick",onClick:function(){o(!a)},children:"SignUp"}),(0,Qe.jsx)("p",{children:"Don't have an account?"})]}),(0,Qe.jsx)("div",{children:(0,Qe.jsx)(He,{className:"bi bi-arrow-right",to:"/Make-Tasty-App"})})]})]})};var yt=function(){return(0,Qe.jsx)("div",{children:(0,Qe.jsx)(vt,{})})};var mt=function(){var e=(0,r.useContext)(Xe).setUser,t=(0,r.useContext)(Ye).firebase;return(0,r.useEffect)((function(){t.auth().onAuthStateChanged((function(t){e(t)}))}),[t,e]),(0,Qe.jsx)("div",{children:(0,Qe.jsx)(Be,{children:(0,Qe.jsxs)(Me,{children:[(0,Qe.jsx)(Oe,{exact:!0,path:"/Make-Tasty-App",element:(0,Qe.jsx)(lt,{})}),(0,Qe.jsx)(Oe,{path:"/login",element:(0,Qe.jsx)(yt,{})})]})})})};function gt(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kt=!1,_t=!1,wt="${JSCORE_VERSION}",bt=function(e,t){if(!e)throw xt(t)},xt=function(e){return new Error("Firebase Database ("+wt+") INTERNAL ASSERT FAILED: "+e)},It=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Et={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(It(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw new Tt;var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Tt=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return y(n)}(I(Error)),St=function(e){var t=It(e);return Et.encodeByteArray(t,!0)},Ct=function(e){return St(e).replace(/\./g,"")},Nt=function(e){try{return Et.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Rt(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Rt(e[n],t[n]));return e}var At=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},Pt=function(){try{return At()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"/Make-Tasty-App",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&Nt(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},Dt=function(){var e;return null===(e=Pt())||void 0===e?void 0:e.config},Ot=function(){function e(){var t=this;f(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return y(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function Lt(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ct(JSON.stringify({alg:"none",type:"JWT"})),Ct(JSON.stringify(a)),""].join(".")}function Mt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Ft(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mt())}function Ut(){var e,t=null===(e=Pt())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function Vt(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function jt(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function qt(){var e=Mt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Bt(){return!0===kt||!0===_t}function zt(){try{return"object"===typeof indexedDB}catch(e){return!1}}var Wt=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(w(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(w(a),Ht.prototype.create),a}return y(n)}(I(Error)),Ht=function(){function e(t,n,r){f(this,e),this.service=t,this.serviceName=n,this.errors=r}return y(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(Kt,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new Wt(n,a,t)}}]),e}();var Kt=/\{\$([^}]+)}/g;function Gt(e){return JSON.parse(e)}function Qt(e){return JSON.stringify(e)}var Yt=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=Gt(Nt(a[0])||""),n=Gt(Nt(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function Xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $t(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Jt(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Zt(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function en(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var u=e[o],s=t[o];if(tn(u)&&tn(s)){if(!en(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function tn(e){return null!==e&&"object"===typeof e}function nn(e){for(var t=[],n=function(){var e=c(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function rn(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=c(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function an(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var on=function(){function e(){f(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return y(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var u,s,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(u=f^l&(h^f),s=1518500249):(u=l^h^f,s=1859775393):p<60?(u=l&h|f&(l|h),s=2400959708):(u=l^h^f,s=3395469782);var v=(c<<5|c>>>27)+u+d+s+n[p]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}();function un(e,t){var n=new sn(e,t);return n.subscribe.bind(n)}var sn=function(){function e(t,n){var r=this;f(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return y(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=T(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=cn),void 0===r.error&&(r.error=cn),void 0===r.complete&&(r.complete=cn);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function cn(){}var ln=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function hn(e,t){return"".concat(e," failed: ").concat(t," argument ")}function fn(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(hn(e,t)+"must be a valid function.")}function dn(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(hn(e,t)+"must be a valid context object.")}var pn=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function vn(e){return e&&e._delegate?e._delegate:e}function yn(){yn=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(N){s=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),u=new T(i||[]);return r(o,"_invoke",{value:b(e,n,u)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=c;var h={};function f(){}function p(){}function v(){}var y={};s(y,a,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==t&&n.call(g,a)&&(y=g);var k=v.prototype=f.prototype=Object.create(y);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(r,a,o,u){var s=l(e[r],e,a);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==d(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){i("next",e,o,u)}),(function(e){i("throw",e,o,u)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return i("throw",e,o,u)}))}u(s.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function b(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return C()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=x(o,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=v,r(k,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=s(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},_(w.prototype),s(w.prototype,o,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new w(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function mn(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(vA){return void n(vA)}u.done?t(s):Promise.resolve(s).then(r,i)}function gn(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){mn(a,r,i,o,u,"next",e)}function u(e){mn(a,r,i,o,u,"throw",e)}o(void 0)}))}}var kn=function(){function e(t,n,r){f(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return y(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),_n="[DEFAULT]",wn=function(){function e(t,n){f(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return y(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Ot;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:_n})}catch(s){}var t,n=T(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=c(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var u=this.getOrInitializeService({instanceIdentifier:o});a.resolve(u)}catch(s){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(h(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),h(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=T(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var u=c(i.value,2),s=u[0],l=u[1];r===this.normalizeInstanceIdentifier(s)&&l.resolve(a)}}catch(h){o.e(h)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(JE){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===_n?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(JE){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n;return this.component?this.component.multipleInstances?e:_n:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var bn,xn,In=function(){function e(t){f(this,e),this.name=t,this.providers=new Map}return y(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new wn(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),En=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(xn||(xn={}));var Tn={debug:xn.DEBUG,verbose:xn.VERBOSE,info:xn.INFO,warn:xn.WARN,error:xn.ERROR,silent:xn.SILENT},Sn=xn.INFO,Cn=(gt(bn={},xn.DEBUG,"log"),gt(bn,xn.VERBOSE,"log"),gt(bn,xn.INFO,"info"),gt(bn,xn.WARN,"warn"),gt(bn,xn.ERROR,"error"),bn),Nn=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Cn[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},Rn=function(){function e(t){f(this,e),this.name=t,this._logLevel=Sn,this._logHandler=Nn,this._userLogHandler=null,En.push(this)}return y(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in xn))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Tn[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,xn.DEBUG].concat(t)),this._logHandler.apply(this,[this,xn.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,xn.VERBOSE].concat(t)),this._logHandler.apply(this,[this,xn.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,xn.INFO].concat(t)),this._logHandler.apply(this,[this,xn.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,xn.WARN].concat(t)),this._logHandler.apply(this,[this,xn.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,xn.ERROR].concat(t)),this._logHandler.apply(this,[this,xn.ERROR].concat(t))}}]),e}();function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?An(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dn,On,Ln=function(e,t){return t.some((function(t){return e instanceof t}))};var Mn=new WeakMap,Fn=new WeakMap,Un=new WeakMap,Vn=new WeakMap,jn=new WeakMap;var qn={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Fn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Un.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wn(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Bn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(On||(On=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Hn(this),n),Wn(Mn.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Wn(e.apply(Hn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Hn(this),t].concat(r));return Un.set(a,t.sort?t.sort():[t]),Wn(a)}}function zn(e){return"function"===typeof e?Bn(e):(e instanceof IDBTransaction&&function(e){if(!Fn.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Fn.set(e,t)}}(e),Ln(e,Dn||(Dn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,qn):e)}function Wn(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Wn(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&Mn.set(t,e)})).catch((function(){})),jn.set(t,e),t}(e);if(Vn.has(e))return Vn.get(e);var t=zn(e);return t!==e&&(Vn.set(e,t),jn.set(t,e)),t}var Hn=function(e){return jn.get(e)};var Kn,Gn,Qn=["get","getKey","getAll","getAllKeys","count"],Yn=["put","add","delete","clear"],Xn=new Map;function $n(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(Xn.get(t))return Xn.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Yn.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Qn.includes(n))){var a=function(){var e=gn(yn().mark((function e(t){var a,o,u,s,c,l,h=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),u=o.store,s=h.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=h[l];return r&&(u=u.index(c.shift())),e.next=6,Promise.all([(a=u)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return Xn.set(t,a),a}}}qn=function(e){return Pn(Pn({},e),{},{get:function(t,n,r){return $n(t,n)||e.get(t,n,r)},has:function(t,n){return!!$n(t,n)||e.has(t,n)}})}(qn);var Jn=function(){function e(t){f(this,e),this.container=t}return y(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var Zn="@firebase/app",er="0.9.11",tr=new Rn("@firebase/app"),nr="[DEFAULT]",rr=(gt(Kn={},Zn,"fire-core"),gt(Kn,"@firebase/app-compat","fire-core-compat"),gt(Kn,"@firebase/analytics","fire-analytics"),gt(Kn,"@firebase/analytics-compat","fire-analytics-compat"),gt(Kn,"@firebase/app-check","fire-app-check"),gt(Kn,"@firebase/app-check-compat","fire-app-check-compat"),gt(Kn,"@firebase/auth","fire-auth"),gt(Kn,"@firebase/auth-compat","fire-auth-compat"),gt(Kn,"@firebase/database","fire-rtdb"),gt(Kn,"@firebase/database-compat","fire-rtdb-compat"),gt(Kn,"@firebase/functions","fire-fn"),gt(Kn,"@firebase/functions-compat","fire-fn-compat"),gt(Kn,"@firebase/installations","fire-iid"),gt(Kn,"@firebase/installations-compat","fire-iid-compat"),gt(Kn,"@firebase/messaging","fire-fcm"),gt(Kn,"@firebase/messaging-compat","fire-fcm-compat"),gt(Kn,"@firebase/performance","fire-perf"),gt(Kn,"@firebase/performance-compat","fire-perf-compat"),gt(Kn,"@firebase/remote-config","fire-rc"),gt(Kn,"@firebase/remote-config-compat","fire-rc-compat"),gt(Kn,"@firebase/storage","fire-gcs"),gt(Kn,"@firebase/storage-compat","fire-gcs-compat"),gt(Kn,"@firebase/firestore","fire-fst"),gt(Kn,"@firebase/firestore-compat","fire-fst-compat"),gt(Kn,"fire-js","fire-js"),gt(Kn,"firebase","fire-js-all"),Kn),ir=new Map,ar=new Map;function or(e,t){try{e.container.addComponent(t)}catch(n){tr.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ur(e,t){e.container.addOrOverwriteComponent(t)}function sr(e){var t=e.name;if(ar.has(t))return tr.debug("There were multiple attempts to register component ".concat(t,".")),!1;ar.set(t,e);var n,r=T(ir.values());try{for(r.s();!(n=r.n()).done;){or(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function cr(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function lr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nr;cr(e,t).clearInstance(n)}function hr(){ar.clear()}var fr=(gt(Gn={},"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),gt(Gn,"bad-app-name","Illegal App name: '{$appName}"),gt(Gn,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),gt(Gn,"app-deleted","Firebase App named '{$appName}' already deleted"),gt(Gn,"no-options","Need to provide options, when not being deployed to hosting via source."),gt(Gn,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),gt(Gn,"invalid-log-argument","First argument to `onLog` must be null or a function."),gt(Gn,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),gt(Gn,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),gt(Gn,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),gt(Gn,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),Gn),dr=new Ht("app","Firebase",fr),pr=function(){function e(t,n,r){var i=this;f(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new kn("app",(function(){return i}),"PUBLIC"))}return y(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw dr.create("app-deleted",{appName:this._name})}}]),e}(),vr="9.22.1";function yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:nr,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw dr.create("bad-app-name",{appName:String(i)});if(n||(n=Dt()),!n)throw dr.create("no-options");var a=ir.get(i);if(a){if(en(n,a.options)&&en(r,a.config))return a;throw dr.create("duplicate-app",{appName:i})}var o,u=new In(i),s=T(ar.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u.addComponent(c)}}catch(h){s.e(h)}finally{s.f()}var l=new pr(n,r,u);return ir.set(i,l),l}function mr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nr,t=ir.get(e);if(!t&&e===nr&&Dt())return yr();if(!t)throw dr.create("no-app",{appName:e});return t}function gr(){return Array.from(ir.values())}function kr(e){return _r.apply(this,arguments)}function _r(){return(_r=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!ir.has(n)){e.next=6;break}return ir.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wr(e,t,n){var r,i=null!==(r=rr[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void tr.warn(u.join(" "))}sr(new kn("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function br(e,t){if(null!==e&&"function"!==typeof e)throw dr.create("invalid-log-argument");!function(e,t){var n,r=T(En);try{var i=function(){var r=n.value,i=null;t&&t.level&&(i=Tn[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var u=a.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==i&&void 0!==i?i:t.logLevel)&&e({level:xn[n].toLowerCase(),message:u,args:a,type:t.name})}};for(r.s();!(n=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}(e,t)}function xr(e){var t;t=e,En.forEach((function(e){e.setLogLevel(t)}))}var Ir="firebase-heartbeat-database",Er=1,Tr="firebase-heartbeat-store",Sr=null;function Cr(){return Sr||(Sr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=Wn(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(Wn(u.result),e.oldVersion,e.newVersion,Wn(u.transaction),e)})),r&&u.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(e){return a(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),s}(Ir,Er,{upgrade:function(e,t){if(0===t)e.createObjectStore(Tr)}}).catch((function(e){throw dr.create("idb-open",{originalErrorMessage:e.message})}))),Sr}function Nr(e){return Rr.apply(this,arguments)}function Rr(){return Rr=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cr();case 3:return n=e.sent,e.next=6,n.transaction(Tr).objectStore(Tr).get(Dr(t));case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof Wt?tr.warn(e.t0.message):(i=dr.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),tr.warn(i.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),Rr.apply(this,arguments)}function Ar(e,t){return Pr.apply(this,arguments)}function Pr(){return Pr=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cr();case 3:return r=e.sent,i=r.transaction(Tr,"readwrite"),a=i.objectStore(Tr),e.next=8,a.put(n,Dr(t));case 8:return e.next=10,i.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Wt?tr.warn(e.t0.message):(o=dr.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),tr.warn(o.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),Pr.apply(this,arguments)}function Dr(e){return"".concat(e.name,"!").concat(e.options.appId)}var Or=function(){function e(t){var n=this;f(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Vr(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return y(e,[{key:"triggerHeartbeat",value:function(){var e=gn(yn().mark((function e(){var t,n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=Lr(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=Lr(),n=Mr(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=Ct(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Lr(){return(new Date).toISOString().substring(0,10)}function Mr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=T(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),jr(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),jr(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){if("break"===o())break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var Fr,Ur,Vr=function(){function e(t){f(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return y(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(vA){t(vA)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Nr(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ar(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ar(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(h(r.heartbeats),h(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function jr(e){return Ct(JSON.stringify({version:2,heartbeats:e})).length}Fr="",sr(new kn("platform-logger",(function(e){return new Jn(e)}),"PRIVATE")),sr(new kn("heartbeat",(function(e){return new Or(e)}),"PRIVATE")),wr(Zn,er,Fr),wr(Zn,er,"esm2017"),wr("fire-js","");var qr=function(){function e(t,n){var r=this;f(this,e),this._delegate=t,this.firebase=n,or(t,new kn("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return y(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),kr(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nr;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nr;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){or(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){ur(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),Br=(gt(Ur={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),gt(Ur,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Ur),zr=new Ht("app-compat","Firebase",Br);var Wr=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var i=yr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(Xt(n,i.name))return n[i.name];var a=new t(i,r);return n[i.name]=a,a},app:i,registerVersion:wr,setLogLevel:xr,onLog:br,apps:null,SDK_VERSION:vr,INTERNAL:{registerComponent:function(e){var n=e.name,a=n.replace("-compat","");if(sr(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw zr.create("invalid-app-argument",{appName:n});return e[a]()};void 0!==e.serviceProps&&Rt(o,e.serviceProps),r[a]=o,t.prototype[a]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!Xt(n,e=e||nr))throw zr.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),i.App=t,r}(qr);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){Rt(n,e)},createSubscribe:un,ErrorFactory:Ht,deepExtend:Rt}),n}(),Hr=new Rn("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){Hr.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Kr=self.firebase.SDK_VERSION;Kr&&Kr.indexOf("LITE")>=0&&Hr.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Gr=Wr;!function(e){wr("@firebase/app-compat","0.2.11",e)}();function Qr(){return Qr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Qr.apply(this,arguments)}Gr.registerVersion("firebase","9.22.1","app-compat");function Yr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;var Xr,$r={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Jr="EMAIL_SIGNIN",Zr="PASSWORD_RESET",ei="RECOVER_EMAIL",ti="REVERT_SECOND_FACTOR_ADDITION",ni="VERIFY_AND_CHANGE_EMAIL",ri="VERIFY_EMAIL";function ii(){return gt({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var ai=function(){var e;return gt(e={},"admin-restricted-operation","This operation is restricted to administrators only."),gt(e,"argument-error",""),gt(e,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),gt(e,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),gt(e,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),gt(e,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),gt(e,"cordova-not-ready","Cordova framework is not ready."),gt(e,"cors-unsupported","This browser is not supported."),gt(e,"credential-already-in-use","This credential is already associated with a different user account."),gt(e,"custom-token-mismatch","The custom token corresponds to a different audience."),gt(e,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),gt(e,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),gt(e,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),gt(e,"email-change-needs-verification","Multi-factor users must always have a verified email."),gt(e,"email-already-in-use","The email address is already in use by another account."),gt(e,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),gt(e,"expired-action-code","The action code has expired."),gt(e,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),gt(e,"internal-error","An internal AuthError has occurred."),gt(e,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),gt(e,"invalid-app-id","The mobile app identifier is not registed for the current project."),gt(e,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),gt(e,"invalid-auth-event","An internal AuthError has occurred."),gt(e,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),gt(e,"invalid-continue-uri","The continue URL provided in the request is invalid."),gt(e,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),gt(e,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),gt(e,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),gt(e,"invalid-email","The email address is badly formatted."),gt(e,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),gt(e,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),gt(e,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),gt(e,"invalid-credential","The supplied auth credential is malformed or has expired."),gt(e,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),gt(e,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),gt(e,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),gt(e,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),gt(e,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),gt(e,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),gt(e,"wrong-password","The password is invalid or the user does not have a password."),gt(e,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),gt(e,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),gt(e,"invalid-provider-id","The specified provider ID is invalid."),gt(e,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),gt(e,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),gt(e,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),gt(e,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),gt(e,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),gt(e,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),gt(e,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),gt(e,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),gt(e,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),gt(e,"missing-continue-uri","A continue URL must be provided in the request."),gt(e,"missing-iframe-start","An internal AuthError has occurred."),gt(e,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),gt(e,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),gt(e,"missing-password","A non-empty password must be provided"),gt(e,"missing-multi-factor-info","No second factor identifier is provided."),gt(e,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),gt(e,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),gt(e,"missing-verification-id","The phone auth credential was created with an empty verification ID."),gt(e,"app-deleted","This instance of FirebaseApp has been deleted."),gt(e,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),gt(e,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),gt(e,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),gt(e,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),gt(e,"no-auth-event","An internal AuthError has occurred."),gt(e,"no-such-provider","User was not linked to an account with the given provider."),gt(e,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),gt(e,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),gt(e,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),gt(e,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),gt(e,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),gt(e,"provider-already-linked","User can only be linked to one identity for the given provider."),gt(e,"quota-exceeded","The project's quota for this operation has been exceeded."),gt(e,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),gt(e,"redirect-operation-pending","A redirect sign-in operation is already pending."),gt(e,"rejected-credential","The request contains malformed or mismatching credentials."),gt(e,"second-factor-already-in-use","The second factor is already enrolled on this account."),gt(e,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),gt(e,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),gt(e,"timeout","The operation has timed out."),gt(e,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),gt(e,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),gt(e,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),gt(e,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),gt(e,"unsupported-persistence-type","The current environment does not support the specified persistence type."),gt(e,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),gt(e,"unverified-email","The operation requires a verified email."),gt(e,"user-cancelled","The user did not grant your application the permissions it requested."),gt(e,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),gt(e,"user-disabled","The user account has been disabled by an administrator."),gt(e,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),gt(e,"user-signed-out",""),gt(e,"weak-password","The password must be 6 characters long or more."),gt(e,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),gt(e,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),gt(e,"missing-recaptcha-token","The reCAPTCHA token is missing when sending request to the backend."),gt(e,"invalid-recaptcha-token","The reCAPTCHA token is invalid when sending request to the backend."),gt(e,"invalid-recaptcha-action","The reCAPTCHA action is invalid when sending request to the backend."),gt(e,"recaptcha-not-enabled","reCAPTCHA Enterprise integration is not enabled for this project."),gt(e,"missing-client-type","The reCAPTCHA client type is missing when sending request to the backend."),gt(e,"missing-recaptcha-version","The reCAPTCHA version is missing when sending request to the backend."),gt(e,"invalid-req-type","Invalid request parameters."),gt(e,"invalid-recaptcha-version","The reCAPTCHA version is invalid when sending request to the backend."),e},oi=ii,ui=new Ht("auth","Firebase",ii()),si=new Rn("@firebase/auth");function ci(e){if(si.logLevel<=xn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];si.warn.apply(si,["Auth (".concat(vr,"): ").concat(e)].concat(n))}}function li(e){if(si.logLevel<=xn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];si.error.apply(si,["Auth (".concat(vr,"): ").concat(e)].concat(n))}}function hi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw vi.apply(void 0,[e].concat(n))}function fi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return vi.apply(void 0,[e].concat(n))}function di(e,t,n){var r=Object.assign(Object.assign({},oi()),gt({},t,n));return new Ht("auth","Firebase",r).create(t,{appName:e.name})}function pi(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&hi(e,"argument-error"),di(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function vi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var i,a=n[0],o=h(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(h(o)))}return ui.create.apply(ui,[e].concat(n))}function yi(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw vi.apply(void 0,[t].concat(r))}}function mi(e){var t="INTERNAL ASSERTION FAILED: "+e;throw li(t),new Error(t)}function gi(e,t){e||mi(t)}function ki(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function _i(){return"http:"===wi()||"https:"===wi()}function wi(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var bi=function(){function e(t,n){f(this,e),this.shortDelay=t,this.longDelay=n,gi(n>t,"Short delay should be less than long delay!"),this.isMobile=Ft()||jt()}return y(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(_i()||Vt()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function xi(e,t){gi(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Ii=function(){function e(){f(this,e)}return y(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void mi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void mi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void mi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Ei=(gt(Xr={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),gt(Xr,"MISSING_CUSTOM_TOKEN","internal-error"),gt(Xr,"INVALID_IDENTIFIER","invalid-email"),gt(Xr,"MISSING_CONTINUE_URI","internal-error"),gt(Xr,"INVALID_PASSWORD","wrong-password"),gt(Xr,"MISSING_PASSWORD","missing-password"),gt(Xr,"EMAIL_EXISTS","email-already-in-use"),gt(Xr,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),gt(Xr,"INVALID_IDP_RESPONSE","invalid-credential"),gt(Xr,"INVALID_PENDING_TOKEN","invalid-credential"),gt(Xr,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),gt(Xr,"MISSING_REQ_TYPE","internal-error"),gt(Xr,"EMAIL_NOT_FOUND","user-not-found"),gt(Xr,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),gt(Xr,"EXPIRED_OOB_CODE","expired-action-code"),gt(Xr,"INVALID_OOB_CODE","invalid-action-code"),gt(Xr,"MISSING_OOB_CODE","internal-error"),gt(Xr,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),gt(Xr,"INVALID_ID_TOKEN","invalid-user-token"),gt(Xr,"TOKEN_EXPIRED","user-token-expired"),gt(Xr,"USER_NOT_FOUND","user-token-expired"),gt(Xr,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),gt(Xr,"INVALID_CODE","invalid-verification-code"),gt(Xr,"INVALID_SESSION_INFO","invalid-verification-id"),gt(Xr,"INVALID_TEMPORARY_PROOF","invalid-credential"),gt(Xr,"MISSING_SESSION_INFO","missing-verification-id"),gt(Xr,"SESSION_EXPIRED","code-expired"),gt(Xr,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),gt(Xr,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),gt(Xr,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),gt(Xr,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),gt(Xr,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),gt(Xr,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),gt(Xr,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),gt(Xr,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),gt(Xr,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),gt(Xr,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),gt(Xr,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),gt(Xr,"RECAPTCHA_NOT_ENABLED","recaptcha-not-enabled"),gt(Xr,"MISSING_RECAPTCHA_TOKEN","missing-recaptcha-token"),gt(Xr,"INVALID_RECAPTCHA_TOKEN","invalid-recaptcha-token"),gt(Xr,"INVALID_RECAPTCHA_ACTION","invalid-recaptcha-action"),gt(Xr,"MISSING_CLIENT_TYPE","missing-client-type"),gt(Xr,"MISSING_RECAPTCHA_VERSION","missing-recaptcha-version"),gt(Xr,"INVALID_RECAPTCHA_VERSION","invalid-recaptcha-version"),gt(Xr,"INVALID_REQ_TYPE","invalid-req-type"),Xr),Ti=new bi(3e4,6e4);function Si(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Ci(e,t,n,r){return Ni.apply(this,arguments)}function Ni(){return Ni=gn(yn().mark((function e(t,n,r,i){var a,o=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Ri(t,a,gn(yn().mark((function e(){var a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),u=nn(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(s=e.sent)["Content-Type"]="application/json",t.languageCode&&(s["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",Ii.fetch()(Oi(t,t.config.apiHost,r,u),Object.assign({method:n,headers:s,referrerPolicy:"no-referrer"},a)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Ni.apply(this,arguments)}function Ri(e,t,n){return Ai.apply(this,arguments)}function Ai(){return Ai=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,l,h,f,d,p;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},Ei),n),e.prev=2,a=new Li(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(u=e.sent))){e.next=13;break}throw Mi(t,"account-exists-with-different-credential",u);case 13:if(!o.ok||"errorMessage"in u){e.next=17;break}return e.abrupt("return",u);case 17:if(s=o.ok?u.errorMessage:u.error.message,l=s.split(" : "),h=c(l,2),f=h[0],d=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=23;break}throw Mi(t,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==f){e.next=27;break}throw Mi(t,"email-already-in-use",u);case 27:if("USER_DISABLED"!==f){e.next=29;break}throw Mi(t,"user-disabled",u);case 29:if(p=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw di(t,p,d);case 34:hi(t,p);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof Wt)){e.next=41;break}throw e.t0;case 41:hi(t,"network-request-failed",{message:String(e.t0)});case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Ai.apply(this,arguments)}function Pi(e,t,n,r){return Di.apply(this,arguments)}function Di(){return Di=gn(yn().mark((function e(t,n,r,i){var a,o,u=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>4&&void 0!==u[4]?u[4]:{},e.next=3,Ci(t,n,r,i,a);case 3:return"mfaPendingCredential"in(o=e.sent)&&hi(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Di.apply(this,arguments)}function Oi(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?xi(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Li=function(){function e(t){var n=this;f(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(fi(n.auth,"network-request-failed"))}),Ti.get())}))}return y(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Mi(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=fi(e,t,r);return i.customData._tokenResponse=n,i}function Fi(e,t){return Ui.apply(this,arguments)}function Ui(){return(Ui=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vi(e,t){return ji.apply(this,arguments)}function ji(){return(ji=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qi(e,t){return Bi.apply(this,arguments)}function Bi(){return(Bi=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zi(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Wi(){return Wi=gn(yn().mark((function e(t){var n,r,i,a,o,u,s=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]&&s[1],r=vn(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,yi((a=Ki(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"===typeof a.firebase?a.firebase:void 0,u=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:zi(Hi(a.auth_time)),issuedAtTime:zi(Hi(a.iat)),expirationTime:zi(Hi(a.exp)),signInProvider:u||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),Wi.apply(this,arguments)}function Hi(e){return 1e3*Number(e)}function Ki(e){var t=c(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return li("JWT malformed, contained fewer than 3 sections"),null;try{var a=Nt(r);return a?JSON.parse(a):(li("Failed to decode base64 JWT payload"),null)}catch(o){return li("Caught error parsing JWT payload as JSON",null===o||void 0===o?void 0:o.toString()),null}}function Gi(e,t){return Qi.apply(this,arguments)}function Qi(){return Qi=gn(yn().mark((function e(t,n){var r=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof Wt&&Yi(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),Qi.apply(this,arguments)}function Yi(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var Xi=function(){function e(t){f(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return y(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),$i=function(){function e(t,n){f(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return y(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=zi(this.lastLoginAt),this.creationTime=zi(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Ji(e){return Zi.apply(this,arguments)}function Zi(){return Zi=gn(yn().mark((function e(t){var n,r,i,a,o,u,s,c,l,h,f;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Gi(t,qi(r,{idToken:i}));case 6:yi(null===(a=e.sent)||void 0===a?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),u=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?o.providerUserInfo.map((function(e){var t=e.providerId,n=Yr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],s=ta(t.providerData,u),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===s||void 0===s?void 0:s.length),h=!!c&&l,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new $i(o.createdAt,o.lastLoginAt),isAnonymous:h},Object.assign(t,f);case 17:case"end":return e.stop()}}),e)}))),Zi.apply(this,arguments)}function ea(){return(ea=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=vn(t),e.next=3,Ji(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ta(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(h(n),h(t))}function na(e,t){return ra.apply(this,arguments)}function ra(){return(ra=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ri(t,{},gn(yn().mark((function e(){var r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=nn({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,u=Oi(t,a,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(s=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",Ii.fetch()(u,{method:"POST",headers:s,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ia=function(){function e(){f(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return y(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){yi(e.idToken,"internal-error"),yi("undefined"!==typeof e.idToken,"internal-error"),yi("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=Ki(e);return yi(t,"internal-error"),yi("undefined"!==typeof t.exp,"internal-error"),yi("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=gn(yn().mark((function e(t){var n,r=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],yi(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,na(t,n);case 2:r=e.sent,i=r.accessToken,a=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(i,a,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return mi("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(yi("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(yi("string"===typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(yi("number"===typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function aa(e,t){yi("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var oa=function(){function e(t){f(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Yr(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xi(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?h(a.providerData):[],this.metadata=new $i(a.createdAt||void 0,a.lastLoginAt||void 0)}return y(e,[{key:"getIdToken",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gi(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(yi(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return Wi.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return ea.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(yi(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){var n=new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}},{key:"_onReload",value:function(e){yi(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=gn(yn().mark((function e(t){var n,r,i=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,Ji(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,Gi(this,Fi(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,u,s,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,b=n.providerData,x=n.stsTokenManager;yi(k&&x,t,"internal-error");var I=ia.fromJSON(this.name,x);yi("string"===typeof k,t,"internal-error"),aa(h,t.name),aa(f,t.name),yi("boolean"===typeof _,t,"internal-error"),yi("boolean"===typeof w,t,"internal-error"),aa(d,t.name),aa(p,t.name),aa(v,t.name),aa(y,t.name),aa(m,t.name),aa(g,t.name);var E=new e({uid:k,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:I,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(E.providerData=b.map((function(e){return Object.assign({},e)}))),y&&(E._redirectEventId=y),E}},{key:"_fromIdTokenResponse",value:function(){var t=gn(yn().mark((function t(n,r){var i,a,o,u=arguments;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]&&u[2],(a=new ia).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:a,isAnonymous:i}),t.next=6,Ji(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),ua=new Map;function sa(e){gi(e instanceof Function,"Expected a class definition");var t=ua.get(e);return t?(gi(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ua.set(e,t),t)}var ca=function(){function e(){f(this,e),this.type="NONE",this.storage={}}return y(e,[{key:"_isAvailable",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();ca.type="NONE";var la=ca;function ha(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var fa=function(){function e(t,n,r){f(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=ha(this.userKey,a.apiKey,o),this.fullPersistenceKey=ha("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return y(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?oa._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=gn(yn().mark((function t(n,r){var i,a,o,u,s,c,l,h,f,d,p,v=arguments;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(sa(la),n,i));case 3:return t.next=5,Promise.all(r.map(function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:a=t.sent.filter((function(e){return e})),o=a[0]||sa(la),u=ha(i,n.config.apiKey,n.name),s=null,c=T(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return h=l.value,t.prev=14,t.next=17,h._get(u);case 17:if(!(f=t.sent)){t.next=23;break}return d=oa._fromJSON(n,f),h!==o&&(s=d),o=h,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(p=a.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&p.length){t.next=40;break}return t.abrupt("return",new e(o,n,i));case 40:if(o=p[0],!s){t.next=44;break}return t.next=44,o._set(u,s.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(u);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,i));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function da(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ma(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(pa(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ka(t))return"Blackberry";if(_a(t))return"Webos";if(va(t))return"Safari";if((t.includes("chrome/")||ya(t))&&!t.includes("edge/"))return"Chrome";if(ga(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function pa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/firefox\//i.test(e)}function va(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ya(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/crios\//i.test(e)}function ma(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/iemobile/i.test(e)}function ga(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/android/i.test(e)}function ka(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/blackberry/i.test(e)}function _a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/webos/i.test(e)}function wa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ba(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return wa(e)||ga(e)||_a(e)||ka(e)||/windows phone/i.test(e)||ma(e)}function xa(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=da(Mt());break;case"Worker":t="".concat(da(Mt()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(vr,"/").concat(r)}function Ia(e){return Ea.apply(this,arguments)}function Ea(){return(Ea=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ci(t,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ta(e,t){return Sa.apply(this,arguments)}function Sa(){return(Sa=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"GET","/v2/recaptchaConfig",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ca(e){return void 0!==e&&void 0!==e.getResponse}function Na(e){return void 0!==e&&void 0!==e.enterprise}var Ra=y((function e(t){if(f(this,e),this.siteKey="",this.emailPasswordEnabled=!1,void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.emailPasswordEnabled=t.recaptchaEnforcementState.some((function(e){return"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState}))}));function Aa(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=fi("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Pa(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var Da=function(){function e(t){f(this,e),this.type="recaptcha-enterprise",this.auth=Ua(t)}return y(e,[{key:"verify",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a,o=this,u=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e,n,r){var i=window.grecaptcha;Na(i)?i.enterprise.ready((function(){i.enterprise.execute(e,{action:t}).then((function(e){n(e)})).catch((function(){n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))},i=function(){return i=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}if(null!=t.tenantId||null==t._agentRecaptchaConfig){e.next=3;break}return e.abrupt("return",t._agentRecaptchaConfig.siteKey);case 3:if(null==t.tenantId||void 0===t._tenantRecaptchaConfigs[t.tenantId]){e.next=5;break}return e.abrupt("return",t._tenantRecaptchaConfigs[t.tenantId].siteKey);case 5:return e.abrupt("return",new Promise(function(){var e=gn(yn().mark((function e(n,r){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ta(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((function(e){if(void 0!==e.recaptchaKey){var i=new Ra(e);return null==t.tenantId?t._agentRecaptchaConfig=i:t._tenantRecaptchaConfigs[t.tenantId]=i,n(i.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((function(e){r(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)},r=function(e){return i.apply(this,arguments)},t=u.length>0&&void 0!==u[0]?u[0]:"verify",n=u.length>1&&void 0!==u[1]&&u[1],e.abrupt("return",new Promise((function(e,t){r(o.auth).then((function(r){if(!n&&Na(window.grecaptcha))a(r,e,t);else{if("undefined"===typeof window)return void t(new Error("RecaptchaVerifier is only supported in browser"));Aa("https://www.google.com/recaptcha/enterprise.js?render="+r).then((function(){a(r,e,t)})).catch((function(e){t(e)}))}})).catch((function(e){t(e)}))})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Oa(e,t,n){return La.apply(this,arguments)}function La(){return La=gn(yn().mark((function e(t,n,r){var i,a,o,u,s=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>3&&void 0!==s[3]&&s[3],a=new Da(t),e.prev=2,e.next=5,a.verify(r);case 5:o=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),e.next=12,a.verify(r,!0);case 12:o=e.sent;case 13:return u=Object.assign({},n),i?Object.assign(u,{captchaResp:o}):Object.assign(u,{captchaResponse:o}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),e.abrupt("return",u);case 18:case"end":return e.stop()}}),e,null,[[2,8]])}))),La.apply(this,arguments)}var Ma=function(){function e(t){f(this,e),this.auth=t,this.queue=[]}return y(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(i){r(i)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=gn(yn().mark((function e(t){var n,r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=T(this.queue),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=14;break}return a=i.value,e.next=11,a(t);case 11:a.onAbort&&n.push(a.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),o=T(n);try{for(o.s();!(u=o.n()).done;){s=u.value;try{s()}catch(c){}}}catch(l){o.e(l)}finally{o.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Fa=function(){function e(t,n,r,i){f(this,e),this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Va(this),this.idTokenSubscription=new Va(this),this.beforeStateQueue=new Ma(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ui,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}return y(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=sa(t)),this._initializationPromise=this.queue(gn(yn().mark((function r(){var i,a;return yn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,fa.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=gn(yn().mark((function e(t){var n,r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,i=r,a=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,u=null===i||void 0===i?void 0:i._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:s=e.sent,o&&o!==u||!(null===s||void 0===s?void 0:s.user)||(i=s.user,a=!0);case 14:if(i){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(i._redirectEventId){e.next=32;break}if(!a){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(i);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),i=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!i){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return yi(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==i._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(i));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ji(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?vn(t):null)&&yi(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=gn(yn().mark((function e(t){var n,r=this,i=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&yi(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(gn(yn().mark((function n(){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(sa(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"initializeRecaptchaConfig",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ta(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"});case 2:t=e.sent,n=new Ra(t),null==this.tenantId?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new Da(this).verify();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getRecaptchaConfig",value:function(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new Ht("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return yi(n=t&&sa(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,fa.create(this,[sa(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=gn(yn().mark((function e(t){var n=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return yi(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return yi(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xa(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=gt({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.next=8,this._getAppCheckToken();case 8:return(i=e.sent)&&(n["X-Firebase-AppCheck"]=i),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();case 2:return(null===(n=e.sent)||void 0===n?void 0:n.error)&&ci("Error while retrieving App Check token: ".concat(n.error)),e.abrupt("return",null===n||void 0===n?void 0:n.token);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Ua(e){return vn(e)}var Va=function(){function e(t){var n=this;f(this,e),this.auth=t,this.observer=null,this.addObserver=un((function(e){return n.observer=e}))}return y(e,[{key:"next",get:function(){return yi(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function ja(e,t,n){var r=Ua(e);yi(r._canInitEmulator,r,"emulator-config-failed"),yi(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=qa(t),o=function(e){var t=qa(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:Ba(r.substr(a.length+1))}}var o=c(r.split(":"),2);return{host:o[0],port:Ba(o[1])}}(t),u=o.host,s=o.port,l=null===s?"":":".concat(s);r.config.emulator={url:"".concat(a,"//").concat(u).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function qa(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ba(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var za=function(){function e(t,n){f(this,e),this.providerId=t,this.signInMethod=n}return y(e,[{key:"toJSON",value:function(){return mi("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return mi("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return mi("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return mi("not implemented")}}]),e}();function Wa(e,t){return Ha.apply(this,arguments)}function Ha(){return(Ha=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:resetPassword",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ka(e,t){return Ga.apply(this,arguments)}function Ga(){return(Ga=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qa(e,t){return Ya.apply(this,arguments)}function Ya(){return(Ya=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:update",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xa(e,t){return $a.apply(this,arguments)}function $a(){return($a=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithPassword",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ja(e,t){return Za.apply(this,arguments)}function Za(){return(Za=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:sendOobCode",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eo(e,t){return to.apply(this,arguments)}function to(){return(to=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ja(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function no(e,t){return ro.apply(this,arguments)}function ro(){return(ro=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ja(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function io(e,t){return ao.apply(this,arguments)}function ao(){return(ao=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ja(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oo(e,t){return uo.apply(this,arguments)}function uo(){return(uo=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ja(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function so(e,t){return co.apply(this,arguments)}function co(){return(co=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithEmailLink",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lo(e,t){return ho.apply(this,arguments)}function ho(){return(ho=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithEmailLink",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fo=function(e){g(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return f(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return y(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?12:13;break;case 3:if(r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},!(null===(n=t._getRecaptchaConfig())||void 0===n?void 0:n.emailPasswordEnabled)){e.next=11;break}return e.next=7,Oa(t,r,"signInWithPassword");case 7:return i=e.sent,e.abrupt("return",Xa(t,i));case 11:return e.abrupt("return",Xa(t,r).catch(function(){var e=gn(yn().mark((function e(n){var i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow."),e.next=4,Oa(t,r,"signInWithPassword");case 4:return i=e.sent,e.abrupt("return",Xa(t,i));case 8:return e.abrupt("return",Promise.reject(n));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return e.abrupt("return",so(t,{email:this._email,oobCode:this._password}));case 13:hi(t,"internal-error");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Ka(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",lo(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:hi(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){return new n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(za);function po(e,t){return vo.apply(this,arguments)}function vo(){return(vo=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithIdp",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yo=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return y(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return po(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,po(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,po(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=nn(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hi("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Yr(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(za);function mo(e,t){return go.apply(this,arguments)}function go(){return(go=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:sendVerificationCode",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ko(){return(ko=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithPhoneNumber",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _o(){return(_o=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pi(t,"POST","/v1/accounts:signInWithPhoneNumber",Si(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Mi(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wo=gt({},"USER_NOT_FOUND","user-not-found");function bo(){return(bo=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithPhoneNumber",Si(t,r),wo));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xo=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,"phone","phone")).params=e,r}return y(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return ko.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return _o.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return bo.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,i=t.verificationCode,a=t.phoneNumber,o=t.temporaryProof;return i||r||a||o?new n({verificationId:r,verificationCode:i,phoneNumber:a,temporaryProof:o}):null}}]),n}(za);var Io=function(){function e(t){var n,r,i,a,o,u;f(this,e);var s=rn(an(t)),c=null!==(n=s.apiKey)&&void 0!==n?n:null,l=null!==(r=s.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=s.mode)&&void 0!==i?i:null);yi(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=s.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=s.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(u=s.tenantId)&&void 0!==u?u:null}return y(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=rn(an(e)).link,n=t?rn(an(t)).deep_link_id:null,r=rn(an(e)).deep_link_id;return(r?rn(an(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(JE){return null}}}]),e}();var Eo=function(){function e(){f(this,e),this.providerId=e.PROVIDER_ID}return y(e,null,[{key:"credential",value:function(e,t){return fo._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Io.parseLink(t);return yi(n,"argument-error"),fo._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();Eo.PROVIDER_ID="password",Eo.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Eo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var To=function(){function e(t){f(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return y(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),So=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).scopes=[],e}return y(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return h(this.scopes)}}]),n}(To),Co=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return yi(e.idToken||e.accessToken,"argument-error"),yo._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;return yi("providerId"in t&&"signInMethod"in t,"argument-error"),yo._fromParams(t)}},{key:"credentialFromResult",value:function(e){return n.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!i&&!a&&!r&&!o)return null;if(!s)return null;try{return new n(s)._credential({idToken:r,accessToken:i,nonce:u,pendingToken:o})}catch(c){return null}}}]),n}(So),No=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.call(this,"facebook.com")}return y(n,null,[{key:"credential",value:function(e){return yo._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(JE){return null}}}]),n}(So);No.FACEBOOK_SIGN_IN_METHOD="facebook.com",No.PROVIDER_ID="facebook.com";var Ro=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return y(n,null,[{key:"credential",value:function(e,t){return yo._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(JE){return null}}}]),n}(So);Ro.GOOGLE_SIGN_IN_METHOD="google.com",Ro.PROVIDER_ID="google.com";var Ao=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.call(this,"github.com")}return y(n,null,[{key:"credential",value:function(e){return yo._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(JE){return null}}}]),n}(So);Ao.GITHUB_SIGN_IN_METHOD="github.com",Ao.PROVIDER_ID="github.com";var Po=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,e)).pendingToken=r,i}return y(n,[{key:"_getIdTokenResponse",value:function(e){return po(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,po(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,po(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=t.pendingToken;return r&&i&&a&&r===i?new n(r,a):null}},{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(za),Do=function(e){g(n,e);var t=b(n);function n(e){return f(this,n),yi(e.startsWith("saml."),"argument-error"),t.call(this,e)}return y(n,null,[{key:"credentialFromResult",value:function(e){return n.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=Po.fromJSON(e);return yi(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return Po._create(r,n)}catch(i){return null}}}]),n}(To),Oo=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.call(this,"twitter.com")}return y(n,null,[{key:"credential",value:function(e,t){return yo._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,i=t.oauthTokenSecret;if(!r||!i)return null;try{return n.credential(r,i)}catch(JE){return null}}}]),n}(So);function Lo(e,t){return Mo.apply(this,arguments)}function Mo(){return(Mo=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signUp",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Oo.TWITTER_SIGN_IN_METHOD="twitter.com",Oo.PROVIDER_ID="twitter.com";var Fo=function(){function e(t){f(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return y(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=gn(yn().mark((function t(n,r,i){var a,o,u,s,c=arguments;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>3&&void 0!==c[3]&&c[3],t.next=3,oa._fromIdTokenResponse(n,i,a);case 3:return o=t.sent,u=Uo(i),s=new e({user:o,providerId:u,_tokenResponse:i,operationType:r}),t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=gn(yn().mark((function t(n,r,i){var a;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(i,!0);case 2:return a=Uo(i),t.abrupt("return",new e({user:n,providerId:a,_tokenResponse:i,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function Uo(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function Vo(){return Vo=gn(yn().mark((function e(t){var n,r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ua(t),e.next=3,r._initializationPromise;case 3:if(!(null===(n=r.currentUser)||void 0===n?void 0:n.isAnonymous)){e.next=5;break}return e.abrupt("return",new Fo({user:r.currentUser,providerId:null,operationType:"signIn"}));case 5:return e.next=7,Lo(r,{returnSecureToken:!0});case 7:return i=e.sent,e.next=10,Fo._fromIdTokenResponse(r,"signIn",i,!0);case 10:return a=e.sent,e.next=13,r._updateCurrentUser(a.user);case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)}))),Vo.apply(this,arguments)}var jo=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o,u;return f(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(w(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(u=e.tenantId)&&void 0!==u?u:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return y(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(Wt);function qo(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw jo._fromErrorAndOperation(e,n,t,r);throw n}))}function Bo(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function zo(e,t){return Wo.apply(this,arguments)}function Wo(){return Wo=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=vn(t),e.next=3,Go(!0,r,n);case 3:return e.t0=Vi,e.t1=r.auth,e.next=7,r.getIdToken();case 7:return e.t2=e.sent,e.t3=[n],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return i=e.sent,a=i.providerUserInfo,o=Bo(a||[]),r.providerData=r.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(r.phoneNumber=null),e.next=19,r.auth._persistUserIfCurrent(r);case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)}))),Wo.apply(this,arguments)}function Ho(e,t){return Ko.apply(this,arguments)}function Ko(){return Ko=gn(yn().mark((function e(t,n){var r,i,a=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Gi,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",Fo._forOperation(t,"link",i));case 14:case"end":return e.stop()}}),e)}))),Ko.apply(this,arguments)}function Go(e,t,n){return Qo.apply(this,arguments)}function Qo(){return(Qo=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ji(n);case 2:i=Bo(n.providerData),a=!1===t?"provider-already-linked":"no-such-provider",yi(i.has(r)===t,n.auth,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yo(e,t){return Xo.apply(this,arguments)}function Xo(){return Xo=gn(yn().mark((function e(t,n){var r,i,a,o,u,s,c=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],i=t.auth,a="reauthenticate",e.prev=3,e.next=6,Gi(t,qo(i,a,n,t),r);case 6:return yi((o=e.sent).idToken,i,"internal-error"),yi(u=Ki(o.idToken),i,"internal-error"),s=u.sub,yi(t.uid===s,i,"user-mismatch"),e.abrupt("return",Fo._forOperation(t,a,o));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&hi(i,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),Xo.apply(this,arguments)}function $o(e,t){return Jo.apply(this,arguments)}function Jo(){return Jo=gn(yn().mark((function e(t,n){var r,i,a,o,u=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],i="signIn",e.next=4,qo(t,i,n);case 4:return a=e.sent,e.next=7,Fo._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),Jo.apply(this,arguments)}function Zo(e,t){return eu.apply(this,arguments)}function eu(){return(eu=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$o(Ua(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tu(e,t){return nu.apply(this,arguments)}function nu(){return(nu=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=vn(t),e.next=3,Go(!1,r,n.providerId);case 3:return e.abrupt("return",Ho(r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ru(e,t){return iu.apply(this,arguments)}function iu(){return(iu=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yo(vn(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function au(e,t){return ou.apply(this,arguments)}function ou(){return(ou=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pi(t,"POST","/v1/accounts:signInWithCustomToken",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uu(){return(uu=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ua(t),e.next=3,au(r,{token:n,returnSecureToken:!0});case 3:return i=e.sent,e.next=6,Fo._fromIdTokenResponse(r,"signIn",i);case 6:return a=e.sent,e.next=9,r._updateCurrentUser(a.user);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var su=function(){function e(t,n){f(this,e),this.factorId=t,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}return y(e,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?cu._fromServerResponse(e,t):"totpInfo"in t?lu._fromServerResponse(e,t):hi(e,"internal-error")}}]),e}(),cu=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,"phone",e)).phoneNumber=e.phoneInfo,r}return y(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(su),lu=function(e){g(n,e);var t=b(n);function n(e){return f(this,n),t.call(this,"totp",e)}return y(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(su);function hu(e,t,n){var r;yi((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),yi("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(yi(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(yi(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function fu(){return fu=gn(yn().mark((function e(t,n,r){var i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Ua(t),o={requestType:"PASSWORD_RESET",email:n,clientType:"CLIENT_TYPE_WEB"},!(null===(i=a._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled)){e.next=11;break}return e.next=5,Oa(a,o,"getOobCode",!0);case 5:return u=e.sent,r&&hu(a,u,r),e.next=9,no(a,u);case 9:e.next=14;break;case 11:return r&&hu(a,o,r),e.next=14,no(a,o).catch(function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=10;break}return console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow."),e.next=4,Oa(a,o,"getOobCode",!0);case 4:return n=e.sent,r&&hu(a,n,r),e.next=8,no(a,n);case 8:e.next=11;break;case 10:return e.abrupt("return",Promise.reject(t));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 14:case"end":return e.stop()}}),e)}))),fu.apply(this,arguments)}function du(){return(du=gn(yn().mark((function e(t,n,r){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wa(vn(t),{oobCode:n,newPassword:r});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pu(){return(pu=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qa(vn(t),{oobCode:n});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vu(e,t){return yu.apply(this,arguments)}function yu(){return(yu=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=vn(t),e.next=3,Wa(r,{oobCode:n});case 3:i=e.sent,yi(a=i.requestType,r,"internal-error"),e.t0=a,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return yi(i.newEmail,r,"internal-error"),e.abrupt("break",14);case 12:yi(i.mfaInfo,r,"internal-error");case 13:yi(i.email,r,"internal-error");case 14:return o=null,i.mfaInfo&&(o=su._fromServerResponse(Ua(r),i.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:a});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mu(){return(mu=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vu(vn(t),n);case 2:return r=e.sent,i=r.data,e.abrupt("return",i.email);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gu(e,t,n){return ku.apply(this,arguments)}function ku(){return ku=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,c,l;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Ua(t),o={returnSecureToken:!0,email:n,password:r,clientType:"CLIENT_TYPE_WEB"},!(null===(i=a._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled)){e.next=9;break}return e.next=5,Oa(a,o,"signUpPassword");case 5:s=e.sent,u=Lo(a,s),e.next=10;break;case 9:u=Lo(a,o).catch(function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow."),e.next=4,Oa(a,o,"signUpPassword");case 4:return n=e.sent,e.abrupt("return",Lo(a,n));case 8:return e.abrupt("return",Promise.reject(t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:return e.next=12,u.catch((function(e){return Promise.reject(e)}));case 12:return c=e.sent,e.next=15,Fo._fromIdTokenResponse(a,"signIn",c);case 15:return l=e.sent,e.next=18,a._updateCurrentUser(l.user);case 18:return e.abrupt("return",l);case 19:case"end":return e.stop()}}),e)}))),ku.apply(this,arguments)}function _u(){return _u=gn(yn().mark((function e(t,n,r){var i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(e,t){yi(t.handleCodeInApp,a,"argument-error"),t&&hu(a,e,t)},a=Ua(t),o={requestType:"EMAIL_SIGNIN",email:n,clientType:"CLIENT_TYPE_WEB"},!(null===(i=a._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled)){e.next=12;break}return e.next=6,Oa(a,o,"getOobCode",!0);case 6:return s=e.sent,u(s,r),e.next=10,io(a,s);case 10:e.next=15;break;case 12:return u(o,r),e.next=15,io(a,o).catch(function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=10;break}return console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow."),e.next=4,Oa(a,o,"getOobCode",!0);case 4:return n=e.sent,u(n,r),e.next=8,io(a,n);case 8:e.next=11;break;case 10:return e.abrupt("return",Promise.reject(t));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 15:case"end":return e.stop()}}),e)}))),_u.apply(this,arguments)}function wu(){return(wu=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=vn(t),yi((a=Eo.credentialWithLink(n,r||ki()))._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),e.abrupt("return",Zo(i,a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bu(e,t){return xu.apply(this,arguments)}function xu(){return(xu=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:createAuthUri",Si(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Iu(){return(Iu=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_i()?ki():"http://localhost",i={identifier:n,continueUri:r},e.next=4,bu(vn(t),i);case 4:return a=e.sent,o=a.signinMethods,e.abrupt("return",o||[]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Eu(){return(Eu=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=vn(t),e.next=3,t.getIdToken();case 3:return i=e.sent,a={requestType:"VERIFY_EMAIL",idToken:i},n&&hu(r.auth,a,n),e.next=8,eo(r.auth,a);case 8:if(o=e.sent,o.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tu(){return(Tu=gn(yn().mark((function e(t,n,r){var i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=vn(t),e.next=3,t.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:a,newEmail:n},r&&hu(i.auth,o,r),e.next=8,oo(i.auth,o);case 8:if(u=e.sent,u.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Su(e,t){return Cu.apply(this,arguments)}function Cu(){return(Cu=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ci(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nu(){return(Nu=gn(yn().mark((function e(t,n){var r,i,a,o,u,s,c;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=vn(t),e.next=6,a.getIdToken();case 6:return o=e.sent,u={idToken:o,displayName:r,photoUrl:i,returnSecureToken:!0},e.next=10,Gi(a,Su(a.auth,u));case 10:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(c=a.providerData.find((function(e){return"password"===e.providerId})))&&(c.displayName=a.displayName,c.photoURL=a.photoURL),e.next=17,a._updateTokensIfNecessary(s);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ru(e,t,n){return Au.apply(this,arguments)}function Au(){return(Au=gn(yn().mark((function e(t,n,r){var i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,o={idToken:a,returnSecureToken:!0},n&&(o.email=n),r&&(o.password=r),e.next=9,Gi(t,Ka(i,o));case 9:return u=e.sent,e.next=12,t._updateTokensIfNecessary(u,!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pu=y((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};f(this,e),this.isNewUser=t,this.providerId=n,this.profile=r})),Du=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o;return f(this,n),(o=t.call(this,e,r,i)).username=a,o}return y(n)}(Pu),Ou=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"facebook.com",r)}return y(n)}(Pu),Lu=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"github.com",r,"string"===typeof(null===r||void 0===r?void 0:r.login)?null===r||void 0===r?void 0:r.login:null)}return y(n)}(Du),Mu=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"google.com",r)}return y(n)}(Pu),Fu=function(e){g(n,e);var t=b(n);function n(e,r,i){return f(this,n),t.call(this,e,"twitter.com",r,i)}return y(n)}(Du);function Uu(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){var o=null===(n=null===(t=Ki(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new Pu(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new Ou(a,i);case"github.com":return new Lu(a,i);case"google.com":return new Mu(a,i);case"twitter.com":return new Fu(a,i,e.screenName||null);case"custom":case"anonymous":return new Pu(a,null);default:return new Pu(a,r,i)}}(n)}var Vu=function(){function e(t,n,r){f(this,e),this.type=t,this.credential=n,this.auth=r}return y(e,[{key:"toJSON",value:function(){return{multiFactorSession:gt({},"enroll"===this.type?"idToken":"pendingCredential",this.credential)}}}],[{key:"_fromIdtoken",value:function(t,n){return new e("enroll",t,n)}},{key:"_fromMfaPendingCredential",value:function(t){return new e("signin",t)}},{key:"fromJSON",value:function(t){var n,r;if(null===t||void 0===t?void 0:t.multiFactorSession){if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return e._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(r=t.multiFactorSession)||void 0===r?void 0:r.idToken)return e._fromIdtoken(t.multiFactorSession.idToken)}return null}}]),e}(),ju=function(){function e(t,n,r){f(this,e),this.session=t,this.hints=n,this.signInResolver=r}return y(e,[{key:"resolveSignIn",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.abrupt("return",this.signInResolver(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromError",value:function(t,n){var r=Ua(t),i=n.customData._serverResponse,a=(i.mfaInfo||[]).map((function(e){return su._fromServerResponse(r,e)}));yi(i.mfaPendingCredential,r,"internal-error");var o=Vu._fromMfaPendingCredential(i.mfaPendingCredential);return new e(o,a,function(){var e=gn(yn().mark((function e(t){var a,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._process(r,o);case 2:a=e.sent,delete i.mfaInfo,delete i.mfaPendingCredential,u=Object.assign(Object.assign({},i),{idToken:a.idToken,refreshToken:a.refreshToken}),e.t0=n.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,Fo._fromIdTokenResponse(r,n.operationType,u);case 11:return s=e.sent,e.next=14,r._updateCurrentUser(s.user);case 14:return e.abrupt("return",s);case 15:return yi(n.user,r,"internal-error"),e.abrupt("return",Fo._forOperation(n.user,n.operationType,u));case 17:hi(r,"internal-error");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}();function qu(e,t){return Ci(e,"POST","/v2/accounts/mfaEnrollment:start",Si(e,t))}function Bu(e,t){return Ci(e,"POST","/v2/accounts/mfaEnrollment:finalize",Si(e,t))}var zu=function(){function e(t){var n=this;f(this,e),this.user=t,this.enrolledFactors=[],t._onReload((function(e){e.mfaInfo&&(n.enrolledFactors=e.mfaInfo.map((function(e){return su._fromServerResponse(t.auth,e)})))}))}return y(e,[{key:"getSession",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Vu,e.next=3,this.user.getIdToken();case 3:return e.t1=e.sent,e.t2=this.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enroll",value:function(){var e=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.getSession();case 3:return i=e.sent,e.next=6,Gi(this.user,r._process(this.user.auth,i,n));case 6:return a=e.sent,e.next=9,this.user._updateTokensIfNecessary(a);case 9:return e.abrupt("return",this.user.reload());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unenroll",value:function(){var e=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"===typeof t?t:t.uid,e.next=3,this.user.getIdToken();case 3:return r=e.sent,e.prev=4,e.next=7,Gi(this.user,Ci(a=this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",Si(a,{idToken:r,mfaEnrollmentId:n})));case 7:return i=e.sent,this.enrolledFactors=this.enrolledFactors.filter((function(e){return e.uid!==n})),e.next=11,this.user._updateTokensIfNecessary(i);case 11:return e.next=13,this.user.reload();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(4),e.t0;case 18:case"end":return e.stop()}var a}),e,this,[[4,15]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromUser",value:function(t){return new e(t)}}]),e}(),Wu=new WeakMap;var Hu="__sak",Ku=function(){function e(t,n){f(this,e),this.storageRetriever=t,this.type=n}return y(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Hu,"1"),this.storage.removeItem(Hu),Promise.resolve(!0)):Promise.resolve(!1)}catch(JE){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var Gu=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=Mt();return va(e)||wa(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=ba(),e._shouldAllowMigration=!0,e}return y(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);qt()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=gn(yn().mark((function e(t,r){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qr(k(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=gn(yn().mark((function e(t){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qr(k(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qr(k(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Ku);Gu.type="LOCAL";var Qu=Gu,Yu=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return y(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(Ku);Yu.type="SESSION";var Xu=Yu;function $u(e){return Promise.all(e.map(function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var Ju=function(){function e(t){f(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return y(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=gn(yn().mark((function e(t){var n,r,i,a,o,u,s,c;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,i=r.eventId,a=r.eventType,o=r.data,null===(u=this.handlersMap[a])||void 0===u?void 0:u.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:i,eventType:a}),s=Array.from(u).map(function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,$u(s);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function Zu(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ju.receivers=[];var es=function(){function e(t){f(this,e),this.target=t,this.handlers=new Set}return y(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o,u=this,s=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:50,i="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,s){var c=Zu("",20);i.port1.start();var l=setTimeout((function(){s(new Error("unsupported_event"))}),r);o={messageChannel:i,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),a=setTimeout((function(){s(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),e(n.data.response);break;default:clearTimeout(l),clearTimeout(a),s(new Error("invalid_response"))}}},u.handlers.add(o),i.port1.addEventListener("message",o.onMessage),u.target.postMessage({eventType:t,eventId:c,data:n},[i.port2])})).finally((function(){o&&u.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function ts(){return window}function ns(e){ts().location.href=e}function rs(){return"undefined"!==typeof ts().WorkerGlobalScope&&"function"===typeof ts().importScripts}function is(){return as.apply(this,arguments)}function as(){return(as=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function os(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var us="firebaseLocalStorageDb",ss="firebaseLocalStorage",cs="fbase_key",ls=function(){function e(t){f(this,e),this.request=t}return y(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function hs(e,t){return e.transaction([ss],t?"readwrite":"readonly").objectStore(ss)}function fs(){var e=indexedDB.deleteDatabase(us);return new ls(e).toPromise()}function ds(){var e=indexedDB.open(us,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(ss,{keyPath:cs})}catch(r){n(r)}})),e.addEventListener("success",gn(yn().mark((function n(){var r;return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(ss)){n.next=12;break}return r.close(),n.next=5,fs();case 5:return n.t0=t,n.next=8,ds();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function ps(e,t,n){return vs.apply(this,arguments)}function vs(){return vs=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=hs(t,!0).put((gt(i={},cs,n),gt(i,"value",r),i)),e.abrupt("return",new ls(a).toPromise());case 2:case"end":return e.stop()}}),e)}))),vs.apply(this,arguments)}function ys(e,t){return ms.apply(this,arguments)}function ms(){return ms=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=hs(t,!1).get(n),e.next=3,new ls(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}}),e)}))),ms.apply(this,arguments)}function gs(e,t){var n=hs(e,!0).delete(t);return new ls(n).toPromise()}var ks=function(){function e(){f(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return y(e,[{key:"_openDb",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,ds();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rs()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=gn(yn().mark((function e(){var t=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=Ju._getInstance(rs()?self:null),this.receiver._subscribe("keyChanged",function(){var e=gn(yn().mark((function e(n,r){var i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return i=e.sent,e.abrupt("return",{keyProcessed:i.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=gn(yn().mark((function e(){var t,n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,is();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new es(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&os()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,ds();case 5:return t=e.sent,e.next=8,ps(t,Hu,"1");case 8:return e.next=10,gs(t,Hu);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=gn(yn().mark((function e(t,n){var r=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return ps(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return ys(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=gn(yn().mark((function e(t){var n=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return gs(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a,o,u,s,c,l,h;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=hs(e,!1).getAll();return new ls(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,i=T(t);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.fbase_key,s=o.value,r.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(s)&&(this.notifyListeners(u,s),n.push(u))}catch(f){i.e(f)}finally{i.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)h=l[c],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();ks.type="LOCAL";var _s=ks;function ws(e,t){return Ci(e,"POST","/v2/accounts/mfaSignIn:start",Si(e,t))}function bs(e,t){return Ci(e,"POST","/v2/accounts/mfaSignIn:finalize",Si(e,t))}var xs=1e12,Is=function(){function e(t){f(this,e),this.auth=t,this.counter=xs,this._widgets=new Map}return y(e,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new Es(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||xs;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||xs;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||xs,null===(n=this._widgets.get(r))||void 0===n||n.execute(),e.abrupt("return","");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Es=function(){function e(t,n,r){var i=this;f(this,e),this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){i.execute()};var a="string"===typeof t?document.getElementById(t):t;yi(a,"argument-error",{appName:n}),this.container=a,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return y(e,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);var t=e.params,n=t.callback,r=t["expired-callback"];if(n)try{n(e.responseToken)}catch(i){}e.timerId=window.setTimeout((function(){if(e.timerId=null,e.responseToken=null,r)try{r()}catch(i){}e.isVisible&&e.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),e}();var Ts=Pa("rcb"),Ss=new bi(3e4,6e4),Cs=function(){function e(){var t;f(this,e),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(t=ts().grecaptcha)||void 0===t?void 0:t.render)}return y(e,[{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return yi(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Ca(ts().grecaptcha)?Promise.resolve(ts().grecaptcha):new Promise((function(r,i){var a=ts().setTimeout((function(){i(fi(e,"network-request-failed"))}),Ss.get());ts()[Ts]=function(){ts().clearTimeout(a),delete ts()[Ts];var o=ts().grecaptcha;if(o&&Ca(o)){var u=o.render;o.render=function(e,n){var r=u(e,n);return t.counter++,r},t.hostLanguage=n,r(o)}else i(fi(e,"internal-error"))},Aa("".concat("https://www.google.com/recaptcha/api.js?","?").concat(nn({onload:Ts,render:"explicit",hl:n}))).catch((function(){clearTimeout(a),i(fi(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=ts().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),e}();var Ns=function(){function e(){f(this,e)}return y(e,[{key:"load",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Is(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearedOneInstance",value:function(){}}]),e}(),Rs="recaptcha",As={theme:"light",type:"image"},Ps=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},As),r=arguments.length>2?arguments[2]:void 0;f(this,e),this.parameters=n,this.type=Rs,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ua(r),this.isInvisible="invisible"===this.parameters.size,yi("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");var i="string"===typeof t?document.getElementById(t):t;yi(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ns:new Cs,this.validateStartingState()}return y(e,[{key:"verify",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotDestroyed(),e.next=3,this.render();case 3:if(t=e.sent,n=this.getAssertedRecaptcha(),!(r=n.getResponse(t))){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new Promise((function(e){i.tokenChangeListeners.add((function t(n){n&&(i.tokenChangeListeners.delete(t),e(n))})),i.isInvisible&&n.execute(t)})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){yi(!this.parameters.sitekey,this.auth,"argument-error"),yi(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),yi("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"===typeof e)e(n);else if("string"===typeof e){var r=ts()[e];"function"===typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){yi(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.widgetId||(t=this.container,this.isInvisible||(n=document.createElement("div"),t.appendChild(n),t=n),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),e.abrupt("return",this.widgetId);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return yi(_i()&&!rs(),this.auth,"internal-error"),e.next=3,Ds();case 3:return e.next=5,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);case 5:return this.recaptcha=e.sent,e.next=8,Ia(this.auth);case 8:yi(t=e.sent,this.auth,"internal-error"),this.parameters.sitekey=t;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAssertedRecaptcha",value:function(){return yi(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),e}();function Ds(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}var Os=function(){function e(t,n){f(this,e),this.verificationId=t,this.onConfirmation=n}return y(e,[{key:"confirm",value:function(e){var t=xo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),e}();function Ls(){return(Ls=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ua(t),e.next=3,Vs(i,n,vn(r));case 3:return a=e.sent,e.abrupt("return",new Os(a,(function(e){return Zo(i,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ms(e,t,n){return Fs.apply(this,arguments)}function Fs(){return(Fs=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=vn(t),e.next=3,Go(!1,i,"phone");case 3:return e.next=5,Vs(i.auth,n,vn(r));case 5:return a=e.sent,e.abrupt("return",new Os(a,(function(e){return tu(i,e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Us(){return(Us=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=vn(t),e.next=3,Vs(i.auth,n,vn(r));case 3:return a=e.sent,e.abrupt("return",new Os(a,(function(e){return ru(i,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vs(e,t,n){return js.apply(this,arguments)}function js(){return js=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(a=e.sent,e.prev=3,yi("string"===typeof a,t,"argument-error"),yi(r.type===Rs,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(u=o.session,!("phoneNumber"in o)){e.next=17;break}return yi("enroll"===u.type,t,"internal-error"),e.next=13,qu(t,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:a}});case 13:return s=e.sent,e.abrupt("return",s.phoneSessionInfo.sessionInfo);case 17:return yi("signin"===u.type,t,"internal-error"),yi(c=(null===(i=o.multiFactorHint)||void 0===i?void 0:i.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,ws(t,{mfaPendingCredential:u.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:a}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,mo(t,{phoneNumber:o.phoneNumber,recaptchaToken:a});case 28:return h=e.sent,f=h.sessionInfo,e.abrupt("return",f);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),js.apply(this,arguments)}function qs(){return(qs=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ho(vn(t),n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Bs=function(){function e(t){f(this,e),this.providerId=e.PROVIDER_ID,this.auth=Ua(t)}return y(e,[{key:"verifyPhoneNumber",value:function(e,t){return Vs(this.auth,e,vn(t))}}],[{key:"credential",value:function(e,t){return xo._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?xo._fromTokenResponse(n,r):null}}]),e}();function zs(e,t){return t?sa(t):(yi(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Bs.PROVIDER_ID="phone",Bs.PHONE_SIGN_IN_METHOD="phone";var Ws=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,"custom","custom")).params=e,r}return y(n,[{key:"_getIdTokenResponse",value:function(e){return po(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return po(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return po(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(za);function Hs(e){return $o(e.auth,new Ws(e),e.bypassAuthState)}function Ks(e){var t=e.auth,n=e.user;return yi(n,t,"internal-error"),Yo(n,new Ws(e),e.bypassAuthState)}function Gs(e){return Qs.apply(this,arguments)}function Qs(){return(Qs=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,yi(r=t.user,n,"internal-error"),e.abrupt("return",Ho(r,new Ws(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ys=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];f(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return y(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=gn(yn().mark((function t(n,r){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=gn(yn().mark((function e(t){var n,r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,i=t.postBody,a=t.tenantId,o=t.error,u=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return s={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(u)(s);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Hs;case"linkViaPopup":case"linkViaRedirect":return Gs;case"reauthViaPopup":case"reauthViaRedirect":return Ks;default:hi(this.auth,"internal-error")}}},{key:"resolve",value:function(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),Xs=new bi(2e3,1e4);function $s(e,t,n){return Js.apply(this,arguments)}function Js(){return(Js=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ua(t),pi(t,n,To),a=zs(i,r),o=new nc(i,"signInViaPopup",n,a),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zs(){return(Zs=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pi((i=vn(t)).auth,n,To),a=zs(i.auth,r),o=new nc(i.auth,"reauthViaPopup",n,a,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ec(e,t,n){return tc.apply(this,arguments)}function tc(){return(tc=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pi((i=vn(t)).auth,n,To),a=zs(i.auth,r),o=new nc(i.auth,"linkViaPopup",n,a,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var nc=function(e){g(n,e);var t=b(n);function n(e,r,i,a,o){var u;return f(this,n),(u=t.call(this,e,r,a,o)).provider=i,u.authWindow=null,u.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=w(u),u}return y(n,[{key:"executeNotNull",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return yi(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=gn(yn().mark((function e(){var t,n=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gi(1===this.filter.length,"Popup operations only handle one event"),t=Zu(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(fi(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(fi(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(fi(e.auth,"popup-closed-by-user"))}),8e3):e.pollId=window.setTimeout(t,Xs.get())}()}}]),n}(Ys);nc.currentPopupAction=null;var rc="pendingRedirect",ic=new Map,ac=function(e){g(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return y(n,[{key:"execute",value:function(){var e=gn(yn().mark((function e(){var t,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ic.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,oc(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,Qr(k(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:ic.set(this.auth._key(),t);case 21:return this.bypassAuthState||ic.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=gn(yn().mark((function e(t){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",Qr(k(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",Qr(k(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(Ys);function oc(e,t){return uc.apply(this,arguments)}function uc(){return(uc=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=fc(n),i=hc(t),e.next=4,i._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,i._get(r);case 8:return e.t0=e.sent,a="true"===e.t0,e.next=12,i._remove(r);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function sc(e,t){return cc.apply(this,arguments)}function cc(){return(cc=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",hc(t)._set(fc(n),"true"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lc(e,t){ic.set(e._key(),t)}function hc(e){return sa(e._redirectPersistence)}function fc(e){return ha(rc,e.config.apiKey,e.name)}function dc(e,t,n){return function(e,t,n){return pc.apply(this,arguments)}(e,t,n)}function pc(){return(pc=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ua(t),pi(t,n,To),e.next=4,i._initializationPromise;case 4:return a=zs(i,r),e.next=7,sc(a,i);case 7:return e.abrupt("return",a._openRedirect(i,n,"signInViaRedirect"));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vc(e,t,n){return function(e,t,n){return yc.apply(this,arguments)}(e,t,n)}function yc(){return(yc=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pi((i=vn(t)).auth,n,To),e.next=4,i.auth._initializationPromise;case 4:return a=zs(i.auth,r),e.next=7,sc(a,i.auth);case 7:return e.next=9,xc(i);case 9:return o=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"reauthViaRedirect",o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mc(e,t,n){return function(e,t,n){return gc.apply(this,arguments)}(e,t,n)}function gc(){return(gc=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return pi((i=vn(t)).auth,n,To),e.next=4,i.auth._initializationPromise;case 4:return a=zs(i.auth,r),e.next=7,Go(!1,i,n.providerId);case 7:return e.next=9,sc(a,i.auth);case 9:return e.next=11,xc(i);case 11:return o=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"linkViaRedirect",o));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kc(e,t){return _c.apply(this,arguments)}function _c(){return(_c=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ua(t)._initializationPromise;case 2:return e.abrupt("return",wc(t,n,!1));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wc(e,t){return bc.apply(this,arguments)}function bc(){return bc=gn(yn().mark((function e(t,n){var r,i,a,o,u,s=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=Ua(t),a=zs(i,n),o=new ac(i,a,r),e.next=6,o.execute();case 6:if(!(u=e.sent)||r){e.next=13;break}return delete u.user._redirectEventId,e.next=11,i._persistUserIfCurrent(u.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)}))),bc.apply(this,arguments)}function xc(e){return Ic.apply(this,arguments)}function Ic(){return(Ic=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Zu("".concat(t.uid,":::")),t._redirectEventId=n,e.next=4,t.auth._setRedirectUser(t);case 4:return e.next=6,t.auth._persistUserIfCurrent(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ec=function(){function e(t){f(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return y(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Sc(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Sc(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(fi(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tc(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Tc(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function Tc(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Sc(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function Cc(e){return Nc.apply(this,arguments)}function Nc(){return Nc=gn(yn().mark((function e(t){var n,r=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Ci(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Nc.apply(this,arguments)}var Rc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ac=/^https?/;function Pc(){return(Pc=gn(yn().mark((function e(t){var n,r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Cc(t);case 4:n=e.sent,r=n.authorizedDomains,i=T(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!Dc(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:hi(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])})))).apply(this,arguments)}function Dc(e){var t=ki(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Ac.test(r))return!1;if(Rc.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var Oc=new bi(3e4,6e4);function Lc(){var e=ts().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=h(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var Mc=null;function Fc(e){return Mc=Mc||function(e){return new Promise((function(t,n){var r,i,a;function o(){Lc(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Lc(),n(fi(e,"network-request-failed"))},timeout:Oc.get()})}if(null===(i=null===(r=ts().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=ts().gapi)||void 0===a?void 0:a.load)){var u=Pa("iframefcb");return ts()[u]=function(){gapi.load?o():n(fi(e,"network-request-failed"))},Aa("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Mc=null,e}))}(e),Mc}var Uc=new bi(5e3,15e3),Vc="__/auth/iframe",jc="emulator/auth/iframe",qc={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Bc=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zc(e){var t=e.config;yi(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?xi(t,jc):"https://".concat(e.config.authDomain,"/").concat(Vc),r={apiKey:t.apiKey,appName:e.name,v:vr},i=Bc.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(nn(r).slice(1))}function Wc(e){return Hc.apply(this,arguments)}function Hc(){return Hc=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fc(t);case 2:return n=e.sent,yi(r=ts().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:zc(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qc,dontclear:!0},(function(e){return new Promise(function(){var n=gn(yn().mark((function n(r,i){var a,o,u;return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=function(){ts().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=fi(t,"network-request-failed"),o=ts().setTimeout((function(){i(a)}),Uc.get()),e.ping(u).then(u,(function(){i(a)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Hc.apply(this,arguments)}var Kc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Gc=function(){function e(t){f(this,e),this.window=t,this.associatedEvent=null}return y(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function Qc(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",s=Object.assign(Object.assign({},Kc),{width:r.toString(),height:i.toString(),top:a,left:o}),l=Mt().toLowerCase();n&&(u=ya(l)?"_blank":n),pa(l)&&(t=t||"http://localhost",s.scrollbars="yes");var h=Object.entries(s).reduce((function(e,t){var n=c(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(function(){var e;return wa(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==u)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",u),new Gc(null);var f=window.open(t||"",u,h);yi(f,e,"popup-blocked");try{f.focus()}catch(d){}return new Gc(f)}var Yc="__/auth/handler",Xc="emulator/auth/handler",$c=encodeURIComponent("fac");function Jc(e,t,n,r,i,a){return Zc.apply(this,arguments)}function Zc(){return(Zc=gn(yn().mark((function e(t,n,r,i,a,o){var u,s,l,h,f,d,p,v,y,m,g,k,_;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(yi(t.config.authDomain,t,"auth-domain-config-required"),yi(t.config.apiKey,t,"invalid-api-key"),u={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:vr,eventId:a},n instanceof To)for(n.setDefaultLanguage(t.languageCode),u.providerId=n.providerId||"",Jt(n.getCustomParameters())||(u.customParameters=JSON.stringify(n.getCustomParameters())),s=0,l=Object.entries(o||{});s<l.length;s++)h=c(l[s],2),f=h[0],d=h[1],u[f]=d;for(n instanceof So&&(p=n.getScopes().filter((function(e){return""!==e}))).length>0&&(u.scopes=p.join(",")),t.tenantId&&(u.tid=t.tenantId),v=u,y=0,m=Object.keys(v);y<m.length;y++)g=m[y],void 0===v[g]&&delete v[g];return e.next=10,t._getAppCheckToken();case 10:return k=e.sent,_=k?"#".concat($c,"=").concat(encodeURIComponent(k)):"",e.abrupt("return","".concat(el(t),"?").concat(nn(v).slice(1)).concat(_));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function el(e){var t=e.config;return t.emulator?xi(t,Xc):"https://".concat(t.authDomain,"/").concat(Yc)}var tl="webStorageSupport",nl=function(){function e(){f(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xu,this._completeRedirectFn=wc,this._overrideRedirectResult=lc}return y(e,[{key:"_openPopup",value:function(){var e=gn(yn().mark((function e(t,n,r,i){var a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gi(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()"),e.next=3,Jc(t,n,r,ki(),i);case 3:return o=e.sent,e.abrupt("return",Qc(t,o,Zu()));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=gn(yn().mark((function e(t,n,r,i){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return e.next=4,Jc(t,n,r,ki(),i);case 4:return ns(e.sent),e.abrupt("return",new Promise((function(){})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(gi(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wc(t);case 2:return n=e.sent,r=new Ec(t),n.register("authEvent",(function(e){return yi(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(tl,{type:tl},(function(n){var r,i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[tl];void 0!==i&&t(!!i),hi(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Pc.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return ba()||va()||wa()}}]),e}(),rl=nl,il=function(){function e(t){f(this,e),this.factorId=t}return y(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return mi("unexpected MultiFactorSessionType")}}}]),e}(),al=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,"phone")).credential=e,r}return y(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Ci(e,"POST","/v2/accounts/mfaEnrollment:finalize",Si(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Ci(e,"POST","/v2/accounts/mfaSignIn:finalize",Si(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(il),ol=function(){function e(){f(this,e)}return y(e,null,[{key:"assertion",value:function(e){return al._fromCredential(e)}}]),e}();ol.FACTOR_ID="phone";var ul=function(){function e(){f(this,e)}return y(e,null,[{key:"assertionForEnrollment",value:function(e,t){return sl._fromSecret(e,t)}},{key:"assertionForSignIn",value:function(e,t){return sl._fromEnrollmentId(e,t)}},{key:"generateSecret",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return yi("undefined"!==typeof(n=t).auth,"internal-error"),e.next=4,i=n.auth,a={idToken:n.credential,totpEnrollmentInfo:{}},Ci(i,"POST","/v2/accounts/mfaEnrollment:start",Si(i,a));case 4:return r=e.sent,e.abrupt("return",cl._fromStartTotpMfaEnrollmentResponse(r,n.auth));case 6:case"end":return e.stop()}var i,a}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();ul.FACTOR_ID="totp";var sl=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this,"totp")).otp=e,a.enrollmentId=r,a.secret=i,a}return y(n,[{key:"_finalizeEnroll",value:function(){var e=gn(yn().mark((function e(t,n,r){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return yi("undefined"!==typeof this.secret,t,"argument-error"),e.abrupt("return",Bu(t,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_finalizeSignIn",value:function(){var e=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return yi(void 0!==this.enrollmentId&&void 0!==this.otp,t,"argument-error"),r={verificationCode:this.otp},e.abrupt("return",bs(t,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"_fromSecret",value:function(e,t){return new n(t,void 0,e)}},{key:"_fromEnrollmentId",value:function(e,t){return new n(t,e)}}]),n}(il),cl=function(){function e(t,n,r,i,a,o,u){f(this,e),this.sessionInfo=o,this.auth=u,this.secretKey=t,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=a}return y(e,[{key:"_makeTotpVerificationInfo",value:function(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}},{key:"generateQrCodeUrl",value:function(e,t){var n,r=!1;return(ll(e)||ll(t))&&(r=!0),r&&(ll(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),ll(t)&&(t=this.auth.name)),"otpauth://totp/".concat(t,":").concat(e,"?secret=").concat(this.secretKey,"&issuer=").concat(t,"&algorithm=").concat(this.hashingAlgorithm,"&digits=").concat(this.codeLength)}}],[{key:"_fromStartTotpMfaEnrollmentResponse",value:function(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}}]),e}();function ll(e){return"undefined"===typeof e||0===(null===e||void 0===e?void 0:e.length)}var hl="@firebase/auth",fl="0.23.2",dl=function(){function e(t){f(this,e),this.auth=t,this.internalListeners=new Map}return y(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){yi(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var pl;!function(e){var t;null===(t=Pt())||void 0===t||t["_".concat(e)]}("authIdTokenMaxAge");function vl(){return window}pl="Browser",sr(new kn("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),o=r.options,u=o.apiKey,s=o.authDomain;yi(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});var c={apiKey:u,authDomain:s,clientPlatform:pl,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xa(pl)},l=new Fa(r,i,a,c);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(sa);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),sr(new kn("auth-internal",(function(e){return function(e){return new dl(e)}(Ua(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),wr(hl,fl,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(pl)),wr(hl,fl,"esm2017");var yl=2e3;function ml(e,t,n){return gl.apply(this,arguments)}function gl(){return gl=gn(yn().mark((function e(t,n,r){var i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=vl(),o=a.BuildInfo,gi(n.sessionId,"AuthEvent did not contain a session ID"),e.next=4,Il(n.sessionId);case 4:return u=e.sent,s={},wa()?s.ibi=o.packageName:ga()?s.apn=o.packageName:hi(t,"operation-not-supported-in-this-environment"),o.displayName&&(s.appDisplayName=o.displayName),s.sessionId=u,e.abrupt("return",Jc(t,r,n.type,void 0,null!==(i=n.eventId)&&void 0!==i?i:void 0,s));case 10:case"end":return e.stop()}}),e)}))),gl.apply(this,arguments)}function kl(){return(kl=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=vl(),r=n.BuildInfo,i={},wa()?i.iosBundleId=r.packageName:ga()?i.androidPackageName=r.packageName:hi(t,"operation-not-supported-in-this-environment"),e.next=5,Cc(t,i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _l(e){var t=vl().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}function wl(e,t,n){return bl.apply(this,arguments)}function bl(){return bl=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=vl(),a=i.cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,i){var u=null;function s(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"===typeof n&&n(),"function"===typeof(null===r||void 0===r?void 0:r.close)&&r.close()}function c(){u||(u=window.setTimeout((function(){i(fi(t,"redirect-cancelled-by-user"))}),yl))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}n.addPassiveListener(s),document.addEventListener("resume",c,!1),ga()&&document.addEventListener("visibilitychange",l,!1),o=function(){n.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),u&&window.clearTimeout(u)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])}))),bl.apply(this,arguments)}function xl(e){var t,n,r,i,a,o,u,s,c,l,h=vl();yi("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),yi("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),yi("function"===typeof(null===(a=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),yi("function"===typeof(null===(s=null===(u=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),yi("function"===typeof(null===(l=null===(c=null===h||void 0===h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function Il(e){return El.apply(this,arguments)}function El(){return(El=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Tl(t),e.next=3,crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,i=Array.from(new Uint8Array(r)),e.abrupt("return",i.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tl(e){if(gi(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}var Sl=20,Cl=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).passiveListeners=new Set,e.initPromise=new Promise((function(t){e.resolveInialized=t})),e}return y(n,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(e){return this.resolveInialized(),this.passiveListeners.forEach((function(t){return t(e)})),Qr(k(n.prototype),"onEvent",this).call(this,e)}},{key:"initialized",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ec);function Nl(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:Ol(),postBody:null,tenantId:e.tenantId,error:fi(e,"no-auth-event")}}function Rl(e,t){return Ll()._set(Ml(e),t)}function Al(e){return Pl.apply(this,arguments)}function Pl(){return(Pl=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ll()._get(Ml(t));case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,Ll()._remove(Ml(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dl(e,t){var n,r,i=function(e){var t=Fl(e),n=t.link?decodeURIComponent(t.link):void 0,r=Fl(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Fl(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=Fl(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null===o||void 0===o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?fi(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Ol(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<Sl;n++){var r=Math.floor(62*Math.random());e.push(t.charAt(r))}return e.join("")}function Ll(){return sa(Qu)}function Ml(e){return ha("authEvent",e.config.apiKey,e.name)}function Fl(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};var t=E(e.split("?"));t[0];return rn(t.slice(1).join("?"))}var Ul=function(){function e(){f(this,e),this._redirectPersistence=Xu,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=wc,this._overrideRedirectResult=lc}return y(e,[{key:"_initialize",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._key(),(r=this.eventManagers.get(n))||(r=new Cl(t),this.eventManagers.set(n,r),this.attachCallbackListeners(t,r)),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(e){hi(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(){var e=gn(yn().mark((function e(t,n,r,i){var a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xl(t),e.next=3,this._initialize(t);case 3:return a=e.sent,e.next=6,a.initialized();case 6:return a.resetRedirect(),ic.clear(),e.next=10,this._originValidation(t);case 10:return o=Nl(t,r,i),e.next=13,Rl(t,o);case 13:return e.next=15,ml(t,o,n);case 15:return u=e.sent,e.next=18,_l(u);case 18:return s=e.sent,e.abrupt("return",wl(t,a,s));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return kl.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(e,t){var n=vl(),r=n.universalLinks,i=n.handleOpenURL,a=n.BuildInfo,o=setTimeout(gn(yn().mark((function n(){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Al(e);case 2:t.onEvent(jl());case 3:case"end":return n.stop()}}),n)}))),500),u=function(){var n=gn(yn().mark((function n(r){var i,a;return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(o),n.next=3,Al(e);case 3:i=n.sent,a=null,i&&(null===r||void 0===r?void 0:r.url)&&(a=Dl(i,r.url)),t.onEvent(a||jl());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();"undefined"!==typeof r&&"function"===typeof r.subscribe&&r.subscribe(null,u);var s=i,c="".concat(a.packageName.toLowerCase(),"://");vl().handleOpenURL=function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.toLowerCase().startsWith(c)&&u({url:t}),"function"===typeof s)try{s(t)}catch(n){console.error(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]),e}(),Vl=Ul;function jl(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:fi("no-auth-event")}}var ql=1e3;function Bl(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function zl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return!("file:"!==Bl()&&"ionic:"!==Bl()&&"capacitor:"!==Bl()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Wl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return qt()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt();return/Edge\/\d+/.test(e)}(e)}function Hl(){try{var e=self.localStorage,t=Zu();if(e)return e.setItem(t,"1"),e.removeItem(t),!Wl()||zt()}catch(n){return Kl()&&zt()}return!1}function Kl(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Gl(){return("http:"===Bl()||"https:"===Bl()||Vt()||zl())&&!(jt()||Ut())&&Hl()&&!Kl()}function Ql(){return zl()&&"undefined"!==typeof document}function Yl(){return Xl.apply(this,arguments)}function Xl(){return(Xl=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ql()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),ql);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $l={LOCAL:"local",NONE:"none",SESSION:"session"},Jl=yi,Zl="persistence";function eh(e,t){Jl(Object.values($l).includes(t),e,"invalid-persistence-type"),jt()?Jl(t!==$l.SESSION,e,"unsupported-persistence-type"):Ut()?Jl(t===$l.NONE,e,"unsupported-persistence-type"):Kl()?Jl(t===$l.NONE||t===$l.LOCAL&&zt(),e,"unsupported-persistence-type"):Jl(t===$l.NONE||Hl(),e,"unsupported-persistence-type")}function th(e){return nh.apply(this,arguments)}function nh(){return(nh=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._initializationPromise;case 2:n=rh(),r=ha(Zl,t.config.apiKey,t.name),n&&n.setItem(r,t._getPersistence());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rh(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}var ih=yi,ah=function(){function e(){f(this,e),this.browserResolver=sa(rl),this.cordovaResolver=sa(Vl),this.underlyingResolver=null,this._redirectPersistence=Xu,this._completeRedirectFn=wc,this._overrideRedirectResult=lc}return y(e,[{key:"_initialize",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(){var e=gn(yn().mark((function e(t,n,r,i){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=gn(yn().mark((function e(t,n,r,i){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return Ql()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return ih(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Yl();case 4:t=e.sent,this.underlyingResolver=t?this.cordovaResolver:this.browserResolver;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function oh(e){return e.unwrap()}function uh(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code))t.resolver=new fh(e,function(e,t){var n,r=vn(e),i=t;return yi(t.customData.operationType,r,"argument-error"),yi(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),ju._fromError(r,i)}(e,t));else if(r){var i=sh(t),a=t;i&&(a.credential=i,a.tenantId=r.tenantId||void 0,a.email=r.email||void 0,a.phoneNumber=r.phoneNumber||void 0)}}function sh(e){var t=(e instanceof Wt?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof Wt)&&"temporaryProof"in t&&"phoneNumber"in t)return Bs.credentialFromResult(e);var n,r=t.providerId;if(!r||r===$r.PASSWORD)return null;switch(r){case $r.GOOGLE:n=Ro;break;case $r.FACEBOOK:n=No;break;case $r.GITHUB:n=Ao;break;case $r.TWITTER:n=Oo;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?Po._create(r,u):yo._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new Co(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof Wt?n.credentialFromError(e):n.credentialFromResult(e)}function ch(e,t){return t.catch((function(t){throw t instanceof Wt&&uh(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,sh(t)),additionalUserInfo:Uu(e),user:dh.getOrCreate(r)}}))}function lh(e,t){return hh.apply(this,arguments)}function hh(){return(hh=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return r=e.sent,e.abrupt("return",{verificationId:r.verificationId,confirm:function(e){return ch(t,r.confirm(e))}});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fh=function(){function e(t,n){f(this,e),this.resolver=n,this.auth=t.wrapped()}return y(e,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return ch(oh(this.auth),this.resolver.resolveSignIn(e))}}]),e}(),dh=function(){function e(t){f(this,e),this._delegate=t,this.multiFactor=function(e){var t=vn(e);return Wu.has(t)||Wu.set(t,zu._fromUser(t)),Wu.get(t)}(t)}return y(e,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ch(this.auth,tu(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithPhoneNumber",value:function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lh(this.auth,Ms(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"linkWithPopup",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ch(this.auth,ec(this._delegate,t,ah)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithRedirect",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,th(Ua(this.auth));case 2:return e.abrupt("return",mc(this._delegate,t,ah));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ch(this.auth,ru(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return lh(this.auth,function(e,t,n){return Us.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return ch(this.auth,function(e,t,n){return Zs.apply(this,arguments)}(this._delegate,e,ah))}},{key:"reauthenticateWithRedirect",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,th(Ua(this.auth));case 2:return e.abrupt("return",vc(this._delegate,t,ah));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmailVerification",value:function(e){return function(e,t){return Eu.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zo(this._delegate,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEmail",value:function(e){return function(e,t){return Ru(vn(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return Ru(vn(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return qs.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return Nu.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return Tu.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(t){return e.USER_MAP.has(t)||e.USER_MAP.set(t,new e(t)),e.USER_MAP.get(t)}}]),e}();dh.USER_MAP=new WeakMap;var ph=yi,vh=function(){function e(t,n){if(f(this,e),this.app=t,n.isInitialized())return this._delegate=n.getImmediate(),void this.linkUnderlyingAuth();var r=t.options.apiKey;ph(r,"invalid-api-key",{appName:t.name}),ph(r,"invalid-api-key",{appName:t.name});var i="undefined"!==typeof window?ah:void 0;this._delegate=n.initialize({options:{persistence:mh(r,t.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(ai),this.linkUnderlyingAuth()}return y(e,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?dh.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){ja(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return pu.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return vu(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return du.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ch(this._delegate,gu(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return Iu.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=Io.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ph(Gl(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,kc(this._delegate,ah);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",ch(this._delegate,Promise.resolve(t)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFrameworkForLogging",value:function(e){!function(e,t){Ua(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=yh(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=yh(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return _u.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return fu.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(){var e=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:eh(this._delegate,t),e.t0=t,e.next=e.t0===$l.SESSION?4:e.t0===$l.LOCAL?6:e.t0===$l.NONE?11:13;break;case 4:return n=Xu,e.abrupt("break",14);case 6:return e.next=8,sa(_s)._isAvailable();case 8:return r=e.sent,n=r?_s:Qu,e.abrupt("break",14);case 11:return n=la,e.abrupt("break",14);case 13:return e.abrupt("return",hi("argument-error",{appName:this._delegate.name}));case 14:return e.abrupt("return",this._delegate.setPersistence(n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return ch(this._delegate,function(e){return Vo.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return ch(this._delegate,Zo(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return ch(this._delegate,function(e,t){return uu.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return ch(this._delegate,function(e,t,n){return Zo(vn(e),Eo.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return ch(this._delegate,function(e,t,n){return wu.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return lh(this._delegate,function(e,t,n){return Ls.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ph(Gl(),this._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",ch(this._delegate,$s(this._delegate,t,ah)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithRedirect",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ph(Gl(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,th(this._delegate);case 3:return e.abrupt("return",dc(this._delegate,t,ah));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return mu.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),e}();function yh(e,t,n){var r=e;"function"!==typeof e&&(r=e.next,t=e.error,n=e.complete);var i=r;return{next:function(e){return i(e&&dh.getOrCreate(e))},error:t,complete:n}}function mh(e,t){var n=function(e,t){var n=rh();if(!n)return[];var r=ha(Zl,e,t);switch(n.getItem(r)){case $l.NONE:return[la];case $l.LOCAL:return[_s,Xu];case $l.SESSION:return[Xu];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(_s)||n.push(_s),"undefined"!==typeof window)for(var r=0,i=[Qu,Xu];r<i.length;r++){var a=i[r];n.includes(a)||n.push(a)}return n.includes(la)||n.push(la),n}vh.Persistence=$l;var gh=function(){function e(){f(this,e),this.providerId="phone",this._delegate=new Bs(oh(Gr.auth()))}return y(e,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return Bs.credential(e,t)}}]),e}();gh.PHONE_SIGN_IN_METHOD=Bs.PHONE_SIGN_IN_METHOD,gh.PROVIDER_ID=Bs.PROVIDER_ID;var kh,_h=yi,wh=function(){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gr.app();f(this,e),_h(null===(r=i.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new Ps(t,n,i.auth()),this.type=this._delegate.type}return y(e,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),e}();(kh=Gr).INTERNAL.registerComponent(new kn("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new vh(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Jr,PASSWORD_RESET:Zr,RECOVER_EMAIL:ei,REVERT_SECOND_FACTOR_ADDITION:ti,VERIFY_AND_CHANGE_EMAIL:ni,VERIFY_EMAIL:ri}},EmailAuthProvider:Eo,FacebookAuthProvider:No,GithubAuthProvider:Ao,GoogleAuthProvider:Ro,OAuthProvider:Co,SAMLAuthProvider:Do,PhoneAuthProvider:gh,PhoneMultiFactorGenerator:ol,RecaptchaVerifier:wh,TwitterAuthProvider:Oo,Auth:vh,AuthCredential:za,Error:Wt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),kh.registerVersion("@firebase/auth-compat","0.4.2");var bh,xh="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ih={},Eh=Eh||{},Th=xh||self;function Sh(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Ch(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Nh="closure_uid_"+(1e9*Math.random()>>>0),Rh=0;function Ah(e,t,n){return e.call.apply(e.bind,arguments)}function Ph(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Dh(e,t,n){return(Dh=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ah:Ph).apply(null,arguments)}function Oh(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Lh(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Mh(){this.s=this.s,this.o=this.o}Mh.prototype.s=!1,Mh.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Nh)&&e[Nh]||(e[Nh]=++Rh))},Mh.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Fh=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Uh(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Vh(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Sh(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function jh(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}jh.prototype.h=function(){this.defaultPrevented=!0};var qh=function(){if(!Th.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Th.addEventListener("test",(function(){}),t),Th.removeEventListener("test",(function(){}),t)}catch(n){}return e}();function Bh(e){return/^[\s\xa0]*$/.test(e)}function zh(){var e=Th.navigator;return e&&(e=e.userAgent)?e:""}function Wh(e){return-1!=zh().indexOf(e)}function Hh(e){return Hh[" "](e),e}Hh[" "]=function(){};var Kh,Gh,Qh=Wh("Opera"),Yh=Wh("Trident")||Wh("MSIE"),Xh=Wh("Edge"),$h=Xh||Yh,Jh=Wh("Gecko")&&!(-1!=zh().toLowerCase().indexOf("webkit")&&!Wh("Edge"))&&!(Wh("Trident")||Wh("MSIE"))&&!Wh("Edge"),Zh=-1!=zh().toLowerCase().indexOf("webkit")&&!Wh("Edge");function ef(){var e=Th.document;return e?e.documentMode:void 0}e:{var tf="",nf=function(){var e=zh();return Jh?/rv:([^\);]+)(\)|;)/.exec(e):Xh?/Edge\/([\d\.]+)/.exec(e):Yh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Zh?/WebKit\/(\S+)/.exec(e):Qh?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(nf&&(tf=nf?nf[1]:""),Yh){var rf=ef();if(null!=rf&&rf>parseFloat(tf)){Kh=String(rf);break e}}Kh=tf}if(Th.document&&Yh){var af=ef();Gh=af||(parseInt(Kh,10)||void 0)}else Gh=void 0;var of=Gh;function uf(e,t){if(jh.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Jh){e:{try{Hh(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:sf[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&uf.$.h.call(this)}}Lh(uf,jh);var sf={2:"touch",3:"pen",4:"mouse"};uf.prototype.h=function(){uf.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var cf="closure_listenable_"+(1e6*Math.random()|0),lf=0;function hf(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++lf,this.fa=this.ia=!1}function ff(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function df(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function pf(e){var t={};for(var n in e)t[n]=e[n];return t}var vf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yf(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<vf.length;a++)n=vf[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function mf(e){this.src=e,this.g={},this.h=0}function gf(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Fh(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(ff(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function kf(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.fa&&a.listener==t&&a.capture==!!n&&a.la==r)return i}return-1}mf.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=kf(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new hf(t,this.src,a,!!r,i)).ia=n,e.push(t)),t};var _f="closure_lm_"+(1e6*Math.random()|0),wf={};function bf(e,t,n,r,i){if(r&&r.once)return If(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)bf(e,t[a],n,r,i);return null}return n=Af(n),e&&e[cf]?e.O(t,n,Ch(r)?!!r.capture:!!r,i):xf(e,t,n,!1,r,i)}function xf(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Ch(i)?!!i.capture:!!i,u=Nf(e);if(u||(e[_f]=u=new mf(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Cf;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)qh||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Sf(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function If(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)If(e,t[a],n,r,i);return null}return n=Af(n),e&&e[cf]?e.P(t,n,Ch(r)?!!r.capture:!!r,i):xf(e,t,n,!0,r,i)}function Ef(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Ef(e,t[a],n,r,i);else r=Ch(r)?!!r.capture:!!r,n=Af(n),e&&e[cf]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=kf(a=e.g[t],n,r,i))&&(ff(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Nf(e))&&(t=e.g[t.toString()],e=-1,t&&(e=kf(t,n,r,i)),(n=-1<e?t[e]:null)&&Tf(n))}function Tf(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[cf])gf(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Sf(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Nf(t))?(gf(n,e),0==n.h&&(n.src=null,t[_f]=null)):ff(e)}}}function Sf(e){return e in wf?wf[e]:wf[e]="on"+e}function Cf(e,t){if(e.fa)e=!0;else{t=new uf(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Tf(e),e=n.call(r,t)}return e}function Nf(e){return(e=e[_f])instanceof mf?e:null}var Rf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Af(e){return"function"===typeof e?e:(e[Rf]||(e[Rf]=function(t){return e.handleEvent(t)}),e[Rf])}function Pf(){Mh.call(this),this.i=new mf(this),this.S=this,this.J=null}function Df(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new jh(t,e);else if(t instanceof jh)t.target=t.target||e;else{var i=t;yf(t=new jh(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Of(o,r,!0,t)&&i}if(i=Of(o=t.g=e,r,!0,t)&&i,i=Of(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Of(o=t.g=n[a],r,!1,t)&&i}function Of(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.fa&&o.capture==n){var u=o.listener,s=o.la||o.src;o.ia&&gf(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}Lh(Pf,Mh),Pf.prototype[cf]=!0,Pf.prototype.removeEventListener=function(e,t,n,r){Ef(this,e,t,n,r)},Pf.prototype.N=function(){if(Pf.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ff(n[r]);delete t.g[e],t.h--}}this.J=null},Pf.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Pf.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Lf=Th.JSON.stringify,Mf=function(){function e(t,n){f(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return y(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}();function Ff(){var e=Hf,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Uf=function(){function e(){f(this,e),this.h=this.g=null}return y(e,[{key:"add",value:function(e,t){var n=Vf.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Vf=new Mf((function(){return new jf}),(function(e){return e.reset()})),jf=function(){function e(){f(this,e),this.next=this.g=this.h=null}return y(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function qf(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Bf(e){Th.setTimeout((function(){throw e}),0)}var zf,Wf=!1,Hf=new Uf,Kf=function(){var e=Th.Promise.resolve(void 0);zf=function(){e.then(Gf)}},Gf=function(){for(var e;e=Ff();){try{e.h.call(e.g)}catch(n){Bf(n)}var t=Vf;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Wf=!1};function Qf(e,t){Pf.call(this),this.h=e||1,this.g=t||Th,this.j=Dh(this.qb,this),this.l=Date.now()}function Yf(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Xf(e,t,n){if("function"===typeof e)n&&(e=Dh(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Dh(e.handleEvent,e)}return 2147483647<Number(t)?-1:Th.setTimeout(e,t||0)}function $f(e){e.g=Xf((function(){e.g=null,e.i&&(e.i=!1,$f(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Lh(Qf,Pf),(bh=Qf.prototype).ga=!1,bh.T=null,bh.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Df(this,"tick"),this.ga&&(Yf(this),this.start()))}},bh.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},bh.N=function(){Qf.$.N.call(this),Yf(this),delete this.g};var Jf=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return y(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:$f(this)}},{key:"N",value:function(){Qr(k(n.prototype),"N",this).call(this),this.g&&(Th.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Mh);function Zf(e){Mh.call(this),this.h=e,this.g={}}Lh(Zf,Mh);var ed=[];function td(e,t,n,r){Array.isArray(n)||(n&&(ed[0]=n.toString()),n=ed);for(var i=0;i<n.length;i++){var a=bf(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function nd(e){df(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Tf(e)}),e),e.g={}}function rd(){this.g=!0}function id(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Lf(n)}catch(u){return t}}(e,n)+(r?" "+r:"")}))}Zf.prototype.N=function(){Zf.$.N.call(this),nd(this)},Zf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},rd.prototype.Ea=function(){this.g=!1},rd.prototype.info=function(){};var ad={},od=null;function ud(){return od=od||new Pf}function sd(e){jh.call(this,ad.Ta,e)}function cd(e){var t=ud();Df(t,new sd(t))}function ld(e,t){jh.call(this,ad.STAT_EVENT,e),this.stat=t}function hd(e){var t=ud();Df(t,new ld(t,e))}function fd(e,t){jh.call(this,ad.Ua,e),this.size=t}function dd(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Th.setTimeout((function(){e()}),t)}ad.Ta="serverreachability",Lh(sd,jh),ad.STAT_EVENT="statevent",Lh(ld,jh),ad.Ua="timingevent",Lh(fd,jh);var pd={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},vd={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function yd(){}function md(e){return e.h||(e.h=e.i())}function gd(){}yd.prototype.h=null;var kd,_d={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function wd(){jh.call(this,"d")}function bd(){jh.call(this,"c")}function xd(){}function Id(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Zf(this),this.P=Td,e=$h?125:void 0,this.V=new Qf(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Ed}function Ed(){this.i=null,this.g="",this.h=!1}Lh(wd,jh),Lh(bd,jh),Lh(xd,yd),xd.prototype.g=function(){return new XMLHttpRequest},xd.prototype.i=function(){return{}},kd=new xd;var Td=45e3,Sd={},Cd={};function Nd(e,t,n){e.L=1,e.v=Qd(zd(t)),e.s=n,e.S=!0,Rd(e,null)}function Rd(e,t){e.G=Date.now(),Od(e),e.A=zd(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),up(n.i,"t",r),e.C=0,n=e.l.J,e.h=new Ed,e.g=sv(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Jf(Dh(e.Pa,e,e.g),e.O)),td(e.U,e.g,"readystatechange",e.nb),t=e.I?pf(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),cd(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function Ad(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function Pd(e,t,n){for(var r,i=!0;!e.J&&e.C<n.length;){if((r=Dd(e,n))==Cd){4==t&&(e.o=4,hd(14),i=!1),id(e.j,e.m,null,"[Incomplete Response]");break}if(r==Sd){e.o=4,hd(15),id(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}id(e.j,e.m,r,null),Vd(e,r)}Ad(e)&&r!=Cd&&r!=Sd&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,hd(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),ev(t),t.M=!0,hd(11))):(id(e.j,e.m,n,"[Invalid Chunked Response]"),Ud(e),Fd(e))}function Dd(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Cd:(n=Number(t.substring(n,r)),isNaN(n)?Sd:(r+=1)+n>t.length?Cd:(t=t.slice(r,r+n),e.C=r+n,t))}function Od(e){e.Y=Date.now()+e.P,Ld(e,e.P)}function Ld(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=dd(Dh(e.lb,e),t)}function Md(e){e.B&&(Th.clearTimeout(e.B),e.B=null)}function Fd(e){0==e.l.H||e.J||rv(e.l,e)}function Ud(e){Md(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Yf(e.V),nd(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Vd(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||pp(n.i,e)))if(!e.K&&pp(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;nv(n),Kp(n)}Zp(n),hd(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=dd(Dh(n.ib,n),6e3));if(1>=dp(n.i)&&n.oa){try{n.oa()}catch(a){}n.oa=void 0}}else av(n,11)}else if((e.K||n.g==e)&&nv(n),!Bh(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.V=a[0],a=a[1],2==n.H)if("c"==a[0]){n.K=a[1],n.pa=a[2];var o=a[3];null!=o&&(n.ra=o,n.l.info("VER="+n.ra));var u=a[4];null!=u&&(n.Ga=u,n.l.info("SVER="+n.Ga));var s=a[5];null!=s&&"number"===typeof s&&0<s&&(r=1.5*s,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(vp(h,h.h),h.h=null))}if(r.F){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.Da=f,Gd(r.I,r.F,f))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var d=e;if((r=n).wa=uv(r,r.J?r.pa:null,r.Y),d.K){yp(r.i,d);var p=d,v=r.L;v&&p.setTimeout(v),p.B&&(Md(p),Od(p)),r.g=d}else Jp(r);0<n.j.length&&Qp(n)}else"stop"!=a[0]&&"close"!=a[0]||av(n,7);else 3==n.H&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?av(n,7):Hp(n):"noop"!=a[0]&&n.h&&n.h.Aa(a),n.A=0)}cd()}catch(a){}}function jd(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Sh(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(Sh(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(Sh(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(bh=Id.prototype).setTimeout=function(e){this.P=e},bh.nb=function(e){e=e.target;var t=this.M;t&&3==Vp(e)?t.l():this.Pa(e)},bh.Pa=function(e){try{if(e==this.g)e:{var t=Vp(this.g),n=this.g.Ia();this.g.da();if(!(3>t)&&(3!=t||$h||this.g&&(this.h.h||this.g.ja()||jp(this.g)))){this.J||4!=t||7==n||cd(),Md(this);var r=this.g.da();this.ca=r;t:if(Ad(this)){var i=jp(this.g);e="";var a=i.length,o=4==Vp(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ud(this),Fd(this);var u="";break t}this.h.i=new Th.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ja();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.W,t,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Bh(s)){var l=s;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,hd(12),Ud(this),Fd(this);break e}id(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vd(this,r)}this.S?(Pd(this,t,u),$h&&this.i&&3==t&&(td(this.U,this.V,"tick",this.mb),this.V.start())):(id(this.j,this.m,u,null),Vd(this,u)),4==t&&Ud(this),this.i&&!this.J&&(4==t?rv(this.l,this):(this.i=!1,Od(this)))}else(function(e){var t={};e=(e.g&&2<=Vp(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!Bh(e[n])){var r=qf(e[n]),i=r[0];if("string"===typeof(r=r[1])){r=r.trim();var a=t[i]||[];t[i]=a,a.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<u.indexOf("Unknown SID")?(this.o=3,hd(12)):(this.o=0,hd(13)),Ud(this),Fd(this)}}}catch(t){}},bh.mb=function(){if(this.g){var e=Vp(this.g),t=this.g.ja();this.C<t.length&&(Md(this),Pd(this,e,t),this.i&&4!=e&&Od(this))}},bh.cancel=function(){this.J=!0,Ud(this)},bh.lb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(cd(),hd(17)),Ud(this),this.o=2,Fd(this)):Ld(this,this.Y-e)};var qd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bd(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Bd){this.h=e.h,Wd(this,e.j),this.s=e.s,this.g=e.g,Hd(this,e.m),this.l=e.l;var t=e.i,n=new rp;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Kd(this,n),this.o=e.o}else e&&(t=String(e).match(qd))?(this.h=!1,Wd(this,t[1]||"",!0),this.s=Yd(t[2]||""),this.g=Yd(t[3]||"",!0),Hd(this,t[4]),this.l=Yd(t[5]||"",!0),Kd(this,t[6]||"",!0),this.o=Yd(t[7]||"")):(this.h=!1,this.i=new rp(null,this.h))}function zd(e){return new Bd(e)}function Wd(e,t,n){e.j=n?Yd(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Hd(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Kd(e,t,n){t instanceof rp?(e.i=t,function(e,t){t&&!e.j&&(ip(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(ap(this,t),up(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Xd(t,tp)),e.i=new rp(t,e.h))}function Gd(e,t,n){e.i.set(t,n)}function Qd(e){return Gd(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Yd(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Xd(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,$d),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function $d(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Bd.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Xd(t,Jd,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Xd(t,Jd,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Xd(n,"/"==n.charAt(0)?ep:Zd,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Xd(n,np)),e.join("")};var Jd=/[#\/\?@]/g,Zd=/[#\?:]/g,ep=/[#\?]/g,tp=/[#\?@]/g,np=/#/g;function rp(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ip(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function ap(e,t){ip(e),t=sp(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function op(e,t){return ip(e),t=sp(e,t),e.g.has(t)}function up(e,t,n){ap(e,t),0<n.length&&(e.i=null,e.g.set(sp(e,t),Uh(n)),e.h+=n.length)}function sp(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(bh=rp.prototype).add=function(e,t){ip(this),this.i=null,e=sp(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},bh.forEach=function(e,t){ip(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},bh.ta=function(){ip(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},bh.Z=function(e){ip(this);var t=[];if("string"===typeof e)op(this,e)&&(t=t.concat(this.g.get(sp(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},bh.set=function(e,t){return ip(this),this.i=null,op(this,e=sp(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},bh.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},bh.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var cp=y((function e(t,n){f(this,e),this.g=t,this.map=n}));function lp(e){this.l=e||hp,Th.PerformanceNavigationTiming?e=0<(e=Th.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Th.g&&Th.g.Ka&&Th.g.Ka()&&Th.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var hp=10;function fp(e){return!!e.h||!!e.g&&e.g.size>=e.j}function dp(e){return e.h?1:e.g?e.g.size:0}function pp(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function vp(e,t){e.g?e.g.add(t):e.h=t}function yp(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function mp(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=T(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.F)}}catch(a){r.e(a)}finally{r.f()}return n}return Uh(e.i)}lp.prototype.cancel=function(){if(this.i=mp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=T(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}};var gp,kp=function(){function e(){f(this,e)}return y(e,[{key:"stringify",value:function(e){return Th.JSON.stringify(e,void 0)}},{key:"parse",value:function(e){return Th.JSON.parse(e,void 0)}}]),e}();function _p(){this.g=new kp}function wp(e,t,n){var r=n||"";try{jd(e,(function(e,n){var i=e;Ch(e)&&(i=Lf(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function bp(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function xp(e){this.l=e.fc||null,this.j=e.ob||!1}function Ip(e,t){Pf.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Ep,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Lh(xp,yd),xp.prototype.g=function(){return new Ip(this.l,this.j)},xp.prototype.i=(gp={},function(){return gp}),Lh(Ip,Pf);var Ep=0;function Tp(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Sp(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Cp(e)}function Cp(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(bh=Ip.prototype).open=function(e,t){if(this.readyState!=Ep)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Cp(this)},bh.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Th).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},bh.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Sp(this)),this.readyState=Ep},bh.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Cp(this)),this.g&&(this.readyState=3,Cp(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof Th.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Tp(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},bh.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Sp(this):Cp(this),3==this.readyState&&Tp(this)}},bh.Za=function(e){this.g&&(this.response=this.responseText=e,Sp(this))},bh.Ya=function(e){this.g&&(this.response=e,Sp(this))},bh.ka=function(){this.g&&Sp(this)},bh.setRequestHeader=function(e,t){this.v.append(e,t)},bh.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},bh.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ip.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Np=Th.JSON.parse;function Rp(e){Pf.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ap,this.L=this.M=!1}Lh(Rp,Pf);var Ap="",Pp=/^https?$/i,Dp=["POST","PUT"];function Op(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Lp(e),Fp(e)}function Lp(e){e.F||(e.F=!0,Df(e,"complete"),Df(e,"error"))}function Mp(e){if(e.h&&"undefined"!=typeof Eh&&(!e.C[1]||4!=Vp(e)||2!=e.da()))if(e.v&&4==Vp(e))Xf(e.La,0,e);else if(Df(e,"readystatechange"),4==Vp(e)){e.h=!1;try{var t,n=e.da();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.I).match(qd)[1]||null;!a&&Th.self&&Th.self.location&&(a=Th.self.location.protocol.slice(0,-1)),i=!Pp.test(a?a.toLowerCase():"")}t=i}if(t)Df(e,"complete"),Df(e,"success");else{e.m=6;try{var o=2<Vp(e)?e.g.statusText:""}catch(u){o=""}e.j=o+" ["+e.da()+"]",Lp(e)}}finally{Fp(e)}}}function Fp(e,t){if(e.g){Up(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||Df(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Up(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Th.clearTimeout(e.A),e.A=null)}function Vp(e){return e.g?e.g.readyState:0}function jp(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Ap:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Hv){return null}}function qp(e){var t="";return df(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Bp(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qp(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Gd(e,t,n))}function zp(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Wp(e){this.Ga=0,this.j=[],this.l=new rd,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=zp("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=zp("baseRetryDelayMs",5e3,e),this.hb=zp("retryDelaySeedMs",1e4,e),this.eb=zp("forwardChannelMaxRetries",2,e),this.xa=zp("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new lp(e&&e.concurrentRequestLimit),this.Ja=new _p,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Hp(e){if(Gp(e),3==e.H){var t=e.W++,n=zd(e.I);if(Gd(n,"SID",e.K),Gd(n,"RID",t),Gd(n,"TYPE","terminate"),Xp(e,n),(t=new Id(e,e.l,t)).L=2,t.v=Qd(zd(n)),n=!1,Th.navigator&&Th.navigator.sendBeacon)try{n=Th.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&Th.Image&&((new Image).src=t.v,n=!0),n||(t.g=sv(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Od(t)}ov(e)}function Kp(e){e.g&&(ev(e),e.g.cancel(),e.g=null)}function Gp(e){Kp(e),e.u&&(Th.clearTimeout(e.u),e.u=null),nv(e),e.i.cancel(),e.m&&("number"===typeof e.m&&Th.clearTimeout(e.m),e.m=null)}function Qp(e){if(!fp(e.i)&&!e.m){e.m=!0;var t=e.Na;zf||Kf(),Wf||(zf(),Wf=!0),Hf.add(t,e),e.C=0}}function Yp(e,t){var n;n=t?t.m:e.W++;var r=zd(e.I);Gd(r,"SID",e.K),Gd(r,"RID",n),Gd(r,"AID",e.V),Xp(e,r),e.o&&e.s&&Bp(r,e.o,e.s),n=new Id(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=$p(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),vp(e.i,n),Nd(n,r,t)}function Xp(e,t){e.na&&df(e.na,(function(e,n){Gd(t,n,e)})),e.h&&jd({},(function(e,n){Gd(t,n,e)}))}function $p(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Dh(e.h.Va,e.h,e):null;e:for(var i=e.j,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].g,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].g,l=i[s].map;if(0>(c-=a))a=Math.max(0,i[s].g-100),u=!1;else try{wp(l,o,"req"+c+"_")}catch(ny){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.j.splice(0,n),t.F=e,r}function Jp(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;zf||Kf(),Wf||(zf(),Wf=!0),Hf.add(t,e),e.A=0}}function Zp(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=dd(Dh(e.Ma,e),iv(e,e.A)),e.A++,!0)}function ev(e){null!=e.B&&(Th.clearTimeout(e.B),e.B=null)}function tv(e){e.g=new Id(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=zd(e.wa);Gd(t,"RID","rpc"),Gd(t,"SID",e.K),Gd(t,"AID",e.V),Gd(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Gd(t,"TO",e.qa),Gd(t,"TYPE","xmlhttp"),Xp(e,t),e.o&&e.s&&Bp(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Qd(zd(t)),n.s=null,n.S=!0,Rd(n,e)}function nv(e){null!=e.v&&(Th.clearTimeout(e.v),e.v=null)}function rv(e,t){var n=null;if(e.g==t){nv(e),ev(e),e.g=null;var r=2}else{if(!pp(e.i,t))return;n=t.F,yp(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;Df(r=ud(),new fd(r,n)),Qp(e)}else Jp(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(dp(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=dd(Dh(e.Na,e,t),iv(e,e.C)),e.C++,!0))}(e,t)||2==r&&Zp(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:av(e,5);break;case 4:av(e,10);break;case 3:av(e,6);break;default:av(e,2)}}function iv(e,t){var n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function av(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=Dh(e.pb,e);n||(n=new Bd("//www.google.com/images/cleardot.gif"),Th.location&&"http"==Th.location.protocol||Wd(n,"https"),Qd(n)),function(e,t){var n=new rd;if(Th.Image){var r=new Image;r.onload=Oh(bp,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Oh(bp,n,r,"TestLoadImage: error",!1,t),r.onabort=Oh(bp,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Oh(bp,n,r,"TestLoadImage: timeout",!1,t),Th.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else hd(2);e.H=0,e.h&&e.h.za(t),ov(e),Gp(e)}function ov(e){if(e.H=0,e.ma=[],e.h){var t=mp(e.i);0==t.length&&0==e.j.length||(Vh(e.ma,t),Vh(e.ma,e.j),e.i.i.length=0,Uh(e.j),e.j.length=0),e.h.ya()}}function uv(e,t,n){var r=n instanceof Bd?zd(n):new Bd(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Hd(r,r.m);else{var i=Th.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new Bd(null);r&&Wd(a,r),t&&(a.g=t),i&&Hd(a,i),n&&(a.l=n),r=a}return n=e.F,t=e.Da,n&&t&&Gd(r,n,t),Gd(r,"VER",e.ra),Xp(e,r),r}function sv(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Rp(new xp({ob:!0})):new Rp(e.va)).Oa(e.J),t}function cv(){}function lv(){if(Yh&&!(10<=Number(of)))throw Error("Environmental error: no available transport.")}function hv(e,t){Pf.call(this),this.g=new Wp(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Bh(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Bh(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new pv(this)}function fv(e){wd.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function dv(){bd.call(this),this.status=1}function pv(e){this.g=e}function vv(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function yv(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],o=t+(a^n&(i^a))+r[0]+3614090360&4294967295;o=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(o<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((a=(t=n+((o=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=a+((o=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function mv(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}(bh=Rp.prototype).Oa=function(e){this.M=e},bh.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():kd.g(),this.C=this.u?md(this.u):md(kd),this.g.onreadystatechange=Dh(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(u){return void Op(this,u)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var a,o=T(r.keys());try{for(o.s();!(a=o.n()).done;){var u=a.value;n.set(u,r.get(u))}}catch(p){o.e(p)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),i=Th.FormData&&e instanceof Th.FormData,!(0<=Fh(Dp,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var s,l=T(n);try{for(l.s();!(s=l.n()).done;){var h=c(s.value,2),f=h[0],d=h[1];this.g.setRequestHeader(f,d)}}catch(p){l.e(p)}finally{l.f()}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Up(this),0<this.B&&((this.L=function(e){return Yh&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Dh(this.ua,this)):this.A=Xf(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(u){Op(this,u)}},bh.ua=function(){"undefined"!=typeof Eh&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Df(this,"timeout"),this.abort(8))},bh.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Df(this,"complete"),Df(this,"abort"),Fp(this))},bh.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Fp(this,!0)),Rp.$.N.call(this)},bh.La=function(){this.s||(this.G||this.v||this.l?Mp(this):this.kb())},bh.kb=function(){Mp(this)},bh.isActive=function(){return!!this.g},bh.da=function(){try{return 2<Vp(this)?this.g.status:-1}catch(gp){return-1}},bh.ja=function(){try{return this.g?this.g.responseText:""}catch(gp){return""}},bh.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Np(t)}},bh.Ia=function(){return this.m},bh.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(bh=Wp.prototype).ra=8,bh.H=1,bh.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new Id(this,this.l,e),n=this.s;if(this.U&&(n?yf(n=pf(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,i=0;i<this.j.length;i++){var a=this.j[i];if(void 0===(a="__data__"in a.map&&"string"===typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.j.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=$p(this,t,r),Gd(i=zd(this.I),"RID",e),Gd(i,"CVER",22),this.F&&Gd(i,"X-HTTP-Session-Id",this.F),Xp(this,i),n&&(this.O?r="headers="+encodeURIComponent(String(qp(n)))+"&"+r:this.o&&Bp(i,this.o,n)),vp(this.i,t),this.bb&&Gd(i,"TYPE","init"),this.P?(Gd(i,"$req",r),Gd(i,"SID","null"),t.aa=!0,Nd(t,i,null)):Nd(t,i,r),this.H=2}}else 3==this.H&&(e?Yp(this,e):0==this.j.length||fp(this.i)||Yp(this))},bh.Ma=function(){if(this.u=null,tv(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=dd(Dh(this.jb,this),e)}},bh.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,hd(10),Kp(this),tv(this))},bh.ib=function(){null!=this.v&&(this.v=null,Kp(this),Zp(this),hd(19))},bh.pb=function(e){e?(this.l.info("Successfully pinged google.com"),hd(2)):(this.l.info("Failed to ping google.com"),hd(1))},bh.isActive=function(){return!!this.h&&this.h.isActive(this)},(bh=cv.prototype).Ba=function(){},bh.Aa=function(){},bh.za=function(){},bh.ya=function(){},bh.isActive=function(){return!0},bh.Va=function(){},lv.prototype.g=function(e,t){return new hv(e,t)},Lh(hv,Pf),hv.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;hd(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=uv(e,null,e.Y),Qp(e)},hv.prototype.close=function(){Hp(this.g)},hv.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Lf(e),e=n);t.j.push(new cp(t.fb++,e)),3==t.H&&Qp(t)},hv.prototype.N=function(){this.g.h=null,delete this.j,Hp(this.g),delete this.g,hv.$.N.call(this)},Lh(fv,wd),Lh(dv,bd),Lh(pv,cv),pv.prototype.Ba=function(){Df(this.g,"a")},pv.prototype.Aa=function(e){Df(this.g,new fv(e))},pv.prototype.za=function(e){Df(this.g,new dv)},pv.prototype.ya=function(){Df(this.g,"b")},Lh(vv,(function(){this.blockSize=-1})),vv.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},vv.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,a=0;a<t;){if(0==i)for(;a<=n;)yv(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(r[i++]=e.charCodeAt(a++),i==this.blockSize){yv(this,r),i=0;break}}else for(;a<t;)if(r[i++]=e[a++],i==this.blockSize){yv(this,r),i=0;break}}this.h=i,this.i+=t},vv.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var gv={};function kv(e){return-128<=e&&128>e?function(e,t){var n=gv;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new mv([0|e],0>e?-1:0)})):new mv([0|e],0>e?-1:0)}function _v(e){if(isNaN(e)||!isFinite(e))return bv;if(0>e)return Sv(_v(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=wv;return new mv(t,0)}var wv=4294967296,bv=kv(0),xv=kv(1),Iv=kv(16777216);function Ev(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Tv(e){return-1==e.h}function Sv(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new mv(n,~e.h).add(xv)}function Cv(e,t){return e.add(Sv(t))}function Nv(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Rv(e,t){this.g=e,this.h=t}function Av(e,t){if(Ev(t))throw Error("division by zero");if(Ev(e))return new Rv(bv,bv);if(Tv(e))return t=Av(Sv(e),t),new Rv(Sv(t.g),Sv(t.h));if(Tv(t))return t=Av(e,Sv(t)),new Rv(Sv(t.g),t.h);if(30<e.g.length){if(Tv(e)||Tv(t))throw Error("slowDivide_ only works with positive integers.");for(var n=xv,r=t;0>=r.X(e);)n=Pv(n),r=Pv(r);var i=Dv(n,1),a=Dv(r,1);for(r=Dv(r,2),n=Dv(n,2);!Ev(r);){var o=a.add(r);0>=o.X(e)&&(i=i.add(n),a=o),r=Dv(r,1),n=Dv(n,1)}return t=Cv(e,i.R(t)),new Rv(i,t)}for(i=bv;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(a=_v(n)).R(t);Tv(o)||0<o.X(e);)o=(a=_v(n-=r)).R(t);Ev(a)&&(a=xv),i=i.add(a),e=Cv(e,o)}return new Rv(i,e)}function Pv(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new mv(n,e.h)}function Dv(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.D(a+n)>>>t|e.D(a+n+1)<<32-t:e.D(a+n);return new mv(i,e.h)}(bh=mv.prototype).ea=function(){if(Tv(this))return-Sv(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:wv+r)*t,t*=wv}return e},bh.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Ev(this))return"0";if(Tv(this))return"-"+Sv(this).toString(e);for(var t=_v(Math.pow(e,6)),n=this,r="";;){var i=Av(n,t).g,a=((0<(n=Cv(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Ev(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},bh.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},bh.X=function(e){return Tv(e=Cv(this,e))?-1:Ev(e)?0:1},bh.abs=function(){return Tv(this)?Sv(this):this},bh.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.D(i))+(65535&e.D(i)),o=(a>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new mv(n,-2147483648&n[n.length-1]?-1:0)},bh.R=function(e){if(Ev(this)||Ev(e))return bv;if(Tv(this))return Tv(e)?Sv(this).R(Sv(e)):Sv(Sv(this).R(e));if(Tv(e))return Sv(this.R(Sv(e)));if(0>this.X(Iv)&&0>e.X(Iv))return _v(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.D(r)>>>16,o=65535&this.D(r),u=e.D(i)>>>16,s=65535&e.D(i);n[2*r+2*i]+=o*s,Nv(n,2*r+2*i),n[2*r+2*i+1]+=a*s,Nv(n,2*r+2*i+1),n[2*r+2*i+1]+=o*u,Nv(n,2*r+2*i+1),n[2*r+2*i+2]+=a*u,Nv(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new mv(n,0)},bh.gb=function(e){return Av(this,e).h},bh.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new mv(n,this.h&e.h)},bh.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new mv(n,this.h|e.h)},bh.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new mv(n,this.h^e.h)},lv.prototype.createWebChannel=lv.prototype.g,hv.prototype.send=hv.prototype.u,hv.prototype.open=hv.prototype.m,hv.prototype.close=hv.prototype.close,pd.NO_ERROR=0,pd.TIMEOUT=8,pd.HTTP_ERROR=6,vd.COMPLETE="complete",gd.EventType=_d,_d.OPEN="a",_d.CLOSE="b",_d.ERROR="c",_d.MESSAGE="d",Pf.prototype.listen=Pf.prototype.O,Rp.prototype.listenOnce=Rp.prototype.P,Rp.prototype.getLastError=Rp.prototype.Sa,Rp.prototype.getLastErrorCode=Rp.prototype.Ia,Rp.prototype.getStatus=Rp.prototype.da,Rp.prototype.getResponseJson=Rp.prototype.Wa,Rp.prototype.getResponseText=Rp.prototype.ja,Rp.prototype.send=Rp.prototype.ha,Rp.prototype.setWithCredentials=Rp.prototype.Oa,vv.prototype.digest=vv.prototype.l,vv.prototype.reset=vv.prototype.reset,vv.prototype.update=vv.prototype.j,mv.prototype.add=mv.prototype.add,mv.prototype.multiply=mv.prototype.R,mv.prototype.modulo=mv.prototype.gb,mv.prototype.compare=mv.prototype.X,mv.prototype.toNumber=mv.prototype.ea,mv.prototype.toString=mv.prototype.toString,mv.prototype.getBits=mv.prototype.D,mv.fromNumber=_v,mv.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Sv(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=_v(Math.pow(n,8)),i=bv,a=0;a<t.length;a+=8){var o=Math.min(8,t.length-a),u=parseInt(t.substring(a,a+o),n);8>o?(o=_v(Math.pow(n,o)),i=i.R(o).add(_v(u))):i=(i=i.R(r)).add(_v(u))}return i};var Ov=Ih.createWebChannelTransport=function(){return new lv},Lv=Ih.getStatEventTarget=function(){return ud()},Mv=Ih.ErrorCode=pd,Fv=Ih.EventType=vd,Uv=Ih.Event=ad,Vv=Ih.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},jv=Ih.FetchXmlHttpFactory=xp,qv=Ih.WebChannel=gd,Bv=Ih.XhrIo=Rp,zv=Ih.Md5=vv,Wv=Ih.Integer=mv,Hv="@firebase/firestore",Kv=function(){function e(t){f(this,e),this.uid=t}return y(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Kv.UNAUTHENTICATED=new Kv(null),Kv.GOOGLE_CREDENTIALS=new Kv("google-credentials-uid"),Kv.FIRST_PARTY=new Kv("first-party-uid"),Kv.MOCK_USER=new Kv("mock-user");var Gv="9.22.1",Qv=new Rn("@firebase/firestore");function Yv(){return Qv.logLevel}function Xv(e){if(Qv.logLevel<=xn.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Zv);Qv.debug.apply(Qv,["Firestore (".concat(Gv,"): ").concat(e)].concat(h(i)))}}function $v(e){if(Qv.logLevel<=xn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Zv);Qv.error.apply(Qv,["Firestore (".concat(Gv,"): ").concat(e)].concat(h(i)))}}function Jv(e){if(Qv.logLevel<=xn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Zv);Qv.warn.apply(Qv,["Firestore (".concat(Gv,"): ").concat(e)].concat(h(i)))}}function Zv(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function ey(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Gv,") INTERNAL ASSERTION FAILED: ")+e;throw $v(t),new Error(t)}function ty(e,t){e||ey()}function ny(e,t){return e}var ry={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},iy=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return y(n)}(Wt),ay=y((function e(){var t=this;f(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),oy=y((function e(t,n){f(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),uy=function(){function e(){f(this,e)}return y(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Kv.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),sy=function(){function e(t){f(this,e),this.token=t,this.changeListener=null}return y(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),cy=function(){function e(t){f(this,e),this.t=t,this.currentUser=Kv.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return y(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new ay;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new ay,e.enqueueRetryable((function(){return i(n.currentUser)}))};var o=function(){var t=a;e.enqueueRetryable(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},u=function(e){Xv("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return u(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(Xv("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ay)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Xv("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(ty("string"==typeof n.accessToken),new oy(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return ty(null===e||"string"==typeof e),new Kv(e)}}]),e}(),ly=function(){function e(t,n,r){f(this,e),this.h=t,this.l=n,this.m=r,this.type="FirstParty",this.user=Kv.FIRST_PARTY,this.g=new Map}return y(e,[{key:"p",value:function(){return this.m?this.m():null}},{key:"headers",get:function(){this.g.set("X-Goog-AuthUser",this.h);var e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}]),e}(),hy=function(){function e(t,n,r){f(this,e),this.h=t,this.l=n,this.m=r}return y(e,[{key:"getToken",value:function(){return Promise.resolve(new ly(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Kv.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),fy=y((function e(t){f(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),dy=function(){function e(t){f(this,e),this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}return y(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Xv("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.T;return n.T=e.token,Xv("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){Xv("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.I.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.I.getImmediate({optional:!0});e?i(e):Xv("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(ty("string"==typeof t.token),e.T=t.token,new fy(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function py(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var vy=function(){function e(){f(this,e)}return y(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62),n="";n.length<20;)for(var r=py(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62));return n}}]),e}();function yy(e,t){return e<t?-1:e>t?1:0}function my(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function gy(e){return e+"\0"}var ky=function(){function e(t,n){if(f(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new iy(ry.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new iy(ry.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new iy(ry.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new iy(ry.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return y(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?yy(this.nanoseconds,e.nanoseconds):yy(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),_y=function(){function e(t){f(this,e),this.timestamp=t}return y(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new ky(0,0))}},{key:"max",value:function(){return new e(new ky(253402300799,999999999))}}]),e}(),wy=function(){function e(t,n,r){f(this,e),void 0===n?n=0:n>t.length&&ey(),void 0===r?r=t.length-n:r>t.length-n&&ey(),this.segments=t,this.offset=n,this.len=r}return y(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),by=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];if(u.indexOf("//")>=0)throw new iy(ry.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));e.push.apply(e,h(u.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(wy),xy=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Iy=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return xy.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new iy(ry.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new iy(ry.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new iy(ry.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new iy(ry.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(wy),Ey=function(){function e(t){f(this,e),this.path=t}return y(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===by.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(by.fromString(t))}},{key:"fromName",value:function(t){return new e(by.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(by.emptyPath())}},{key:"comparator",value:function(e,t){return by.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new by(t.slice()))}}]),e}(),Ty=y((function e(t,n,r,i){f(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function Sy(e){return e.fields.find((function(e){return 2===e.kind}))}function Cy(e){return e.fields.filter((function(e){return 2!==e.kind}))}Ty.UNKNOWN_ID=-1;var Ny=y((function e(t,n){f(this,e),this.fieldPath=t,this.kind=n}));var Ry=function(){function e(t,n){f(this,e),this.sequenceNumber=t,this.offset=n}return y(e,null,[{key:"empty",value:function(){return new e(0,Dy.min())}}]),e}();function Ay(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=_y.fromTimestamp(1e9===r?new ky(n+1,0):new ky(n,r));return new Dy(i,Ey.empty(),t)}function Py(e){return new Dy(e.readTime,e.key,-1)}var Dy=function(){function e(t,n,r){f(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return y(e,null,[{key:"min",value:function(){return new e(_y.min(),Ey.empty(),-1)}},{key:"max",value:function(){return new e(_y.max(),Ey.empty(),-1)}}]),e}();function Oy(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Ey.comparator(e.documentKey,t.documentKey))?n:yy(e.largestBatchId,t.largestBatchId)}var Ly="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",My=function(){function e(){f(this,e),this.onCommittedListeners=[]}return y(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function Fy(e){return Uy.apply(this,arguments)}function Uy(){return(Uy=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===ry.FAILED_PRECONDITION&&t.message===Ly){e.next=2;break}throw t;case 2:Xv("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Vy=function(){function e(t){var n=this;f(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return y(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&ey(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=T(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=t.length,a=new Array(i),o=0,u=function(){var u=s;n(t[u]).next((function(t){a[u]=t,++o===i&&e(a)}),(function(e){return r(e)}))},s=0;s<i;s++)u()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function i(){!0===t()?n().next((function(){i()}),r):e()}()}))}}]),e}(),jy=function(){function e(t,n){var r=this;f(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.v=new ay,this.transaction.oncomplete=function(){r.v.resolve()},this.transaction.onabort=function(){n.error?r.v.reject(new zy(t,n.error)):r.v.resolve()},this.transaction.onerror=function(e){var n=Qy(e.target.error);r.v.reject(new zy(t,n))}}return y(e,[{key:"R",get:function(){return this.v.promise}},{key:"abort",value:function(e){e&&this.v.reject(e),this.aborted||(Xv("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"P",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Hy(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new zy(n,t)}}}]),e}(),qy=function(){function e(t,n,r){f(this,e),this.name=t,this.version=n,this.V=r,12.2===e.S(Mt())&&$v("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return y(e,[{key:"$",value:function(){var e=gn(yn().mark((function e(t){var n=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Xv("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new zy(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new iy(ry.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new iy(ry.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new zy(t,n))},i.onupgradeneeded=function(e){Xv("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.V.O(t,i.transaction,e.oldVersion,n.version).next((function(){Xv("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.F&&(this.db.onversionchange=function(e){return n.F(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"B",value:function(e){this.F=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=gn(yn().mark((function e(t,n,r,i){var a,o,u,s,c=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,o=0,u=yn().mark((function e(){var n,u,s,l;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++o,e.prev=1,e.next=4,c.$(t);case 4:return c.db=e.sent,n=jy.open(c.db,t,a?"readonly":"readwrite",r),u=i(n).next((function(e){return n.P(),e})).catch((function(e){return n.abort(e),Vy.reject(e)})).toPromise(),u.catch((function(){})),e.next=9,n.R;case 9:return e.t0=u,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),s=e.t1,l="FirebaseError"!==s.name&&o<3,Xv("SimpleDb","Transaction failed with error:",s.message,"Retrying:",l),c.close(),l){e.next=18;break}return e.abrupt("return",{v:Promise.reject(s)});case 18:case"end":return e.stop()}}),e,null,[[1,13]])}));case 3:return e.delegateYield(u(),"t0",4);case 4:if("object"!==typeof(s=e.t0)){e.next=7;break}return e.abrupt("return",s.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Xv("SimpleDb","Removing database:",e),Ky(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"D",value:function(){if(!zt())return!1;if(e.C())return!0;var t=Mt(),n=e.S(t),r=0<n&&n<10,i=e.N(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"C",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"/Make-Tasty-App",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.k)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"S",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"N",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),By=function(){function e(t){f(this,e),this.L=t,this.q=!1,this.U=null}return y(e,[{key:"isDone",get:function(){return this.q}},{key:"K",get:function(){return this.U}},{key:"cursor",set:function(e){this.L=e}},{key:"done",value:function(){this.q=!0}},{key:"G",value:function(e){this.U=e}},{key:"delete",value:function(){return Ky(this.L.delete())}}]),e}(),zy=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,ry.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return y(n)}(iy);function Wy(e){return"IndexedDbTransactionError"===e.name}var Hy=function(){function e(t){f(this,e),this.store=t}return y(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Xv("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Xv("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ky(n)}},{key:"add",value:function(e){return Xv("SimpleDb","ADD",this.store.name,e,e),Ky(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Ky(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Xv("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Xv("SimpleDb","DELETE",this.store.name,e),Ky(this.store.delete(e))}},{key:"count",value:function(){return Xv("SimpleDb","COUNT",this.store.name),Ky(this.store.count())}},{key:"j",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.W(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Vy((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"H",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Vy((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){Xv("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Y=!1;var r=this.cursor(n);return this.W(r,(function(e,t,n){return n.delete()}))}},{key:"X",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.W(r,t)}},{key:"Z",value:function(e){var t=this.cursor({});return new Vy((function(n,r){t.onerror=function(e){var t=Qy(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"W",value:function(e,t){var n=[];return new Vy((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new By(i),o=t(i.primaryKey,i.value,a);if(o instanceof Vy){var u=o.catch((function(e){return a.done(),Vy.reject(e)}));n.push(u)}a.isDone?r():null===a.K?i.continue():i.continue(a.K)}else r()}})).next((function(){return Vy.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Ky(e){return new Vy((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Qy(e.target.error);n(t)}}))}var Gy=!1;function Qy(e){var t=qy.S(Mt());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new iy("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Gy||(Gy=!0,setTimeout((function(){throw r}),0)),r}}return e}var Yy=function(){function e(t,n){f(this,e),this.asyncQueue=t,this.tt=n,this.task=null}return y(e,[{key:"start",value:function(){this.et(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"et",value:function(e){var t=this;Xv("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Xv,e.t1="Documents written: ",e.next=6,t.tt.nt();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!Wy(e.t4)){e.next=17;break}Xv("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Fy(e.t4);case 19:return e.next=21,t.et(6e4);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),Xy=function(){function e(t,n){f(this,e),this.localStore=t,this.persistence=n}return y(e,[{key:"nt",value:function(){var e=gn(yn().mark((function e(){var t,n=this,r=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.st(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"st",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Vy.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Xv("IndexBackiller","Processing collection: ".concat(t)),n.it(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"it",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next((function(){return r.rt(i,n)})).next((function(n){return Xv("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return a.size}))}))}))}},{key:"rt",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=Py(t);Oy(r,n)>0&&(n=r)})),new Dy(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),$y=function(){function e(t,n){var r=this;f(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ot(e)},this.ut=function(e){return n.writeSequenceNumber(e)})}return y(e,[{key:"ot",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ut&&this.ut(e),e}}]),e}();function Jy(e){return null==e}function Zy(e){return 0===e&&1/e==-1/0}function em(e){return"number"==typeof e&&Number.isInteger(e)&&!Zy(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function tm(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=rm(t)),t=nm(e.get(n),t);return rm(t)}function nm(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function rm(e){return e+"\x01\x01"}function im(e){var t=e.length;if(ty(t>=2),2===t)return ty("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),by.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&ey(),e.charAt(o+1)){case"\x01":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:ey()}a=o+2}return new by(r)}$y.ct=-1;var am=["userId","batchId"];function om(e,t){return[e,tm(t)]}function um(e,t,n){return[e,tm(t),n]}var sm={},cm=["prefixPath","collectionGroup","readTime","documentId"],lm=["prefixPath","collectionGroup","documentId"],hm=["collectionGroup","readTime","prefixPath","documentId"],fm=["canonicalId","targetId"],dm=["targetId","path"],pm=["path","targetId"],vm=["collectionId","parent"],ym=["indexId","uid"],mm=["uid","sequenceNumber"],gm=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],km=["indexId","uid","orderedDocumentKey"],_m=["userId","collectionPath","documentId"],wm=["userId","collectionPath","largestBatchId"],bm=["userId","collectionGroup","largestBatchId"],xm=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Im=[].concat(h(xm),["documentOverlays"]),Em=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Tm=Em,Sm=[].concat(Tm,["indexConfiguration","indexState","indexEntries"]),Cm=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).ht=e,i.currentSequenceNumber=r,i}return y(n)}(My);function Nm(e,t){var n=ny(e);return qy.M(n.ht,t)}function Rm(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Am(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Pm(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var Dm=function(){function e(t,n){f(this,e),this.comparator=t,this.root=n||Lm.EMPTY}return y(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Lm.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Lm.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Om(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Om(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Om(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Om(this.root,e,this.comparator,!0)}}]),e}(),Om=function(){function e(t,n,r,i){f(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return y(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),Lm=function(){function e(t,n,r,i,a){f(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return y(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw ey();if(this.right.isRed())throw ey();var e=this.left.check();if(e!==this.right.check())throw ey();return e+(this.isRed()?0:1)}}]),e}();Lm.EMPTY=null,Lm.RED=!0,Lm.BLACK=!1,Lm.EMPTY=new(function(){function e(){f(this,e),this.size=0}return y(e,[{key:"key",get:function(){throw ey()}},{key:"value",get:function(){throw ey()}},{key:"color",get:function(){throw ey()}},{key:"left",get:function(){throw ey()}},{key:"right",get:function(){throw ey()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Lm(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Mm=function(){function e(t){f(this,e),this.comparator=t,this.data=new Dm(this.comparator)}return y(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Fm(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Fm(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Fm=function(){function e(t){f(this,e),this.iter=t}return y(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function Um(e){return e.hasNext()?e.getNext():void 0}var Vm=function(){function e(t){f(this,e),this.fields=t,t.sort(Iy.comparator)}return y(e,[{key:"unionWith",value:function(t){var n,r=new Mm(Iy.comparator),i=T(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,u=T(t);try{for(u.s();!(o=u.n()).done;){var s=o.value;r=r.add(s)}}catch(c){u.e(c)}finally{u.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=T(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return my(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),jm=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).name="Base64DecodeError",e}return y(n)}(I(Error));var qm=function(e){function t(e){f(this,t),this.binaryString=e}return y(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return yy(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){var n=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new jm("Invalid base64 string: "+e):e}}(e);return new t(n)}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();qm.EMPTY_BYTE_STRING=new qm("");var Bm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zm(e){if(ty(!!e),"string"==typeof e){var t=0,n=Bm.exec(e);if(ty(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Wm(e.seconds),nanos:Wm(e.nanos)}}function Wm(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Hm(e){return"string"==typeof e?qm.fromBase64String(e):qm.fromUint8Array(e)}function Km(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Gm(e){var t=e.mapValue.fields.__previous_value__;return Km(t)?Gm(t):t}function Qm(e){var t=zm(e.mapValue.fields.__local_write_time__.timestampValue);return new ky(t.seconds,t.nanos)}var Ym=y((function e(t,n,r,i,a,o,u,s,c){f(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=s,this.useFetchStreams=c})),Xm=function(){function e(t,n){f(this,e),this.projectId=t,this.database=n||"(default)"}return y(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}(),$m={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Jm={nullValue:"NULL_VALUE"};function Zm(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Km(e)?4:dg(e)?9007199254740991:10:ey()}function eg(e,t){if(e===t)return!0;var n=Zm(e);if(n!==Zm(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Qm(e).isEqual(Qm(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=zm(e.timestampValue),r=zm(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Hm(e.bytesValue).isEqual(Hm(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Wm(e.geoPointValue.latitude)===Wm(t.geoPointValue.latitude)&&Wm(e.geoPointValue.longitude)===Wm(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Wm(e.integerValue)===Wm(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Wm(e.doubleValue),r=Wm(t.doubleValue);return n===r?Zy(n)===Zy(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return my(e.arrayValue.values||[],t.arrayValue.values||[],eg);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Rm(n)!==Rm(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!eg(n[i],r[i])))return!1;return!0}(e,t);default:return ey()}}function tg(e,t){return void 0!==(e.values||[]).find((function(e){return eg(e,t)}))}function ng(e,t){if(e===t)return 0;var n=Zm(e),r=Zm(t);if(n!==r)return yy(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return yy(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Wm(e.integerValue||e.doubleValue),r=Wm(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return rg(e.timestampValue,t.timestampValue);case 4:return rg(Qm(e),Qm(t));case 5:return yy(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Hm(e),r=Hm(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=yy(n[i],r[i]);if(0!==a)return a}return yy(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=yy(Wm(e.latitude),Wm(t.latitude));return 0!==n?n:yy(Wm(e.longitude),Wm(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=ng(n[i],r[i]);if(a)return a}return yy(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===$m.mapValue&&t===$m.mapValue)return 0;if(e===$m.mapValue)return 1;if(t===$m.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=yy(r[o],a[o]);if(0!==u)return u;var s=ng(n[r[o]],i[a[o]]);if(0!==s)return s}return yy(r.length,a.length)}(e.mapValue,t.mapValue);default:throw ey()}}function rg(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return yy(e,t);var n=zm(e),r=zm(t),i=yy(n.seconds,r.seconds);return 0!==i?i:yy(n.nanos,r.nanos)}function ig(e){return ag(e)}function ag(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=zm(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Hm(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Ey.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=T(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=ag(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=T(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(ag(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):ey();var t,n}function og(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function ug(e){return!!e&&"integerValue"in e}function sg(e){return!!e&&"arrayValue"in e}function cg(e){return!!e&&"nullValue"in e}function lg(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function hg(e){return!!e&&"mapValue"in e}function fg(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Am(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=fg(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=fg(e.arrayValue.values[r]);return n}return Object.assign({},e)}function dg(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function pg(e){return"nullValue"in e?Jm:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?og(Xm.empty(),Ey.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:ey()}function vg(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?og(Xm.empty(),Ey.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?$m:ey()}function yg(e,t){var n=ng(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function mg(e,t){var n=ng(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var gg=function(){function e(t){f(this,e),this.value=t}return y(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!hg(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fg(t)}},{key:"setAll",value:function(e){var t=this,n=Iy.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=fg(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());hg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return eg(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];hg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Am(t,(function(t,n){return e[t]=n}));var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(fg(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function kg(e){var t=[];return Am(e.fields,(function(e,n){var r=new Iy([e]);if(hg(n)){var i=kg(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=T(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(r.child(u))}}catch(s){o.e(s)}finally{o.f()}}}else t.push(r)})),new Vm(t)}var _g=function(){function e(t,n,r,i,a,o,u){f(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=o,this.documentState=u}return y(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(_y.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=gg.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=gg.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=_y.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,_y.min(),_y.min(),_y.min(),gg.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,_y.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,_y.min(),_y.min(),gg.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,_y.min(),_y.min(),gg.empty(),2)}}]),e}(),wg=y((function e(t,n){f(this,e),this.position=t,this.inclusive=n}));function bg(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Ey.comparator(Ey.fromName(o.referenceValue),n.key):ng(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function xg(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!eg(e.position[n],t.position[n]))return!1;return!0}var Ig=y((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";f(this,e),this.field=t,this.dir=n}));function Eg(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var Tg=y((function e(){f(this,e)})),Sg=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return y(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(ng(t,this.value)):null!==t&&Zm(this.value)===Zm(t)&&this.matchesComparison(ng(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ey()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Fg(e,t,r):"array-contains"===t?new qg(e,r):"in"===t?new Bg(e,r):"not-in"===t?new zg(e,r):"array-contains-any"===t?new Wg(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Ug(e,n):new Vg(e,n)}}]),n}(Tg),Cg=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).filters=e,i.op=r,i.lt=null,i}return y(n,[{key:"matches",value:function(e){return Ng(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.lt||(this.lt=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.lt}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.ft((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"ft",value:function(e){var t,n=T(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(Tg);function Ng(e){return"and"===e.op}function Rg(e){return"or"===e.op}function Ag(e){return Pg(e)&&Ng(e)}function Pg(e){var t,n=T(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof Cg)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function Dg(e){if(e instanceof Sg)return e.field.canonicalString()+e.op.toString()+ig(e.value);if(Ag(e))return e.filters.map((function(e){return Dg(e)})).join(",");var t=e.filters.map((function(e){return Dg(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function Og(e,t){return e instanceof Sg?function(e,t){return t instanceof Sg&&e.op===t.op&&e.field.isEqual(t.field)&&eg(e.value,t.value)}(e,t):e instanceof Cg?function(e,t){return t instanceof Cg&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&Og(n,t.filters[r])}),!0)}(e,t):void ey()}function Lg(e,t){var n=e.filters.concat(t);return Cg.create(n,e.op)}function Mg(e){return e instanceof Sg?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ig(e.value))}(e):e instanceof Cg?function(e){return e.op.toString()+" {"+e.getFilters().map(Mg).join(" ,")+"}"}(e):"Filter"}var Fg=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this,e,r,i)).key=Ey.fromName(i.referenceValue),a}return y(n,[{key:"matches",value:function(e){var t=Ey.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(Sg),Ug=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,"in",r)).keys=jg("in",r),i}return y(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Sg),Vg=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,"not-in",r)).keys=jg("not-in",r),i}return y(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Sg);function jg(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return Ey.fromName(e.referenceValue)}))}var qg=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"array-contains",r)}return y(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return sg(t)&&tg(t.arrayValue,this.value)}}]),n}(Sg),Bg=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"in",r)}return y(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&tg(this.value.arrayValue,t)}}]),n}(Sg),zg=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"not-in",r)}return y(n,[{key:"matches",value:function(e){if(tg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!tg(this.value.arrayValue,t)}}]),n}(Sg),Wg=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,"array-contains-any",r)}return y(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!sg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return tg(t.value.arrayValue,e)}))}}]),n}(Sg),Hg=y((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;f(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=u,this.dt=null}));function Kg(e){return new Hg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Gg(e){var t=ny(e);if(null===t.dt){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return Dg(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Jy(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return ig(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return ig(e)})).join(",")),t.dt=n}return t.dt}function Qg(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Eg(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!Og(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!xg(e.startAt,t.startAt)&&xg(e.endAt,t.endAt)}function Yg(e){return Ey.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Xg(e,t){return e.filters.filter((function(e){return e instanceof Sg&&e.field.isEqual(t)}))}function $g(e,t,n){var r,i=Jm,a=!0,o=T(Xg(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=Jm,c=!0;switch(u.op){case"<":case"<=":s=pg(u.value);break;case"==":case"in":case">=":s=u.value;break;case">":s=u.value,c=!1;break;case"!=":case"not-in":s=Jm}yg({value:i,inclusive:a},{value:s,inclusive:c})<0&&(i=s,a=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];yg({value:i,inclusive:a},{value:h,inclusive:n.inclusive})<0&&(i=h,a=n.inclusive);break}return{value:i,inclusive:a}}function Jg(e,t,n){var r,i=$m,a=!0,o=T(Xg(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=$m,c=!0;switch(u.op){case">=":case">":s=vg(u.value),c=!1;break;case"==":case"in":case"<=":s=u.value;break;case"<":s=u.value,c=!1;break;case"!=":case"not-in":s=$m}mg({value:i,inclusive:a},{value:s,inclusive:c})>0&&(i=s,a=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];mg({value:i,inclusive:a},{value:h,inclusive:n.inclusive})>0&&(i=h,a=n.inclusive);break}return{value:i,inclusive:a}}var Zg=y((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;f(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=u,this.endAt=s,this.wt=null,this._t=null,this.startAt,this.endAt}));function ek(e,t,n,r,i,a,o,u){return new Zg(e,t,n,r,i,a,o,u)}function tk(e){return new Zg(e)}function nk(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function rk(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function ik(e){var t,n=T(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function ak(e){return null!==e.collectionGroup}function ok(e){var t=ny(e);if(null===t.wt){t.wt=[];var n=ik(t),r=rk(t);if(null!==n&&null===r)n.isKeyField()||t.wt.push(new Ig(n)),t.wt.push(new Ig(Iy.keyField(),"asc"));else{var i,a=!1,o=T(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;t.wt.push(u),u.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Ig(Iy.keyField(),s))}}}return t.wt}function uk(e){var t=ny(e);if(!t._t)if("F"===t.limitType)t._t=Kg(t.path,t.collectionGroup,ok(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=T(ok(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new Ig(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var u=t.endAt?new wg(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new wg(t.startAt.position,t.startAt.inclusive):null;t._t=Kg(t.path,t.collectionGroup,r,t.filters,t.limit,u,s)}return t._t}function sk(e,t){t.getFirstInequalityField(),ik(e);var n=e.filters.concat([t]);return new Zg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ck(e,t,n){return new Zg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function lk(e,t){return Qg(uk(e),uk(t))&&e.limitType===t.limitType}function hk(e){return"".concat(Gg(uk(e)),"|lt:").concat(e.limitType)}function fk(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return Mg(e)})).join(", "),"]")),Jy(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return ig(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return ig(e)})).join(",")),"Target(".concat(t,")")}(uk(e)),"; limitType=").concat(e.limitType,")")}function dk(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ey.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=T(ok(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=T(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=bg(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,ok(e),t))&&!(e.endAt&&!function(e,t,n){var r=bg(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,ok(e),t))}(e,t)}function pk(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function vk(e){return function(t,n){var r,i=!1,a=T(ok(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=yk(o,t,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function yk(e,t,n){var r=e.field.isKeyField()?Ey.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ng(r,i):ey()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ey()}}var mk=function(){function e(t,n){f(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return y(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=c(r.value,2),o=a[0],u=a[1];if(this.equalsFn(o,e))return u}}catch(s){i.e(s)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){Am(this.inner,(function(t,n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=c(r.value,2),o=a[0],u=a[1];e(o,u)}}catch(s){i.e(s)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return Pm(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),gk=new Dm(Ey.comparator);function kk(){return gk}var _k=new Dm(Ey.comparator);function wk(){for(var e=_k,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function bk(e){var t=_k;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function xk(){return Ek()}function Ik(){return Ek()}function Ek(){return new mk((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Tk=new Dm(Ey.comparator),Sk=new Mm(Ey.comparator);function Ck(){for(var e=Sk,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var Nk=new Mm(yy);function Rk(){return Nk}function Ak(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zy(t)?"-0":t}}function Pk(e){return{integerValue:""+e}}function Dk(e,t){return em(t)?Pk(t):Ak(e,t)}var Ok=y((function e(){f(this,e),this._=void 0}));function Lk(e,t,n){return e instanceof Uk?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Km(t)&&(t=Gm(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Vk?jk(e,t):e instanceof qk?Bk(e,t):function(e,t){var n=Fk(e,t),r=Wk(n)+Wk(e.gt);return ug(n)&&ug(e.gt)?Pk(r):Ak(e.serializer,r)}(e,t)}function Mk(e,t,n){return e instanceof Vk?jk(e,t):e instanceof qk?Bk(e,t):n}function Fk(e,t){return e instanceof zk?ug(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Uk=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n)}(Ok),Vk=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).elements=e,r}return y(n)}(Ok);function jk(e,t){var n,r=Hk(t),i=T(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return eg(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var qk=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).elements=e,r}return y(n)}(Ok);function Bk(e,t){var n,r=Hk(t),i=T(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!eg(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var zk=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).serializer=e,i.gt=r,i}return y(n)}(Ok);function Wk(e){return Wm(e.integerValue||e.doubleValue)}function Hk(e){return sg(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Kk=y((function e(t,n){f(this,e),this.field=t,this.transform=n}));var Gk=y((function e(t,n){f(this,e),this.version=t,this.transformResults=n})),Qk=function(){function e(t,n){f(this,e),this.updateTime=t,this.exists=n}return y(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Yk(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Xk=y((function e(){f(this,e)}));function $k(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new c_(e.key,Qk.none()):new n_(e.key,e.data,Qk.none());var n,r=e.data,i=gg.empty(),a=new Mm(Iy.comparator),o=T(t.fields);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(!a.has(u)){var s=r.field(u);null===s&&u.length>1&&(u=u.popLast(),s=r.field(u)),null===s?i.delete(u):i.set(u,s),a=a.add(u)}}}catch(c){o.e(c)}finally{o.f()}return new r_(e.key,i,new Vm(a.toArray()),Qk.none())}function Jk(e,t,n){e instanceof n_?function(e,t,n){var r=e.value.clone(),i=a_(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof r_?function(e,t,n){if(Yk(e.precondition,t)){var r=a_(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(i_(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Zk(e,t,n,r){return e instanceof n_?function(e,t,n,r){if(!Yk(e.precondition,t))return n;var i=e.value.clone(),a=o_(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof r_?function(e,t,n,r){if(!Yk(e.precondition,t))return n;var i=o_(e.fieldTransforms,r,t),a=t.data;return a.setAll(i_(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Yk(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function e_(e,t){var n,r=null,i=T(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),u=Fk(a.transform,o||null);null!=u&&(null===r&&(r=gg.empty()),r.set(a.field,u))}}catch(s){i.e(s)}finally{i.f()}return r||null}function t_(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&my(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Vk&&t instanceof Vk||e instanceof qk&&t instanceof qk?my(e.elements,t.elements,eg):e instanceof zk&&t instanceof zk?eg(e.gt,t.gt):e instanceof Uk&&t instanceof Uk}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var n_=function(e){g(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return f(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return y(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Xk),r_=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return f(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=u,o.type=1,o}return y(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Xk);function i_(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function a_(e,t,n){var r=new Map;ty(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,Mk(o,u,n[i]))}return r}function o_(e,t,n){var r,i=new Map,a=T(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,s=n.data.field(o.field);i.set(o.field,Lk(u,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var u_,s_,c_=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return y(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Xk),l_=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return y(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Xk),h_=function(){function e(t,n,r,i){f(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return y(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Jk(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=T(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Zk(i,e,t,this.localWriteTime))}}catch(s){r.e(s)}finally{r.f()}var a,o=T(this.mutations);try{for(o.s();!(a=o.n()).done;){var u=a.value;u.key.isEqual(e.key)&&(t=Zk(u,e,t,this.localWriteTime))}}catch(s){o.e(s)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Ik();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=$k(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(_y.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Ck())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&my(this.mutations,e.mutations,(function(e,t){return t_(e,t)}))&&my(this.baseMutations,e.baseMutations,(function(e,t){return t_(e,t)}))}}]),e}(),f_=function(){function e(t,n,r,i){f(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return y(e,null,[{key:"from",value:function(t,n,r){ty(t.mutations.length===r.length);for(var i=Tk,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),d_=function(){function e(t,n){f(this,e),this.largestBatchId=t,this.mutation=n}return y(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),p_=y((function e(t,n){f(this,e),this.count=t,this.unchangedNames=n}));function v_(e){switch(e){default:return ey();case ry.CANCELLED:case ry.UNKNOWN:case ry.DEADLINE_EXCEEDED:case ry.RESOURCE_EXHAUSTED:case ry.INTERNAL:case ry.UNAVAILABLE:case ry.UNAUTHENTICATED:return!1;case ry.INVALID_ARGUMENT:case ry.NOT_FOUND:case ry.ALREADY_EXISTS:case ry.PERMISSION_DENIED:case ry.FAILED_PRECONDITION:case ry.ABORTED:case ry.OUT_OF_RANGE:case ry.UNIMPLEMENTED:case ry.DATA_LOSS:return!0}}function y_(e){if(void 0===e)return $v("GRPC error has no .code"),ry.UNKNOWN;switch(e){case u_.OK:return ry.OK;case u_.CANCELLED:return ry.CANCELLED;case u_.UNKNOWN:return ry.UNKNOWN;case u_.DEADLINE_EXCEEDED:return ry.DEADLINE_EXCEEDED;case u_.RESOURCE_EXHAUSTED:return ry.RESOURCE_EXHAUSTED;case u_.INTERNAL:return ry.INTERNAL;case u_.UNAVAILABLE:return ry.UNAVAILABLE;case u_.UNAUTHENTICATED:return ry.UNAUTHENTICATED;case u_.INVALID_ARGUMENT:return ry.INVALID_ARGUMENT;case u_.NOT_FOUND:return ry.NOT_FOUND;case u_.ALREADY_EXISTS:return ry.ALREADY_EXISTS;case u_.PERMISSION_DENIED:return ry.PERMISSION_DENIED;case u_.FAILED_PRECONDITION:return ry.FAILED_PRECONDITION;case u_.ABORTED:return ry.ABORTED;case u_.OUT_OF_RANGE:return ry.OUT_OF_RANGE;case u_.UNIMPLEMENTED:return ry.UNIMPLEMENTED;case u_.DATA_LOSS:return ry.DATA_LOSS;default:return ey()}}(s_=u_||(u_={}))[s_.OK=0]="OK",s_[s_.CANCELLED=1]="CANCELLED",s_[s_.UNKNOWN=2]="UNKNOWN",s_[s_.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",s_[s_.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",s_[s_.NOT_FOUND=5]="NOT_FOUND",s_[s_.ALREADY_EXISTS=6]="ALREADY_EXISTS",s_[s_.PERMISSION_DENIED=7]="PERMISSION_DENIED",s_[s_.UNAUTHENTICATED=16]="UNAUTHENTICATED",s_[s_.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",s_[s_.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",s_[s_.ABORTED=10]="ABORTED",s_[s_.OUT_OF_RANGE=11]="OUT_OF_RANGE",s_[s_.UNIMPLEMENTED=12]="UNIMPLEMENTED",s_[s_.INTERNAL=13]="INTERNAL",s_[s_.UNAVAILABLE=14]="UNAVAILABLE",s_[s_.DATA_LOSS=15]="DATA_LOSS";var m_=function(){function e(){f(this,e),this.onExistenceFilterMismatchCallbacks=new Map}return y(e,[{key:"onExistenceFilterMismatch",value:function(e){var t=this,n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),function(){return t.onExistenceFilterMismatchCallbacks.delete(n)}}},{key:"notifyOnExistenceFilterMismatch",value:function(e){this.onExistenceFilterMismatchCallbacks.forEach((function(t){return t(e)}))}}],[{key:"instance",get:function(){return g_}},{key:"getOrCreateInstance",value:function(){return null===g_&&(g_=new e),g_}}]),e}(),g_=null;function k_(){return new TextEncoder}var __=new Wv([4294967295,4294967295],0);function w_(e){var t=k_().encode(e),n=new zv;return n.update(t),new Uint8Array(n.digest())}function b_(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Wv([n,r],0),new Wv([i,a],0)]}var x_=function(){function e(t,n,r){if(f(this,e),this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new I_("Invalid padding: ".concat(n));if(r<0)throw new I_("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new I_("Invalid hash count: ".concat(r));if(0===t.length&&0!==n)throw new I_("Invalid padding when bitmap length is 0: ".concat(n));this.It=8*t.length-n,this.Tt=Wv.fromNumber(this.It)}return y(e,[{key:"Et",value:function(e,t,n){var r=e.add(t.multiply(Wv.fromNumber(n)));return 1===r.compare(__)&&(r=new Wv([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}},{key:"At",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"vt",value:function(e){if(0===this.It)return!1;for(var t=c(b_(w_(e)),2),n=t[0],r=t[1],i=0;i<this.hashCount;i++){var a=this.Et(n,r,i);if(!this.At(a))return!1}return!0}},{key:"insert",value:function(e){if(0!==this.It)for(var t=c(b_(w_(e)),2),n=t[0],r=t[1],i=0;i<this.hashCount;i++){var a=this.Et(n,r,i);this.Rt(a)}}},{key:"Rt",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(t,n,r){var i=t%8==0?0:8-t%8,a=new e(new Uint8Array(Math.ceil(t/8)),i,n);return r.forEach((function(e){return a.insert(e)})),a}}]),e}(),I_=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).name="BloomFilterError",e}return y(n)}(I(Error)),E_=function(){function e(t,n,r,i,a){f(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return y(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,T_.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(_y.min(),i,new Dm(yy),kk(),Ck())}}]),e}(),T_=function(){function e(t,n,r,i,a){f(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return y(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,Ck(),Ck(),Ck())}}]),e}(),S_=y((function e(t,n,r,i){f(this,e),this.Pt=t,this.removedTargetIds=n,this.key=r,this.bt=i})),C_=y((function e(t,n){f(this,e),this.targetId=t,this.Vt=n})),N_=y((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qm.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;f(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),R_=function(){function e(){f(this,e),this.St=0,this.Dt=D_(),this.Ct=qm.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}return y(e,[{key:"current",get:function(){return this.xt}},{key:"resumeToken",get:function(){return this.Ct}},{key:"kt",get:function(){return 0!==this.St}},{key:"Mt",get:function(){return this.Nt}},{key:"$t",value:function(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}},{key:"Ot",value:function(){var e=Ck(),t=Ck(),n=Ck();return this.Dt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ey()}})),new T_(this.Ct,this.xt,e,t,n)}},{key:"Ft",value:function(){this.Nt=!1,this.Dt=D_()}},{key:"Bt",value:function(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}},{key:"Lt",value:function(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}},{key:"qt",value:function(){this.St+=1}},{key:"Ut",value:function(){this.St-=1}},{key:"Kt",value:function(){this.Nt=!0,this.xt=!0}}]),e}(),A_=function(){function e(t){f(this,e),this.Gt=t,this.Qt=new Map,this.jt=kk(),this.zt=P_(),this.Wt=new Dm(yy)}return y(e,[{key:"Ht",value:function(e){var t,n=T(e.Pt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.bt&&e.bt.isFoundDocument()?this.Jt(r,e.bt):this.Yt(r,e.key,e.bt)}}catch(u){n.e(u)}finally{n.f()}var i,a=T(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Yt(o,e.key,e.bt)}}catch(u){a.e(u)}finally{a.f()}}},{key:"Xt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Zt(n);switch(e.state){case 0:t.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||t.removeTarget(n);break;case 3:t.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:t.te(n)&&(t.ee(n),r.$t(e.resumeToken));break;default:ey()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((function(e,r){n.te(r)&&t(r)}))}},{key:"ne",value:function(e){var t,n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){var a=i.target;if(Yg(a))if(0===r){var o=new Ey(a.path);this.Yt(n,o,_g.newNoDocument(o,_y.min()))}else ty(1===r);else{var u=this.ie(n);if(u!==r){var s=this.re(e,u);if(0!==s){this.ee(n);var c=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,c)}null===(t=m_.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,a,o,u,s,c={localCacheCount:t,existenceFilterCount:n.count},l=n.unchangedNames;return l&&(c.bloomFilter={applied:0===e,hashCount:null!==(r=null==l?void 0:l.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(a=null===(i=null==l?void 0:l.bits)||void 0===i?void 0:i.bitmap)||void 0===a?void 0:a.length)&&void 0!==o?o:0,padding:null!==(s=null===(u=null==l?void 0:l.bits)||void 0===u?void 0:u.padding)&&void 0!==s?s:0}),c}(s,u,e.Vt))}}}}},{key:"re",value:function(e,t){var n=e.Vt,r=n.unchangedNames,i=n.count;if(!r||!r.bits)return 1;var a,o,u=r.bits,s=u.bitmap,c=void 0===s?"":s,l=u.padding,h=void 0===l?0:l,f=r.hashCount,d=void 0===f?0:f;try{a=Hm(c).toUint8Array()}catch(e){if(e instanceof jm)return Jv("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{o=new x_(a,h,d)}catch(e){return Jv(e instanceof I_?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===o.It?1:i!==t-this.oe(e.targetId,o)?2:0}},{key:"oe",value:function(e,t){var n=this,r=this.Gt.getRemoteKeysForTarget(e),i=0;return r.forEach((function(r){var a=n.Gt.ue(),o="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(r.path.canonicalString());t.vt(o)||(n.Yt(e,r,null),i++)})),i}},{key:"ce",value:function(e){var t=this,n=new Map;this.Qt.forEach((function(r,i){var a=t.se(i);if(a){if(r.current&&Yg(a.target)){var o=new Ey(a.target.path);null!==t.jt.get(o)||t.ae(i,o)||t.Yt(i,o,_g.newNoDocument(o,e))}r.Mt&&(n.set(i,r.Ot()),r.Ft())}}));var r=Ck();this.zt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.se(e);return!n||"TargetPurposeLimboResolution"===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.jt.forEach((function(t,n){return n.setReadTime(e)}));var i=new E_(e,n,this.Wt,this.jt,r);return this.jt=kk(),this.zt=P_(),this.Wt=new Dm(yy),i}},{key:"Jt",value:function(e,t){if(this.te(e)){var n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}}},{key:"Yt",value:function(e,t,n){if(this.te(e)){var r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Qt.delete(e)}},{key:"ie",value:function(e){var t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"qt",value:function(e){this.Zt(e).qt()}},{key:"Zt",value:function(e){var t=this.Qt.get(e);return t||(t=new R_,this.Qt.set(e,t)),t}},{key:"he",value:function(e){var t=this.zt.get(e);return t||(t=new Mm(yy),this.zt=this.zt.insert(e,t)),t}},{key:"te",value:function(e){var t=null!==this.se(e);return t||Xv("WatchChangeAggregator","Detected inactive target",e),t}},{key:"se",value:function(e){var t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}},{key:"ee",value:function(e){var t=this;this.Qt.set(e,new R_),this.Gt.getRemoteKeysForTarget(e).forEach((function(n){t.Yt(e,n,null)}))}},{key:"ae",value:function(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}]),e}();function P_(){return new Dm(Ey.comparator)}function D_(){return new Dm(Ey.comparator)}var O_={asc:"ASCENDING",desc:"DESCENDING"},L_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M_={and:"AND",or:"OR"},F_=y((function e(t,n){f(this,e),this.databaseId=t,this.useProto3Json=n}));function U_(e,t){return e.useProto3Json||Jy(t)?t:{value:t}}function V_(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function j_(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function q_(e,t){return V_(e,t.toTimestamp())}function B_(e){return ty(!!e),_y.fromTimestamp(function(e){var t=zm(e);return new ky(t.seconds,t.nanos)}(e))}function z_(e,t){return function(e){return new by(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function W_(e){var t=by.fromString(e);return ty(dw(t)),t}function H_(e,t){return z_(e.databaseId,t.path)}function K_(e,t){var n=W_(t);if(n.get(1)!==e.databaseId.projectId)throw new iy(ry.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new iy(ry.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ey(X_(n))}function G_(e,t){return z_(e.databaseId,t)}function Q_(e){var t=W_(e);return 4===t.length?by.emptyPath():X_(t)}function Y_(e){return new by(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function X_(e){return ty(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function $_(e,t,n){return{name:H_(e,t),fields:n.value.mapValue.fields}}function J_(e,t,n){var r=K_(e,t.name),i=B_(t.updateTime),a=t.createTime?B_(t.createTime):_y.min(),o=new gg({mapValue:{fields:t.fields}}),u=_g.newFoundDocument(r,i,a,o);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function Z_(e,t){return"found"in t?function(e,t){ty(!!t.found),t.found.name,t.found.updateTime;var n=K_(e,t.found.name),r=B_(t.found.updateTime),i=t.found.createTime?B_(t.found.createTime):_y.min(),a=new gg({mapValue:{fields:t.found.fields}});return _g.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){ty(!!t.missing),ty(!!t.readTime);var n=K_(e,t.missing),r=B_(t.readTime);return _g.newNoDocument(n,r)}(e,t):ey()}function ew(e,t){var n;if(t instanceof n_)n={update:$_(e,t.key,t.value)};else if(t instanceof c_)n={delete:H_(e,t.key)};else if(t instanceof r_)n={update:$_(e,t.key,t.data),updateMask:fw(t.fieldMask)};else{if(!(t instanceof l_))return ey();n={verify:H_(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Uk)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Vk)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof qk)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zk)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw ey()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:q_(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ey()}(e,t.precondition)),n}function tw(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Qk.updateTime(B_(e.updateTime)):void 0!==e.exists?Qk.exists(e.exists):Qk.none()}(t.currentDocument):Qk.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)ty("REQUEST_TIME"===t.setToServerValue),n=new Uk;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Vk(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new qk(i)}else"increment"in t?n=new zk(e,t.increment):ey();var a=Iy.fromServerFormat(t.fieldPath);return new Kk(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=K_(e,t.update.name),a=new gg({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Vm(t.map((function(e){return Iy.fromServerFormat(e)})))}(t.updateMask);return new r_(i,a,o,n,r)}return new n_(i,a,n,r)}if(t.delete){var u=K_(e,t.delete);return new c_(u,n)}if(t.verify){var s=K_(e,t.verify);return new l_(s,n)}return ey()}function nw(e,t){return{documents:[G_(e,t.path)]}}function rw(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=G_(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=G_(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return hw(Cg.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:cw(e.field),direction:ow(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u=U_(e,t.limit);return null!==u&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function iw(e){var t=Q_(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ty(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=function(e){var t=aw(e);return t instanceof Cg&&Ag(t)?t.getFilters():[t]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return function(e){return new Ig(lw(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var s=null;n.limit&&(s=function(e){var t;return Jy(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new wg(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new wg(n,t)}(n.endAt)),ek(t,i,u,o,s,"F",c,l)}function aw(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=lw(e.unaryFilter.field);return Sg.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=lw(e.unaryFilter.field);return Sg.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=lw(e.unaryFilter.field);return Sg.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=lw(e.unaryFilter.field);return Sg.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ey()}}(e):void 0!==e.fieldFilter?function(e){return Sg.create(lw(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ey()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Cg.create(e.compositeFilter.filters.map((function(e){return aw(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ey()}}(e.compositeFilter.op))}(e):ey()}function ow(e){return O_[e]}function uw(e){return L_[e]}function sw(e){return M_[e]}function cw(e){return{fieldPath:e.canonicalString()}}function lw(e){return Iy.fromServerFormat(e.fieldPath)}function hw(e){return e instanceof Sg?function(e){if("=="===e.op){if(lg(e.value))return{unaryFilter:{field:cw(e.field),op:"IS_NAN"}};if(cg(e.value))return{unaryFilter:{field:cw(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(lg(e.value))return{unaryFilter:{field:cw(e.field),op:"IS_NOT_NAN"}};if(cg(e.value))return{unaryFilter:{field:cw(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cw(e.field),op:uw(e.op),value:e.value}}}(e):e instanceof Cg?function(e){var t=e.getFilters().map((function(e){return hw(e)}));return 1===t.length?t[0]:{compositeFilter:{op:sw(e.op),filters:t}}}(e):ey()}function fw(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function dw(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var pw=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_y.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:_y.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:qm.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;f(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=s}return y(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}},{key:"withExpectedCount",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}]),e}(),vw=y((function e(t){f(this,e),this.fe=t}));function yw(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:mw(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:H_(e,t.key),fields:t.data.value.mapValue.fields,updateTime:V_(e,t.version.toTimestamp()),createTime:V_(e,t.createTime.toTimestamp())}}(e.fe,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:gw(t.version)};else{if(!t.isUnknownDocument())return ey();r.unknownDocument={path:n.path.toArray(),version:gw(t.version)}}return r}function mw(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function gw(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function kw(e){var t=new ky(e.seconds,e.nanoseconds);return _y.fromTimestamp(t)}function _w(e,t){for(var n=(t.baseMutations||[]).map((function(t){return tw(e.fe,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return tw(e.fe,t)})),u=ky.fromMillis(t.localWriteTimeMs);return new h_(t.batchId,u,n,o)}function ww(e){var t,n,r=kw(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?kw(e.lastLimboFreeSnapshotVersion):_y.min();return void 0!==e.query.documents?(ty(1===(n=e.query).documents.length),t=uk(tk(Q_(n.documents[0])))):t=function(e){return uk(iw(e))}(e.query),new pw(t,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,i,qm.fromBase64String(e.resumeToken))}function bw(e,t){var n,r=gw(t.snapshotVersion),i=gw(t.lastLimboFreeSnapshotVersion);n=Yg(t.target)?nw(e.fe,t.target):rw(e.fe,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Gg(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function xw(e){var t=iw({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ck(t,t.limit,"L"):t}function Iw(e,t){return new d_(t.largestBatchId,tw(e.fe,t.overlayMutation))}function Ew(e,t){var n=t.path.lastSegment();return[e,tm(t.path.popLast()),n]}function Tw(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:gw(r.readTime),documentKey:tm(r.documentKey.path),largestBatchId:r.largestBatchId}}var Sw=function(){function e(){f(this,e)}return y(e,[{key:"getBundleMetadata",value:function(e,t){return Cw(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:kw(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return Cw(e).put({bundleId:(n=t).id,createTime:gw(B_(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return Nw(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:xw(t.bundledQuery),readTime:kw(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return Nw(e).put(function(e){return{name:e.name,readTime:gw(B_(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function Cw(e){return Nm(e,"bundles")}function Nw(e){return Nm(e,"namedQueries")}var Rw=function(){function e(t,n){f(this,e),this.serializer=t,this.userId=n}return y(e,[{key:"getOverlay",value:function(e,t){var n=this;return Aw(e).get(Ew(this.userId,t)).next((function(e){return e?Iw(n.serializer,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=xk();return Vy.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new d_(t,a);i.push(r.we(e,o))})),Vy.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(tm(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(Aw(e).J("collectionPathOverlayIndex",i))})),Vy.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=xk(),a=tm(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Aw(e).j("collectionPathOverlayIndex",o).next((function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=Iw(r.serializer,a);i.set(o.getKey(),o)}}catch(u){n.e(u)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=xk(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Aw(e).X({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=Iw(a.serializer,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"we",value:function(e,t){return Aw(e).put(function(e,t,n){var r=c(Ew(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:ew(e.fe,n.mutation)}}(this.serializer,this.userId,t))}}],[{key:"de",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function Aw(e){return Nm(e,"documentOverlays")}var Pw=function(){function e(){f(this,e)}return y(e,[{key:"_e",value:function(e,t){this.me(e,t),t.ge()}},{key:"me",value:function(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Wm(e.integerValue));else if("doubleValue"in e){var n=Wm(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Zy(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie("".concat(r.seconds||"")),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Hm(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ye(t,45),t.pe(i.latitude||0),t.pe(i.longitude||0)}else"mapValue"in e?dg(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):ey()}},{key:"Te",value:function(e,t){this.ye(t,25),this.be(e,t)}},{key:"be",value:function(e,t){t.Ie(e)}},{key:"Re",value:function(e,t){var n=e.fields||{};this.ye(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.Te(a,t),this.me(n[a],t)}}},{key:"Pe",value:function(e,t){var n=e.values||[];this.ye(t,50);var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.me(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"ve",value:function(e,t){var n=this;this.ye(t,37),Ey.fromName(e).path.forEach((function(e){n.ye(t,60),n.be(e,t)}))}},{key:"ye",value:function(e,t){e.pe(t)}},{key:"Ee",value:function(e){e.pe(2)}}]),e}();function Dw(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ow(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=Dw(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Pw.Ve=new Pw;var Lw=function(){function e(){f(this,e),this.buffer=new Uint8Array(1024),this.position=0}return y(e,[{key:"Se",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.De(n.value),n=t.next();this.Ce()}},{key:"xe",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ne(n.value),n=t.next();this.ke()}},{key:"Me",value:function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.De(i);else if(i<2048)this.De(960|i>>>6),this.De(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.De(480|i>>>12),this.De(128|63&i>>>6),this.De(128|63&i);else{var a=r.codePointAt(0);this.De(240|a>>>18),this.De(128|63&a>>>12),this.De(128|63&a>>>6),this.De(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Ce()}},{key:"$e",value:function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ne(i);else if(i<2048)this.Ne(960|i>>>6),this.Ne(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ne(480|i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i);else{var a=r.codePointAt(0);this.Ne(240|a>>>18),this.Ne(128|63&a>>>12),this.Ne(128|63&a>>>6),this.Ne(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.ke()}},{key:"Oe",value:function(e){var t=this.Fe(e),n=Ow(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"Le",value:function(e){var t=this.Fe(e),n=Ow(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"qe",value:function(){this.Ue(255),this.Ue(255)}},{key:"Ke",value:function(){this.Ge(255),this.Ge(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Qe",value:function(){return this.buffer.slice(0,this.position)}},{key:"Fe",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"De",value:function(e){var t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}},{key:"Ne",value:function(e){var t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}},{key:"Ce",value:function(){this.Ue(0),this.Ue(1)}},{key:"ke",value:function(){this.Ge(0),this.Ge(1)}},{key:"Ue",value:function(e){this.Be(1),this.buffer[this.position++]=e}},{key:"Ge",value:function(e){this.Be(1),this.buffer[this.position++]=~e}},{key:"Be",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),Mw=function(){function e(t){f(this,e),this.je=t}return y(e,[{key:"Ae",value:function(e){this.je.Se(e)}},{key:"Ie",value:function(e){this.je.Me(e)}},{key:"pe",value:function(e){this.je.Oe(e)}},{key:"ge",value:function(){this.je.qe()}}]),e}(),Fw=function(){function e(t){f(this,e),this.je=t}return y(e,[{key:"Ae",value:function(e){this.je.xe(e)}},{key:"Ie",value:function(e){this.je.$e(e)}},{key:"pe",value:function(e){this.je.Le(e)}},{key:"ge",value:function(){this.je.Ke()}}]),e}(),Uw=function(){function e(){f(this,e),this.je=new Lw,this.ze=new Mw(this.je),this.We=new Fw(this.je)}return y(e,[{key:"seed",value:function(e){this.je.seed(e)}},{key:"He",value:function(e){return 0===e?this.ze:this.We}},{key:"Qe",value:function(){return this.je.Qe()}},{key:"reset",value:function(){this.je.reset()}}]),e}(),Vw=function(){function e(t,n,r,i){f(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return y(e,[{key:"Je",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function jw(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=qw(e.arrayValue,t.arrayValue))?n:0!==(n=qw(e.directionalValue,t.directionalValue))?n:Ey.comparator(e.documentKey,t.documentKey)}function qw(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var Bw=function(){function e(t){f(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ye=t.orderBy,this.Xe=[];var n,r=T(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.Ze=i:this.Xe.push(i)}}catch(a){r.e(a)}finally{r.f()}}return y(e,[{key:"tn",value:function(e){ty(e.collectionGroup===this.collectionId);var t=Sy(e);if(void 0!==t&&!this.en(t))return!1;for(var n=Cy(e),r=0,i=0;r<n.length&&this.en(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Ze){var a=n[r];if(!this.nn(this.Ze,a)||!this.sn(this.Ye[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ye.length||!this.sn(this.Ye[i++],o))return!1}return!0}},{key:"en",value:function(e){var t,n=T(this.Xe);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.nn(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"nn",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"sn",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function zw(e){var t,n;if(ty(e instanceof Sg||e instanceof Cg),e instanceof Sg){if(e instanceof Bg){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return Sg.create(e.field,"==",t)})))||[];return Cg.create(r,"or")}return e}var i=e.filters.map((function(e){return zw(e)}));return Cg.create(i,e.op)}function Ww(e){if(0===e.getFilters().length)return[];var t=Qw(zw(e));return ty(Gw(t)),Hw(t)||Kw(t)?[t]:t.getFilters()}function Hw(e){return e instanceof Sg}function Kw(e){return e instanceof Cg&&Ag(e)}function Gw(e){return Hw(e)||Kw(e)||function(e){if(e instanceof Cg&&Rg(e)){var t,n=T(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!Hw(r)&&!Kw(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function Qw(e){if(ty(e instanceof Sg||e instanceof Cg),e instanceof Sg)return e;if(1===e.filters.length)return Qw(e.filters[0]);var t=e.filters.map((function(e){return Qw(e)})),n=Cg.create(t,e.op);return Gw(n=$w(n))?n:(ty(n instanceof Cg),ty(Ng(n)),ty(n.filters.length>1),n.filters.reduce((function(e,t){return Yw(e,t)})))}function Yw(e,t){var n;return ty(e instanceof Sg||e instanceof Cg),ty(t instanceof Sg||t instanceof Cg),n=e instanceof Sg?t instanceof Sg?function(e,t){return Cg.create([e,t],"and")}(e,t):Xw(e,t):t instanceof Sg?Xw(t,e):function(e,t){if(ty(e.filters.length>0&&t.filters.length>0),Ng(e)&&Ng(t))return Lg(e,t.getFilters());var n=Rg(e)?e:t,r=Rg(e)?t:e,i=n.filters.map((function(e){return Yw(e,r)}));return Cg.create(i,"or")}(e,t),$w(n)}function Xw(e,t){if(Ng(t))return Lg(t,e.getFilters());var n=t.filters.map((function(t){return Yw(e,t)}));return Cg.create(n,"or")}function $w(e){if(ty(e instanceof Sg||e instanceof Cg),e instanceof Sg)return e;var t=e.getFilters();if(1===t.length)return $w(t[0]);if(Pg(e))return e;var n=t.map((function(e){return $w(e)})),r=[];return n.forEach((function(t){t instanceof Sg?r.push(t):t instanceof Cg&&(t.op===e.op?r.push.apply(r,h(t.filters)):r.push(t))})),1===r.length?r[0]:Cg.create(r,e.op)}var Jw=function(){function e(){f(this,e),this.rn=new Zw}return y(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.rn.add(t),Vy.resolve()}},{key:"getCollectionParents",value:function(e,t){return Vy.resolve(this.rn.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Vy.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Vy.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Vy.resolve(null)}},{key:"getIndexType",value:function(e,t){return Vy.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Vy.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Vy.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Vy.resolve(Dy.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Vy.resolve(Dy.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Vy.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Vy.resolve()}}]),e}(),Zw=function(){function e(){f(this,e),this.index={}}return y(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Mm(by.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Mm(by.comparator)).toArray()}}]),e}(),eb=new Uint8Array(0),tb=function(){function e(t,n){f(this,e),this.user=t,this.databaseId=n,this.on=new Zw,this.un=new mk((function(e){return Gg(e)}),(function(e,t){return Qg(e,t)})),this.uid=t.uid||""}return y(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.on.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.on.add(t)}));var a={collectionId:r,parent:tm(i)};return nb(e).put(a)}return Vy.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[gy(t),""],!1,!0);return nb(e).j(r).next((function(e){var r,i=T(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(im(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=ib(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var o=ab(e);return a.next((function(e){o.put(Tw(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=ib(e),r=ab(e),i=rb(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=rb(e),i=!0,a=new Map;return Vy.forEach(this.cn(t),(function(t){return n.an(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=Ck(),o=[];return Vy.forEach(a,(function(i,a){var u;Xv("IndexedDbIndexManager","Using index ".concat((u=i,"id=".concat(u.indexId,"|cg=").concat(u.collectionGroup,"|f=").concat(u.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(Gg(t)));var s=function(e,t){var n=Sy(t);if(void 0===n)return null;var r,i=T(Xg(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r=new Map,i=T(Cy(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,u=T(Xg(e,o.fieldPath));try{for(u.s();!(a=u.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],i=!0,a=T(Cy(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?$g(e,o.fieldPath,e.startAt):Jg(e,o.fieldPath,e.startAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new wg(r,i)}(a,i),h=function(e,t){var n,r=[],i=!0,a=T(Cy(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?Jg(e,o.fieldPath,e.endAt):$g(e,o.fieldPath,e.endAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new wg(r,i)}(a,i),f=n.hn(i,a,l),d=n.hn(i,a,h),p=n.ln(i,a,c),v=n.fn(i.indexId,s,f,l.inclusive,d,h.inclusive,p);return Vy.forEach(v,(function(n){return r.H(n,t.limit).next((function(t){t.forEach((function(t){var n=Ey.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return Vy.resolve(null)}))}},{key:"cn",value:function(e){var t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Ww(Cg.create(e.filters,"and")).map((function(t){return Kg(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.un.set(e,t),t)}},{key:"fn",value:function(e,t,n,r,i,a,o){for(var u=this,s=(null!=t?t.length:1)*Math.max(n.length,i.length),c=s/(null!=t?t.length:1),l=[],f=function(){var s=t?u.dn(t[d/c]):eb,f=u.wn(e,s,n[d%c],r),p=u._n(e,s,i[d%c],a),v=o.map((function(t){return u.wn(e,s,t,!0)}));l.push.apply(l,h(u.createRange(f,p,v)))},d=0;d<s;++d)f();return l}},{key:"wn",value:function(e,t,n,r){var i=new Vw(e,Ey.empty(),t,n);return r?i:i.Je()}},{key:"_n",value:function(e,t,n,r){var i=new Vw(e,Ey.empty(),t,n);return r?i.Je():i}},{key:"an",value:function(e,t){var n=new Bw(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,i=T(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.tn(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.cn(t);return Vy.forEach(i,(function(t){return n.an(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new Mm(Iy.comparator),r=!1,i=T(e.filters);try{for(i.s();!(t=i.n()).done;){var a,o=T(t.value.getFlattenedFilters());try{for(o.s();!(a=o.n()).done;){var u=a.value;u.field.isKeyField()||("array-contains"===u.op||"array-contains-any"===u.op?r=!0:n=n.add(u.field))}}catch(h){o.e(h)}finally{o.f()}}}catch(h){i.e(h)}finally{i.f()}var s,c=T(e.orderBy);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.field.isKeyField()||(n=n.add(l.field))}}catch(h){c.e(h)}finally{c.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return function(e){return null!==e.limit}(t)&&i.length>1&&2===r?1:r}))}},{key:"mn",value:function(e,t){var n,r=new Uw,i=T(Cy(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var u=r.He(a.kind);Pw.Ve._e(o,u)}}catch(s){i.e(s)}finally{i.f()}return r.Qe()}},{key:"dn",value:function(e){var t=new Uw;return Pw.Ve._e(e,t.He(0)),t.Qe()}},{key:"gn",value:function(e,t){var n=new Uw;return Pw.Ve._e(og(this.databaseId,t),n.He(function(e){var t=Cy(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Qe()}},{key:"ln",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new Uw);var i,a=0,o=T(Cy(e));try{for(o.s();!(i=o.n()).done;){var u,s=i.value,c=n[a++],l=T(r);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(this.yn(t,s.fieldPath)&&sg(c))r=this.pn(r,s,c);else{var f=h.He(s.kind);Pw.Ve._e(c,f)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.In(r)}},{key:"hn",value:function(e,t,n){return this.ln(e,t,n.position)}},{key:"In",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Qe();return t}},{key:"pn",value:function(e,t,n){var r,i=h(e),a=[],o=T(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var u,s=r.value,c=T(i);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=new Uw;f.seed(l.Qe()),Pw.Ve._e(s,f.He(t.kind)),a.push(f)}}catch(d){c.e(d)}finally{c.f()}}}catch(d){o.e(d)}finally{o.f()}return a}},{key:"yn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Sg&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=ib(e),i=ab(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next((function(e){var t=[];return Vy.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new Ry(t.sequenceNumber,new Dy(kw(t.readTime),new Ey(im(t.documentKey)),t.largestBatchId)):Ry.empty(),r=e.fields.map((function(e){var t=c(e,2),n=t[0],r=t[1];return new Ny(Iy.fromServerFormat(n),r)}));return new Ty(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:yy(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=ib(e),a=ab(e);return this.Tn(e).next((function(e){return i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Vy.forEach(t,(function(t){return a.put(Tw(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Vy.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?Vy.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),Vy.forEach(a,(function(r){return n.En(e,t,r).next((function(t){var a=n.An(i,r);return t.isEqual(a)?Vy.resolve():n.vn(e,i,r,t,a)}))}))}))}))}},{key:"Rn",value:function(e,t,n,r){return rb(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}},{key:"Pn",value:function(e,t,n,r){return rb(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}},{key:"En",value:function(e,t,n){var r=rb(e),i=new Mm(jw);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(function(e,r){i=i.add(new Vw(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"An",value:function(e,t){var n=new Mm(jw),r=this.mn(t,e);if(null==r)return n;var i=Sy(t);if(null!=i){var a=e.data.field(i.fieldPath);if(sg(a)){var o,u=T(a.arrayValue.values||[]);try{for(u.s();!(o=u.n()).done;){var s=o.value;n=n.add(new Vw(t.indexId,e.key,this.dn(s),r))}}catch(c){u.e(c)}finally{u.f()}}}else n=n.add(new Vw(t.indexId,e.key,eb,r));return n}},{key:"vn",value:function(e,t,n,r,i){var a=this;Xv("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=Um(a),s=Um(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=Um(o)):l?(i(u),u=Um(a)):(u=Um(a),s=Um(o))}}(r,i,jw,(function(r){o.push(a.Rn(e,t,n,r))}),(function(r){o.push(a.Pn(e,t,n,r))})),Vy.waitFor(o)}},{key:"Tn",value:function(e){var t=1;return ab(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return jw(e,t)})).filter((function(e,t,n){return!t||0!==jw(e,n[t-1])}));var r=[];r.push(e);var i,a=T(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=jw(o,e),s=jw(o,t);if(0===u)r[0]=e.Je();else if(u>0&&s<0)r.push(o),r.push(o.Je());else if(s>0)break}}catch(d){a.e(d)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.bn(r[l],r[l+1]))return[];var h=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,eb,[]],f=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,eb,[]];c.push(IDBKeyRange.bound(h,f))}return c}},{key:"bn",value:function(e,t){return jw(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(ob)}},{key:"getMinOffset",value:function(e,t){var n=this;return Vy.mapArray(this.cn(t),(function(t){return n.an(e,t).next((function(e){return e||ey()}))})).next(ob)}}]),e}();function nb(e){return Nm(e,"collectionParents")}function rb(e){return Nm(e,"indexEntries")}function ib(e){return Nm(e,"indexConfiguration")}function ab(e){return Nm(e,"indexState")}function ob(e){ty(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;Oy(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Dy(t.readTime,t.documentKey,n)}var ub={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sb=function(){function e(t,n,r){f(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return y(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function cb(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.X({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){ty(1===u)})));var c,l=[],h=T(n.mutations);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=um(t,f.key.path,n.batchId);a.push(i.delete(d)),l.push(f.key)}}catch(p){h.e(p)}finally{h.f()}return Vy.waitFor(a).next((function(){return l}))}function lb(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ey();t=e.noDocument}return JSON.stringify(t).length}sb.DEFAULT_COLLECTION_PERCENTILE=10,sb.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sb.DEFAULT=new sb(41943040,sb.DEFAULT_COLLECTION_PERCENTILE,sb.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sb.DISABLED=new sb(-1,0,0);var hb=function(){function e(t,n,r,i){f(this,e),this.userId=t,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}return y(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return db(e).X({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=pb(e),o=db(e);return o.add({}).next((function(u){ty("number"==typeof u);var s,c=new h_(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return ew(e.fe,t)})),i=n.mutations.map((function(t){return ew(e.fe,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.serializer,i.userId,c),h=[],f=new Mm((function(e,t){return yy(e.canonicalString(),t.canonicalString())})),d=T(r);try{for(d.s();!(s=d.n()).done;){var p=s.value,v=um(i.userId,p.key.path,u);f=f.add(p.key.path.popLast()),h.push(o.put(l)),h.push(a.put(v,sm))}}catch(y){d.e(y)}finally{d.f()}return f.forEach((function(t){h.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.Vn[u]=c.keys()})),Vy.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return db(e).get(t).next((function(e){return e?(ty(e.userId===n.userId),_w(n.serializer,e)):null}))}},{key:"Sn",value:function(e,t){var n=this;return this.Vn[t]?Vy.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.Vn[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return db(e).X({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(ty(t.batchId>=r),a=_w(n.serializer,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return db(e).X({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return db(e).j("userMutationsIndex",n).next((function(e){return e.map((function(e){return _w(t.serializer,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=om(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return pb(e).X({range:i},(function(r,i,o){var u=c(r,3),s=u[0],l=u[1],h=u[2],f=im(l);if(s===n.userId&&t.path.isEqual(f))return db(e).get(h).next((function(e){if(!e)throw ey();ty(e.userId===n.userId),a.push(_w(n.serializer,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Mm(yy),i=[];return t.forEach((function(t){var a=om(n.userId,t.path),o=IDBKeyRange.lowerBound(a),u=pb(e).X({range:o},(function(e,i,a){var o=c(e,3),u=o[0],s=o[1],l=o[2],h=im(s);u===n.userId&&t.path.isEqual(h)?r=r.add(l):a.done()}));i.push(u)})),Vy.waitFor(i).next((function(){return n.Dn(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=om(this.userId,r),o=IDBKeyRange.lowerBound(a),u=new Mm(yy);return pb(e).X({range:o},(function(e,t,a){var o=c(e,3),s=o[0],l=o[1],h=o[2],f=im(l);s===n.userId&&r.isPrefixOf(f)?f.length===i&&(u=u.add(h)):a.done()})).next((function(){return n.Dn(e,u)}))}},{key:"Dn",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(db(e).get(t).next((function(e){if(null===e)throw ey();ty(e.userId===n.userId),r.push(_w(n.serializer,e))})))})),Vy.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return cb(e.ht,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.Cn(t.batchId)})),Vy.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"Cn",value:function(e){delete this.Vn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Vy.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return pb(e).X({range:r},(function(e,n,r){if(e[0]===t.userId){var a=im(e[1]);i.push(a)}else r.done()})).next((function(){ty(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return fb(e,this.userId,t)}},{key:"xn",value:function(e){var t=this;return vb(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"de",value:function(t,n,r,i){return ty(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function fb(e,t,n){var r=om(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return pb(e).X({range:a,Y:!0},(function(e,n,r){var a=c(e,3),u=a[0],s=a[1];a[2];u===t&&s===i&&(o=!0),r.done()})).next((function(){return o}))}function db(e){return Nm(e,"mutations")}function pb(e){return Nm(e,"documentMutations")}function vb(e){return Nm(e,"mutationQueues")}var yb=function(){function e(t){f(this,e),this.Nn=t}return y(e,[{key:"next",value:function(){return this.Nn+=2,this.Nn}}],[{key:"kn",value:function(){return new e(0)}},{key:"Mn",value:function(){return new e(-1)}}]),e}(),mb=function(){function e(t,n){f(this,e),this.referenceDelegate=t,this.serializer=n}return y(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.$n(e).next((function(n){var r=new yb(n.highestTargetId);return n.highestTargetId=r.next(),t.On(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.$n(e).next((function(e){return _y.fromTimestamp(new ky(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.$n(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.$n(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.On(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Fn(e,t).next((function(){return n.$n(e).next((function(r){return r.targetCount+=1,n.Bn(t,r),n.On(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Fn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return gb(e).delete(t.targetId)})).next((function(){return n.$n(e)})).next((function(t){return ty(t.targetCount>0),t.targetCount-=1,n.On(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return gb(e).X((function(o,u){var s=ww(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return Vy.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return gb(e).X((function(e,n){var r=ww(n);t(r)}))}},{key:"$n",value:function(e){return kb(e).get("targetGlobalKey").next((function(e){return ty(null!==e),e}))}},{key:"On",value:function(e,t){return kb(e).put("targetGlobalKey",t)}},{key:"Fn",value:function(e,t){return gb(e).put(bw(this.serializer,t))}},{key:"Bn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.$n(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=Gg(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return gb(e).X({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=ww(n);Qg(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=_b(e);return t.forEach((function(t){var o=tm(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Vy.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=_b(e);return Vy.forEach(t,(function(t){var a=tm(t.path);return Vy.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=_b(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=_b(e),i=Ck();return r.X({range:n,Y:!0},(function(e,t,n){var r=im(e[1]),a=new Ey(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=tm(t.path),r=IDBKeyRange.bound([n],[gy(n)],!1,!0),i=0;return _b(e).X({index:"documentTargetsIndex",Y:!0,range:r},(function(e,t,n){var r=c(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"le",value:function(e,t){return gb(e).get(t).next((function(e){return e?ww(e):null}))}}]),e}();function gb(e){return Nm(e,"targets")}function kb(e){return Nm(e,"targetGlobal")}function _b(e){return Nm(e,"targetDocuments")}function wb(e,t){var n=c(e,2),r=n[0],i=n[1],a=c(t,2),o=a[0],u=a[1],s=yy(r,o);return 0===s?yy(i,u):s}var bb=function(){function e(t){f(this,e),this.Ln=t,this.buffer=new Mm(wb),this.qn=0}return y(e,[{key:"Un",value:function(){return++this.qn}},{key:"Kn",value:function(e){var t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();wb(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),xb=function(){function e(t,n,r){f(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Gn=null}return y(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}},{key:"stop",value:function(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}},{key:"started",get:function(){return null!==this.Gn}},{key:"Qn",value:function(e){var t=this;Xv("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Gn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!Wy(e.t0)){e.next=12;break}Xv("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Fy(e.t0);case 14:return e.next=16,t.Qn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),Ib=function(){function e(t,n){f(this,e),this.jn=t,this.params=n}return y(e,[{key:"calculateTargetCount",value:function(e,t){return this.jn.zn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Vy.resolve($y.ct);var r=new bb(t);return this.jn.forEachTarget(e,(function(e){return r.Kn(e.sequenceNumber)})).next((function(){return n.jn.Wn(e,(function(e){return r.Kn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.jn.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.jn.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Xv("LruGarbageCollector","Garbage collection skipped; disabled"),Vy.resolve(ub)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Xv("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),ub):n.Hn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.jn.getCacheSize(e)}},{key:"Hn",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Xv("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Yv()<=xn.DEBUG&&Xv("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),Vy.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}();function Eb(e,t){return new Ib(e,t)}var Tb=function(){function e(t,n){f(this,e),this.db=t,this.garbageCollector=Eb(this,n)}return y(e,[{key:"zn",value:function(e){var t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Jn",value:function(e){var t=0;return this.Wn(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Wn",value:function(e,t){return this.Yn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return Sb(e,n)}},{key:"removeReference",value:function(e,t,n){return Sb(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return Sb(e,t)}},{key:"Xn",value:function(e,t){return function(e,t){var n=!1;return vb(e).Z((function(r){return fb(e,r,t).next((function(e){return e&&(n=!0),Vy.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Yn(e,(function(o,u){if(u<=t){var s=n.Xn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,_y.min()),_b(e).delete([0,tm(o.path)])}))}));i.push(s)}})).next((function(){return Vy.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return Sb(e,t)}},{key:"Yn",value:function(e,t){var n,r=_b(e),i=$y.ct;return r.X({index:"documentTargetsIndex"},(function(e,r){var a=c(e,2),o=a[0],u=(a[1],r.path),s=r.sequenceNumber;0===o?(i!==$y.ct&&t(new Ey(im(n)),i),i=s,n=u):i=$y.ct})).next((function(){i!==$y.ct&&t(new Ey(im(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function Sb(e,t){return _b(e).put(function(e,t){return{targetId:0,path:tm(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var Cb=function(){function e(){f(this,e),this.changes=new mk((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return y(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,_g.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Vy.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),Nb=function(){function e(t){f(this,e),this.serializer=t}return y(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return Db(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return Db(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],mw(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Zn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=_g.newInvalidDocument(t);return Db(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ob(t))},(function(e,i){r=n.ts(t,i)})).next((function(){return r}))}},{key:"es",value:function(e,t){var n=this,r={size:0,document:_g.newInvalidDocument(t)};return Db(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ob(t))},(function(e,i){r={document:n.ts(t,i),size:lb(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=kk();return this.ns(e,t,(function(e,t){var i=n.ts(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"ss",value:function(e,t){var n=this,r=kk(),i=new Dm(Ey.comparator);return this.ns(e,t,(function(e,t){var a=n.ts(e,t);r=r.insert(e,a),i=i.insert(e,lb(t))})).next((function(){return{documents:r,rs:i}}))}},{key:"ns",value:function(e,t,n){if(t.isEmpty())return Vy.resolve();var r=new Mm(Mb);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(Ob(r.first()),Ob(r.last())),a=r.getIterator(),o=a.getNext();return Db(e).X({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=Ey.fromSegments([].concat(h(t.prefixPath),[t.collectionGroup,t.documentId]));o&&Mb(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.G(Ob(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a=t.path,o=[a.popLast().toArray(),a.lastSegment(),mw(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],u=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Db(e).j(IDBKeyRange.bound(o,u,!0)).next((function(e){var n,a=kk(),o=T(e);try{for(o.s();!(n=o.n()).done;){var u=n.value,s=i.ts(Ey.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s.isFoundDocument()&&(dk(t,s)||r.has(s.key))&&(a=a.insert(s.key,s))}}catch(c){o.e(c)}finally{o.f()}return a}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=kk(),o=Lb(t,n),u=Lb(t,Dy.max());return Db(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.ts(Ey.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new Ab(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return Pb(e).get("remoteDocumentGlobalKey").next((function(e){return ty(!!e),e}))}},{key:"Zn",value:function(e,t){return Pb(e).put("remoteDocumentGlobalKey",t)}},{key:"ts",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=J_(e.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=Ey.fromSegments(t.noDocument.path),i=kw(t.noDocument.readTime);n=_g.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return ey();var a=Ey.fromSegments(t.unknownDocument.path),o=kw(t.unknownDocument.version);n=_g.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new ky(e[0],e[1]);return _y.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(_y.min()))return n}return _g.newInvalidDocument(e)}}]),e}();function Rb(e){return new Nb(e)}var Ab=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).os=e,i.trackRemovals=r,i.us=new mk((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return y(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new Mm((function(e,t){return yy(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.us.get(a);if(n.push(t.os.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=yw(t.os.serializer,o);i=i.add(a.path.popLast());var c=lb(s);r+=c-u.size,n.push(t.os.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=yw(t.os.serializer,o.convertToNoDocument(_y.min()));n.push(t.os.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.os.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.os.updateMetadata(e,r)),Vy.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.os.es(e,t).next((function(e){return n.us.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.os.ss(e,t).next((function(e){var t=e.documents;return e.rs.forEach((function(e,r){n.us.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(Cb);function Pb(e){return Nm(e,"remoteDocumentGlobal")}function Db(e){return Nm(e,"remoteDocumentsV14")}function Ob(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Lb(e,t){var n=t.documentKey.path.toArray();return[e,mw(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Mb(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=yy(n[a],r[a]))return i;return(i=yy(n.length,r.length))||((i=yy(n[n.length-2],r[r.length-2]))||yy(n[n.length-1],r[r.length-1]))}var Fb=y((function e(t,n){f(this,e),this.overlayedDocument=t,this.mutatedFields=n})),Ub=function(){function e(t,n,r,i){f(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return y(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&Zk(r.mutation,e,Vm.empty(),ky.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,Ck()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ck(),i=xk();return this.populateOverlays(e,i,t).next((function(){return n.computeViews(e,t,i,r).next((function(e){var t=wk();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=xk();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,Ck())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=kk(),a=Ek(),o=Ek();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof r_)?i=i.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),Zk(o.mutation,t,o.mutation.getFieldMask(),ky.now())):a.set(t.key,Vm.empty())})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new Fb(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Ek(),i=new Dm((function(e,t){return e-t})),a=Ck();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,a=T(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||Vm.empty();o=e.applyToLocalView(a,o),r.set(n,o);var u=(i.get(e.batchId)||Ck()).add(n);i=i.insert(e.batchId,u)}}))};for(a.s();!(n=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}})).next((function(){for(var o=[],u=i.getReverseIterator(),s=function(){var i=u.getNext(),s=i.key,c=i.value,l=Ik();c.forEach((function(e){if(!a.has(e)){var n=$k(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,s,l))};u.hasNext();)s();return Vy.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return Ey.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ak(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Vy.resolve(xk()),u=-1,s=a;return o.next((function(t){return Vy.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?Vy.resolve():i.remoteDocumentCache.getEntry(e,t).next((function(e){s=s.insert(t,e)}))})).next((function(){return i.populateOverlays(e,t,a)})).next((function(){return i.computeViews(e,s,t,Ck())})).next((function(e){return{batchId:u,changes:bk(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Ey(t)).next((function(e){var t=wk();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=wk();return this.indexManager.getCollectionParents(e,i).next((function(o){return Vy.forEach(o,(function(o){var u=function(e,t){return new Zg(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.getDocumentsMatchingCollectionQuery(e,u,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(a){return r=a,i.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,_g.newInvalidDocument(r)))}));var n=wk();return e.forEach((function(e,i){var a=r.get(e);void 0!==a&&Zk(a.mutation,i,Vm.empty(),ky.now()),dk(t,i)&&(n=n.insert(e,i))})),n}))}}]),e}(),Vb=function(){function e(t){f(this,e),this.serializer=t,this.cs=new Map,this.hs=new Map}return y(e,[{key:"getBundleMetadata",value:function(e,t){return Vy.resolve(this.cs.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:B_(n.createTime)}),Vy.resolve()}},{key:"getNamedQuery",value:function(e,t){return Vy.resolve(this.hs.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:xw(e.bundledQuery),readTime:B_(e.readTime)}}(t)),Vy.resolve()}}]),e}(),jb=function(){function e(){f(this,e),this.overlays=new Dm(Ey.comparator),this.ls=new Map}return y(e,[{key:"getOverlay",value:function(e,t){return Vy.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=xk();return Vy.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.we(e,t,i)})),Vy.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.ls.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.ls.delete(n)),Vy.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=xk(),i=t.length+1,a=new Ey(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Vy.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Dm((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=xk(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=xk(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return Vy.resolve(s)}},{key:"we",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new d_(t,n));var a=this.ls.get(t);void 0===a&&(a=Ck(),this.ls.set(t,a)),this.ls.set(t,a.add(n.key))}}]),e}(),qb=function(){function e(){f(this,e),this.fs=new Mm(Bb.ds),this.ws=new Mm(Bb._s)}return y(e,[{key:"isEmpty",value:function(){return this.fs.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Bb(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}},{key:"gs",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.ys(new Bb(e,t))}},{key:"ps",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Is",value:function(e){var t=this,n=new Ey(new by([])),r=new Bb(n,e),i=new Bb(n,e+1),a=[];return this.ws.forEachInRange([r,i],(function(e){t.ys(e),a.push(e.key)})),a}},{key:"Ts",value:function(){var e=this;this.fs.forEach((function(t){return e.ys(t)}))}},{key:"ys",value:function(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}},{key:"Es",value:function(e){var t=new Ey(new by([])),n=new Bb(t,e),r=new Bb(t,e+1),i=Ck();return this.ws.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new Bb(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Bb=function(){function e(t,n){f(this,e),this.key=t,this.As=n}return y(e,null,[{key:"ds",value:function(e,t){return Ey.comparator(e.key,t.key)||yy(e.As,t.As)}},{key:"_s",value:function(e,t){return yy(e.As,t.As)||Ey.comparator(e.key,t.key)}}]),e}(),zb=function(){function e(t,n){f(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new Mm(Bb.ds)}return y(e,[{key:"checkEmpty",value:function(e){return Vy.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new h_(i,t,n,r);this.mutationQueue.push(a);var o,u=T(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;this.Rs=this.Rs.add(new Bb(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){u.e(c)}finally{u.f()}return Vy.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Vy.resolve(this.Ps(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.bs(n),i=r<0?0:r;return Vy.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Vy.resolve(0===this.mutationQueue.length?-1:this.vs-1)}},{key:"getAllMutationBatches",value:function(e){return Vy.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Bb(t,0),i=new Bb(t,Number.POSITIVE_INFINITY),a=[];return this.Rs.forEachInRange([r,i],(function(e){var t=n.Ps(e.As);a.push(t)})),Vy.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Mm(yy);return t.forEach((function(e){var t=new Bb(e,0),i=new Bb(e,Number.POSITIVE_INFINITY);n.Rs.forEachInRange([t,i],(function(e){r=r.add(e.As)}))})),Vy.resolve(this.Vs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Ey.isDocumentKey(i)||(i=i.child(""));var a=new Bb(new Ey(i),0),o=new Mm(yy);return this.Rs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)}),a),Vy.resolve(this.Vs(o))}},{key:"Vs",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Ps(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;ty(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();var r=this.Rs;return Vy.forEach(t.mutations,(function(i){var a=new Bb(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.Rs=r}))}},{key:"Cn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Bb(t,0),r=this.Rs.firstAfterOrEqual(n);return Vy.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Vy.resolve()}},{key:"Ss",value:function(e,t){return this.bs(e)}},{key:"bs",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Ps",value:function(e){var t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Wb=function(){function e(t){f(this,e),this.Ds=t,this.docs=new Dm(Ey.comparator),this.size=0}return y(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Vy.resolve(n?n.document.mutableCopy():_g.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=kk();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():_g.newInvalidDocument(e))})),Vy.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=kk(),a=t.path,o=new Ey(a.child("")),u=this.docs.getIteratorFrom(o);u.hasNext();){var s=u.getNext(),c=s.key,l=s.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Oy(Py(l),n)<=0||(r.has(l.key)||dk(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Vy.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){ey()}},{key:"Cs",value:function(e,t){return Vy.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Hb(this)}},{key:"getSize",value:function(e){return Vy.resolve(this.size)}}]),e}(),Hb=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).os=e,r}return y(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.os.addEntry(e,i)):t.os.removeEntry(r)})),Vy.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.os.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.os.getEntries(e,t)}}]),n}(Cb),Kb=function(){function e(t){f(this,e),this.persistence=t,this.xs=new mk((function(e){return Gg(e)}),Qg),this.lastRemoteSnapshotVersion=_y.min(),this.highestTargetId=0,this.Ns=0,this.ks=new qb,this.targetCount=0,this.Ms=yb.kn()}return y(e,[{key:"forEachTarget",value:function(e,t){return this.xs.forEach((function(e,n){return t(n)})),Vy.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Vy.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Vy.resolve(this.Ns)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ms.next(),Vy.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Vy.resolve()}},{key:"Fn",value:function(e){this.xs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ms=new yb(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Fn(t),this.targetCount+=1,Vy.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Fn(t),Vy.resolve()}},{key:"removeTargetData",value:function(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Vy.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.xs.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.xs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),Vy.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Vy.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.xs.get(t)||null;return Vy.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.ks.gs(t,n),Vy.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.ks.ps(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Vy.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.ks.Is(t),Vy.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.ks.Es(t);return Vy.resolve(n)}},{key:"containsKey",value:function(e,t){return Vy.resolve(this.ks.containsKey(t))}}]),e}(),Gb=function(){function e(t,n){var r=this;f(this,e),this.$s={},this.overlays={},this.Os=new $y(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new Kb(this),this.indexManager=new Jw,this.remoteDocumentCache=new Wb((function(e){return r.referenceDelegate.Ls(e)})),this.serializer=new vw(n),this.qs=new Vb(this.serializer)}return y(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Fs=!1,Promise.resolve()}},{key:"started",get:function(){return this.Fs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new jb,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.$s[e.toKey()];return n||(n=new zb(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Xv("MemoryPersistence","Starting transaction:",e);var i=new Qb(this.Os.next());return this.referenceDelegate.Us(),n(i).next((function(e){return r.referenceDelegate.Ks(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Gs",value:function(e,t){return Vy.or(Object.values(this.$s).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),Qb=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return y(n)}(My),Yb=function(){function e(t){f(this,e),this.persistence=t,this.Qs=new qb,this.js=null}return y(e,[{key:"Ws",get:function(){if(this.js)return this.js;throw ey()}},{key:"addReference",value:function(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Vy.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Vy.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ws.add(t.toString()),Vy.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Qs.Is(t.targetId).forEach((function(e){return n.Ws.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ws.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Us",value:function(){this.js=new Set}},{key:"Ks",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Vy.forEach(this.Ws,(function(r){var i=Ey.fromPath(r);return t.Hs(e,i).next((function(e){e||n.removeEntry(i,_y.min())}))})).next((function(){return t.js=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Hs(e,t).next((function(e){e?n.Ws.delete(t.toString()):n.Ws.add(t.toString())}))}},{key:"Ls",value:function(e){return 0}},{key:"Hs",value:function(e,t){var n=this;return Vy.or([function(){return Vy.resolve(n.Qs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Gs(e,t)}])}}],[{key:"zs",value:function(t){return new e(t)}}]),e}(),Xb=function(){function e(t){f(this,e),this.serializer=t}return y(e,[{key:"O",value:function(e,t,n,r){var i=this,a=new jy("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",am,{unique:!0}),e.createObjectStore("documentMutations")}(e),$b(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Vy.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),$b(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_y.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").j().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",am,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return Vy.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Ys(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Xs(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Zs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.ti(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.ei(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:_m});t.createIndex("collectionPathOverlayIndex",wm,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",bm,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:cm});t.createIndex("documentKeyIndex",lm),t.createIndex("collectionGroupIndex",hm)}(e)})).next((function(){return i.ni(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.si(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:ym}).createIndex("sequenceNumberIndex",mm,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:gm}).createIndex("documentKeyIndex",km,{unique:!1})}(e)}))),o}},{key:"Xs",value:function(e){var t=0;return e.store("remoteDocuments").X((function(e,n){t+=lb(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Ys",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next((function(n){return Vy.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",i).next((function(r){return Vy.forEach(r,(function(r){ty(r.userId===n.userId);var i=_w(t.serializer,r);return cb(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"Zs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.X((function(n,i){var a=new by(n),o=function(e){return[0,tm(e)]}(a);r.push(t.get(o).next((function(n){return n?Vy.resolve():function(n){return t.put({targetId:0,path:tm(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return Vy.waitFor(r)}))}))}},{key:"ti",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:vm});var n=t.store("collectionParents"),r=new Zw,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:tm(i)})}};return t.store("remoteDocuments").X({Y:!0},(function(e,t){var n=new by(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").X({Y:!0},(function(e,t){var n=c(e,3),r=(n[0],n[1]),a=(n[2],im(r));return i(a.popLast())}))}))}},{key:"ei",value:function(e){var t=this,n=e.store("targets");return n.X((function(e,r){var i=ww(r),a=bw(t.serializer,i);return n.put(a)}))}},{key:"ni",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.X((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new Ey(by.fromString(i.document.name).popFirst(5)):i.noDocument?Ey.fromSegments(i.noDocument.path):i.unknownDocument?Ey.fromSegments(i.unknownDocument.path):ey()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return Vy.waitFor(r)}))}},{key:"si",value:function(e,t){var n=this,r=t.store("mutations"),i=Rb(this.serializer),a=new Gb(Yb.zs,this.serializer.fe);return r.j().next((function(e){var r=new Map;return e.forEach((function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:Ck();_w(n.serializer,e).keys().forEach((function(e){return i=i.add(e)})),r.set(e.userId,i)})),Vy.forEach(r,(function(e,r){var o=new Kv(r),u=Rw.de(n.serializer,o),s=a.getIndexManager(o),c=hb.de(o,n.serializer,s,a.referenceDelegate);return new Ub(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new Cm(t,$y.ct),e).next()}))}))}}]),e}();function $b(e){e.createObjectStore("targetDocuments",{keyPath:dm}).createIndex("documentTargetsIndex",pm,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",fm,{unique:!0}),e.createObjectStore("targetGlobal")}var Jb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Zb=function(){function e(t,n,r,i,a,o,u,s,c,l){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(f(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.ii=a,this.window=o,this.document=u,this.ri=c,this.oi=l,this.ui=h,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=function(e){return Promise.resolve()},!e.D())throw new iy(ry.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Tb(this,i),this.di=n+"main",this.serializer=new vw(s),this.wi=new qy(this.di,this.ui,new Xb(this.serializer)),this.Bs=new mb(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Rb(this.serializer),this.qs=new Sw,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===l&&$v("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return y(e,[{key:"start",value:function(){var e=this;return this.mi().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new iy(ry.FAILED_PRECONDITION,Jb);return e.gi(),e.yi(),e.pi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Bs.getHighestSequenceNumber(t)}))})).then((function(t){e.Os=new $y(t,e.ri)})).then((function(){e.Fs=!0})).catch((function(t){return e.wi&&e.wi.close(),Promise.reject(t)}))}},{key:"Ii",value:function(e){var t=this;return this.fi=function(){var n=gn(yn().mark((function n(r){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.wi.B(function(){var t=gn(yn().mark((function t(n){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.mi();case 4:case"end":return e.stop()}}),e)})))))}},{key:"mi",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return tx(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.Ti(t).next((function(t){t||(e.isPrimary=!1,e.ii.enqueueRetryable((function(){return e.fi(!1)})))}))})).next((function(){return e.Ei(t)})).next((function(n){return e.isPrimary&&!n?e.Ai(t).next((function(){return!1})):!!n&&e.vi(t).next((function(){return!0}))}))})).catch((function(t){if(Wy(t))return Xv("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Xv("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.ii.enqueueRetryable((function(){return e.fi(t)})),e.isPrimary=t}))}},{key:"Ti",value:function(e){var t=this;return ex(e).get("owner").next((function(e){return Vy.resolve(t.Ri(e))}))}},{key:"Pi",value:function(e){return tx(e).delete(this.clientId)}},{key:"bi",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.Vi(this.li,18e5)){e.next=6;break}return this.li=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=Nm(e,"clientMetadata");return t.j().next((function(e){var n=a.Si(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return Vy.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this._i){n=T(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this._i.removeItem(this.Di(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pi",value:function(){var e=this;this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.mi().then((function(){return e.bi()})).then((function(){return e.pi()}))}))}},{key:"Ri",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"Ei",value:function(e){var t=this;return this.oi?Vy.resolve(!0):ex(e).get("owner").next((function(n){if(null!==n&&t.Vi(n.leaseTimestampMs,5e3)&&!t.Ci(n.ownerId)){if(t.Ri(n)&&t.networkEnabled)return!0;if(!t.Ri(n)){if(!n.allowTabSynchronization)throw new iy(ry.FAILED_PRECONDITION,Jb);return!1}}return!(!t.networkEnabled||!t.inForeground)||tx(e).j().next((function(e){return void 0===t.Si(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Xv("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=gn(yn().mark((function e(){var t=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),e.next=7,this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new Cm(e,$y.ct);return t.Ai(n).next((function(){return t.Pi(n)}))}));case 7:this.wi.close(),this.Mi();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Si",value:function(e,t){var n=this;return e.filter((function(e){return n.Vi(e.updateTimeMs,t)&&!n.Ci(e.clientId)}))}},{key:"$i",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return tx(t).j().next((function(t){return e.Si(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Fs}},{key:"getMutationQueue",value:function(e,t){return hb.de(e,this.serializer,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new tb(e,this.serializer.fe.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return Rw.de(this.serializer,e)}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Xv("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.ui)?Sm:14===i?Tm:13===i?Em:12===i?Im:11===i?xm:void ey();return this.wi.runTransaction(e,o,u,(function(i){return a=new Cm(i,r.Os?r.Os.next():$y.ct),"readwrite-primary"===t?r.Ti(a).next((function(e){return!!e||r.Ei(a)})).next((function(t){if(!t)throw $v("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.ii.enqueueRetryable((function(){return r.fi(!1)})),new iy(ry.FAILED_PRECONDITION,Ly);return n(a)})).next((function(e){return r.vi(a).next((function(){return e}))})):r.Oi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Oi",value:function(e){var t=this;return ex(e).get("owner").next((function(e){if(null!==e&&t.Vi(e.leaseTimestampMs,5e3)&&!t.Ci(e.ownerId)&&!t.Ri(e)&&!(t.oi||t.allowTabSynchronization&&e.allowTabSynchronization))throw new iy(ry.FAILED_PRECONDITION,Jb)}))}},{key:"vi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ex(e).put("owner",t)}},{key:"Ai",value:function(e){var t=this,n=ex(e);return n.get("owner").next((function(e){return t.Ri(e)?(Xv("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Vy.resolve()}))}},{key:"Vi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||($v("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"gi",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=function(){e.ii.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.mi()}))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ni",value:function(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}},{key:"yi",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=function(){t.xi();var e=/(?:Version|Mobile)\/1[456]/;!Ut()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&t.ii.enterRestrictedMode(!0),t.ii.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.ci))}},{key:"ki",value:function(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}},{key:"Ci",value:function(e){var t;try{var n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Xv("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return $v("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"xi",value:function(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){$v("Failed to set zombie client id.",e)}}},{key:"Mi",value:function(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch(e){}}},{key:"Di",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"D",value:function(){return qy.D()}}]),e}();function ex(e){return Nm(e,"owner")}function tx(e){return Nm(e,"clientMetadata")}function nx(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var rx=function(){function e(t,n,r,i){f(this,e),this.targetId=t,this.fromCache=n,this.Fi=r,this.Bi=i}return y(e,null,[{key:"Li",value:function(t,n){var r,i=Ck(),a=Ck(),o=T(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(s){o.e(s)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),ix=function(){function e(){f(this,e),this.qi=!1}return y(e,[{key:"initialize",value:function(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ki(e,t).next((function(a){return a||i.Gi(e,t,r,n)})).next((function(n){return n||i.Qi(e,t)}))}},{key:"Ki",value:function(e,t){var n=this;if(nk(t))return Vy.resolve(null);var r=uk(t);return this.indexManager.getIndexType(e,r).next((function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=ck(t,null,"F"),r=uk(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(i){var a=Ck.apply(void 0,h(i));return n.Ui.getDocuments(e,a).next((function(i){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.ji(t,i);return n.zi(t,o,a,r.readTime)?n.Ki(e,ck(t,null,"F")):n.Wi(e,o,t,r)}))}))})))}))}},{key:"Gi",value:function(e,t,n,r){var i=this;return nk(t)||r.isEqual(_y.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((function(a){var o=i.ji(t,a);return i.zi(t,o,n,r)?i.Qi(e,t):(Yv()<=xn.DEBUG&&Xv("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),fk(t)),i.Wi(e,o,t,Ay(r,-1)))}))}},{key:"ji",value:function(e,t){var n=new Mm(vk(e));return t.forEach((function(t,r){dk(e,r)&&(n=n.add(r))})),n}},{key:"zi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Qi",value:function(e,t){return Yv()<=xn.DEBUG&&Xv("QueryEngine","Using full collection scan to execute query:",fk(t)),this.Ui.getDocumentsMatchingQuery(e,t,Dy.min())}},{key:"Wi",value:function(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),ax=function(){function e(t,n,r,i){f(this,e),this.persistence=t,this.Hi=n,this.serializer=i,this.Ji=new Dm(yy),this.Yi=new mk((function(e){return Gg(e)}),Qg),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(r)}return y(e,[{key:"tr",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ub(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Ji)}))}}]),e}();function ox(e,t,n,r){return new ax(e,t,n,r)}function ux(e,t){return sx.apply(this,arguments)}function sx(){return sx=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(i){return t=i,r.tr(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],u=Ck(),s=T(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,h=T(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;u=u.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){s.e(k)}finally{s.f()}var d,p=T(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var y,m=T(v.mutations);try{for(m.s();!(y=m.n()).done;){var g=y.value;u=u.add(g.key)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){p.e(k)}finally{p.f()}return r.localDocuments.getDocuments(e,u).next((function(e){return{er:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),sx.apply(this,arguments)}function cx(e,t){var n=ny(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Vy.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);ty(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Ck(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function lx(e){var t=ny(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Bs.getLastRemoteSnapshotVersion(e)}))}function hx(e,t){var n=ny(e),r=t.snapshotVersion,i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Bs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Bs.addMatchingKeys(e,a.addedDocuments,u)})));var c=s.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(u)?c=c.withResumeToken(qm.EMPTY_BYTE_STRING,_y.min()).withLastLimboFreeSnapshotVersion(_y.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(u,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&o.push(n.Bs.updateTargetData(e,c))}}));var u=kk(),s=Ck();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(fx(e,a,t.documentUpdates).next((function(e){u=e.nr,s=e.sr}))),!r.isEqual(_y.min())){var c=n.Bs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Vy.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.Ji=i,e}))}function fx(e,t,n){var r=Ck(),i=Ck();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=kk();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(_y.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Xv("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{nr:r,sr:i}}))}function dx(e,t){var n=ny(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function px(e,t){var n=ny(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Bs.getTargetData(e,t).next((function(i){return i?(r=i,Vy.resolve(r)):n.Bs.allocateTargetId(e).next((function(i){return r=new pw(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}function vx(e,t,n){return yx.apply(this,arguments)}function yx(){return yx=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ny(t),a=i.Ji.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Wy(e.t1)){e.next=12;break}throw e.t1;case 12:Xv("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.Ji=i.Ji.remove(n),i.Yi.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),yx.apply(this,arguments)}function mx(e,t,n){var r=ny(e),i=_y.min(),a=Ck();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=ny(e),i=r.Yi.get(n);return void 0!==i?Vy.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,uk(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Hi.getDocumentsMatchingQuery(e,t,n?i:_y.min(),n?a:Ck())})).next((function(e){return _x(r,pk(t),e),{documents:e,ir:a}}))}))}function gx(e,t){var n=ny(e),r=ny(n.Bs),i=n.Ji.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.le(e,t).next((function(e){return e?e.target:null}))}))}function kx(e,t){var n=ny(e),r=n.Xi.get(t)||_y.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Zi.getAllFromCollectionGroup(e,t,Ay(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return _x(n,t,e),e}))}function _x(e,t,n){var r=e.Xi.get(t)||_y.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}function wx(e,t,n,r){return bx.apply(this,arguments)}function bx(){return bx=gn(yn().mark((function e(t,n,r,i){var a,o,u,s,c,l,h,f,d,p;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=ny(t),o=Ck(),u=kk(),s=T(r);try{for(s.s();!(c=s.n()).done;)l=c.value,h=n.rr(l.metadata.name),l.document&&(o=o.add(h)),(f=n.ur(l)).setReadTime(n.cr(l.metadata.readTime)),u=u.insert(h,f)}catch(v){s.e(v)}finally{s.f()}return d=a.Zi.newChangeBuffer({trackRemovals:!0}),e.next=7,px(a,function(e){return uk(tk(by.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return p=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return fx(e,d,u).next((function(t){return d.apply(e),t})).next((function(t){return a.Bs.removeMatchingKeysForTargetId(e,p.targetId).next((function(){return a.Bs.addMatchingKeys(e,o,p.targetId)})).next((function(){return a.localDocuments.getLocalViewOfDocuments(e,t.nr,t.sr)})).next((function(){return t.nr}))}))})));case 9:case"end":return e.stop()}}),e)}))),bx.apply(this,arguments)}function xx(e,t){return Ix.apply(this,arguments)}function Ix(){return Ix=gn(yn().mark((function e(t,n){var r,i,a,o=arguments;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:Ck(),e.next=3,px(t,uk(xw(n.bundledQuery)));case 3:return i=e.sent,a=ny(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=B_(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.qs.saveNamedQuery(e,n);var o=i.withResumeToken(qm.EMPTY_BYTE_STRING,t);return a.Ji=a.Ji.insert(o.targetId,o),a.Bs.updateTargetData(e,o).next((function(){return a.Bs.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.Bs.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.qs.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),Ix.apply(this,arguments)}function Ex(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Tx(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function Sx(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var Cx=function(){function e(t,n,r,i){f(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return y(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new iy(a.error.code,a.error.message))),o?new e(t,n,a.state,i):($v("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),Nx=function(){function e(t,n,r){f(this,e),this.targetId=t,this.state=n,this.error=r}return y(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new iy(i.error.code,i.error.message))),a?new e(t,i.state,r):($v("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),Rx=function(){function e(t,n){f(this,e),this.clientId=t,this.activeTargetIds=n}return y(e,null,[{key:"ar",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Rk(),o=0;i&&o<r.activeTargetIds.length;++o)i=em(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):($v("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),Ax=function(){function e(t,n){f(this,e),this.clientId=t,this.onlineState=n}return y(e,null,[{key:"ar",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):($v("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),Px=function(){function e(){f(this,e),this.activeTargetIds=Rk()}return y(e,[{key:"lr",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"dr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"hr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),Dx=function(){function e(t,n,r,i,a){f(this,e),this.window=t,this.ii=n,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Dm(yy),this.started=!1,this.yr=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.pr=Ex(this.persistenceKey,this.wr),this.Ir=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new Px),this.Tr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.Er=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.Ar=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.vr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Rr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this._r)}return y(e,[{key:"start",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a,o,u,s,c,l,h,f=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.$i();case 2:t=e.sent,n=T(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.wr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(Ex(this.persistenceKey,i)))&&(o=Rx.ar(i,a))&&(this.gr=this.gr.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.Pr(),(u=this.storage.getItem(this.vr))&&(s=this.br(u))&&this.Vr(s),c=T(this.yr);try{for(c.s();!(l=c.n()).done;)h=l.value,this.mr(h)}catch(d){c.e(d)}finally{c.f()}this.yr=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.Ir,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Sr(this.gr)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.gr.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Dr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Dr(e,t,n),this.Cr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Sx(this.persistenceKey,e));if(n){var r=Nx.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Nr.dr(e),this.Pr()}},{key:"isLocalQueryTarget",value:function(e){return this.Nr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(Sx(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.kr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Cr(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.Mr(e)}},{key:"notifyBundleLoaded",value:function(e){this.$r(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Xv("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Xv("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Xv("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"mr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Xv("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void $v("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(gn(yn().mark((function e(){var r,i,a,o,u,s,c;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.Tr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Or(n.key),e.abrupt("return",t.Fr(r,null));case 6:if(!(i=t.Br(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Fr(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.Er.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Lr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.qr(a));case 16:e.next=41;break;case 18:if(!t.Ar.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.Ur(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Kr(o));case 23:e.next=41;break;case 25:if(n.key!==t.vr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.br(n.newValue))){e.next=30;break}return e.abrupt("return",t.Vr(u));case 30:e.next=41;break;case 32:if(n.key!==t.Ir){e.next=37;break}s=function(e){var t=$y.ct;if(null!=e)try{var n=JSON.parse(e);ty("number"==typeof n),t=n}catch(e){$v("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),s!==$y.ct&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.Rr){e.next=41;break}return c=t.Gr(n.newValue),e.next=41,Promise.all(c.map((function(e){return t.syncEngine.Qr(e)})));case 41:e.next=44;break;case 43:t.yr.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Nr",get:function(){return this.gr.get(this.wr)}},{key:"Pr",value:function(){this.setItem(this.pr,this.Nr.hr())}},{key:"Dr",value:function(e,t,n){var r=new Cx(this.currentUser,e,t,n),i=Tx(this.persistenceKey,this.currentUser,e);this.setItem(i,r.hr())}},{key:"Cr",value:function(e){var t=Tx(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Mr",value:function(e){var t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}},{key:"kr",value:function(e,t,n){var r=Sx(this.persistenceKey,e),i=new Nx(e,t,n);this.setItem(r,i.hr())}},{key:"$r",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}},{key:"Or",value:function(e){var t=this.Tr.exec(e);return t?t[1]:null}},{key:"Br",value:function(e,t){var n=this.Or(e);return Rx.ar(n,t)}},{key:"Lr",value:function(e,t){var n=this.Er.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Cx.ar(new Kv(i),r,t)}},{key:"Ur",value:function(e,t){var n=this.Ar.exec(e),r=Number(n[1]);return Nx.ar(r,t)}},{key:"br",value:function(e){return Ax.ar(e)}},{key:"Gr",value:function(e){return JSON.parse(e)}},{key:"qr",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.jr(t.batchId,t.state,t.error));case 2:Xv("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Kr",value:function(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}},{key:"Fr",value:function(e,t){var n=this,r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),a=this.Sr(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Wr(o,u).then((function(){n.gr=r}))}},{key:"Vr",value:function(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Sr",value:function(e){var t=Rk();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"D",value:function(e){return!(!e||!e.localStorage)}}]),e}(),Ox=function(){function e(){f(this,e),this.Hr=new Px,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return y(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Jr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Hr.dr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Jr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Hr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Hr=new Px,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),Lx=function(){function e(){f(this,e)}return y(e,[{key:"Yr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),Mx=function(){function e(){var t=this;f(this,e),this.Xr=function(){return t.Zr()},this.eo=function(){return t.no()},this.so=[],this.io()}return y(e,[{key:"Yr",value:function(e){this.so.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}},{key:"io",value:function(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}},{key:"Zr",value:function(){Xv("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=T(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"no",value:function(){Xv("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=T(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),Fx=null;function Ux(){return null===Fx?Fx=268435456+Math.round(2147483648*Math.random()):Fx++,"0x"+Fx.toString(16)}var Vx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},jx=function(){function e(t){f(this,e),this.ro=t.ro,this.oo=t.oo}return y(e,[{key:"uo",value:function(e){this.co=e}},{key:"ao",value:function(e){this.ho=e}},{key:"onMessage",value:function(e){this.lo=e}},{key:"close",value:function(){this.oo()}},{key:"send",value:function(e){this.ro(e)}},{key:"fo",value:function(){this.co()}},{key:"wo",value:function(e){this.ho(e)}},{key:"_o",value:function(e){this.lo(e)}}]),e}(),qx="WebChannelConnection",Bx=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r.longPollingOptions=e.longPollingOptions,r}return y(n,[{key:"Ao",value:function(e,t,n,r){var i=Ux();return new Promise((function(a,o){var u=new Bv;u.setWithCredentials(!0),u.listenOnce(Fv.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case Mv.NO_ERROR:var t=u.getResponseJson();Xv(qx,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case Mv.TIMEOUT:Xv(qx,"RPC '".concat(e,"' ").concat(i," timed out")),o(new iy(ry.DEADLINE_EXCEEDED,"Request time out"));break;case Mv.HTTP_ERROR:var n=u.getStatus();if(Xv(qx,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson();Array.isArray(r)&&(r=r[0]);var s=null==r?void 0:r.error;if(s&&s.status&&s.message){var c=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(ry).indexOf(t)>=0?t:ry.UNKNOWN}(s.status);o(new iy(c,s.message))}else o(new iy(ry.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new iy(ry.UNAVAILABLE,"Connection failed."));break;default:ey()}}finally{Xv(qx,"RPC '".concat(e,"' ").concat(i," completed."))}}));var s=JSON.stringify(r);Xv(qx,"RPC '".concat(e,"' ").concat(i," sending request:"),r),u.send(t,"POST",s,n,15)}))}},{key:"Ro",value:function(e,t,n){var r=Ux(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Ov(),o=Lv(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},s=this.longPollingOptions.timeoutSeconds;void 0!==s&&(u.longPollingTimeout=Math.round(1e3*s)),this.useFetchStreams&&(u.xmlHttpFactory=new jv({})),this.Eo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;var c=i.join("");Xv(qx,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),u);var l=a.createWebChannel(c,u),h=!1,f=!1,d=new jx({ro:function(t){f?Xv(qx,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Xv(qx,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),h=!0),Xv(qx,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},oo:function(){return l.close()}}),p=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return p(l,qv.EventType.OPEN,(function(){f||Xv(qx,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(l,qv.EventType.CLOSE,(function(){f||(f=!0,Xv(qx,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.wo())})),p(l,qv.EventType.ERROR,(function(t){f||(f=!0,Jv(qx,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),d.wo(new iy(ry.UNAVAILABLE,"The operation could not be completed")))})),p(l,qv.EventType.MESSAGE,(function(t){var n;if(!f){var i=t.data[0];ty(!!i);var a=i,o=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(o){Xv(qx,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);var u=o.status,s=function(e){var t=u_[e];if(void 0!==t)return y_(t)}(u),c=o.message;void 0===s&&(s=ry.INTERNAL,c="Unknown error status: "+u+" with message "+o.message),f=!0,d.wo(new iy(s,c)),l.close()}else Xv(qx,"RPC '".concat(e,"' stream ").concat(r," received:"),i),d._o(i)}})),p(o,Uv.STAT_EVENT,(function(t){t.stat===Vv.PROXY?Xv(qx,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Vv.NOPROXY&&Xv(qx,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){d.fo()}),0),d}}]),n}(function(){function e(t){f(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.mo=n+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return y(e,[{key:"po",get:function(){return!1}},{key:"Io",value:function(e,t,n,r,i){var a=Ux(),o=this.To(e,t);Xv("RestConnection","Sending RPC '".concat(e,"' ").concat(a,":"),o,n);var u={};return this.Eo(u,r,i),this.Ao(e,o,u,n).then((function(t){return Xv("RestConnection","Received RPC '".concat(e,"' ").concat(a,": "),t),t}),(function(t){throw Jv("RestConnection","RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",o,"request:",n),t}))}},{key:"vo",value:function(e,t,n,r,i,a){return this.Io(e,t,n,r,i)}},{key:"Eo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Gv,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"To",value:function(e,t){var n=Vx[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}]),e}());function zx(){return"undefined"!=typeof window?window:null}function Wx(){return"undefined"!=typeof document?document:null}function Hx(e){return new F_(e,!0)}var Kx=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;f(this,e),this.ii=t,this.timerId=n,this.Po=r,this.bo=i,this.Vo=a,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}return y(e,[{key:"reset",value:function(){this.So=0}},{key:"xo",value:function(){this.So=this.Vo}},{key:"No",value:function(e){var t=this;this.cancel();var n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,n-r);i>0&&Xv("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(function(){return t.Co=Date.now(),e()})),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}},{key:"Mo",value:function(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}},{key:"cancel",value:function(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"ko",value:function(){return(Math.random()-.5)*this.So}}]),e}(),Gx=function(){function e(t,n,r,i,a,o,u,s){f(this,e),this.ii=t,this.$o=r,this.Oo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=s,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Kx(t,n)}return y(e,[{key:"Uo",value:function(){return 1===this.state||5===this.state||this.Ko()}},{key:"Ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Go()}},{key:"stop",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Uo(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Qo",value:function(){this.state=0,this.qo.reset()}},{key:"jo",value:function(){var e=this;this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(function(){return e.zo()})))}},{key:"Wo",value:function(e){this.Ho(),this.stream.send(e)}},{key:"zo",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ho",value:function(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}},{key:"Jo",value:function(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}},{key:"close",value:function(){var e=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():n&&n.code===ry.RESOURCE_EXHAUSTED?($v(n.toString()),$v("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===ry.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.ao(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Yo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=c(t,2),i=r[0],a=r[1];e.Fo===n&&e.Zo(i,a)}),(function(n){t((function(){var t=new iy(ry.UNKNOWN,"Fetching auth token failed: "+n.message);return e.tu(t)}))}))}},{key:"Zo",value:function(e,t){var n=this,r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((function(){r((function(){return n.state=2,n.Lo=n.ii.enqueueAfterDelay(n.Oo,1e4,(function(){return n.Ko()&&(n.state=3),Promise.resolve()})),n.listener.uo()}))})),this.stream.ao((function(e){r((function(){return n.tu(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Go",value:function(){var e=this;this.state=5,this.qo.No(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"tu",value:function(e){return Xv("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Xo",value:function(e){var t=this;return function(n){t.ii.enqueueAndForget((function(){return t.Fo===e?n():(Xv("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),Qx=function(e){g(n,e);var t=b(n);function n(e,r,i,a,o,u){var s;return f(this,n),(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,u)).serializer=o,s}return y(n,[{key:"eu",value:function(e,t){return this.connection.Ro("Listen",e,t)}},{key:"onMessage",value:function(e){this.qo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ey()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(ty(void 0===t||"string"==typeof t),qm.fromBase64String(t||"")):(ty(void 0===t||t instanceof Uint8Array),qm.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?ry.UNKNOWN:y_(e.code);return new iy(t,e.message||"")}(o);n=new N_(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=K_(e,s.document.name),l=B_(s.document.updateTime),h=s.document.createTime?B_(s.document.createTime):_y.min(),f=new gg({mapValue:{fields:s.document.fields}}),d=_g.newFoundDocument(c,l,h,f),p=s.targetIds||[],v=s.removedTargetIds||[];n=new S_(p,v,d.key,d)}else if("documentDelete"in t){t.documentDelete;var y=t.documentDelete;y.document;var m=K_(e,y.document),g=y.readTime?B_(y.readTime):_y.min(),k=_g.newNoDocument(m,g),_=y.removedTargetIds||[];n=new S_([],_,k.key,k)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=K_(e,w.document),x=w.removedTargetIds||[];n=new S_([],x,b,null)}else{if(!("filter"in t))return ey();t.filter;var I=t.filter;I.targetId;var E=I.count,T=void 0===E?0:E,S=I.unchangedNames,C=new p_(T,S),N=I.targetId;n=new C_(N,C)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return _y.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?_y.min():t.readTime?B_(t.readTime):_y.min()}(e);return this.listener.nu(t,n)}},{key:"su",value:function(e){var t={};t.database=Y_(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=Yg(r)?{documents:nw(e,r)}:{query:rw(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=j_(e,t.resumeToken);var i=U_(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(_y.min())>0){n.readTime=V_(e,t.snapshotVersion.toTimestamp());var a=U_(e,t.expectedCount);null!==a&&(n.expectedCount=a)}return n}(this.serializer,e);var n=function(e,t){var n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ey()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}},{key:"iu",value:function(e){var t={};t.database=Y_(this.serializer),t.removeTarget=e,this.Wo(t)}}]),n}(Gx),Yx=function(e){g(n,e);var t=b(n);function n(e,r,i,a,o,u){var s;return f(this,n),(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,u)).serializer=o,s.ru=!1,s}return y(n,[{key:"ou",get:function(){return this.ru}},{key:"start",value:function(){this.ru=!1,this.lastStreamToken=void 0,Qr(k(n.prototype),"start",this).call(this)}},{key:"Yo",value:function(){this.ru&&this.uu([])}},{key:"eu",value:function(e,t){return this.connection.Ro("Write",e,t)}},{key:"onMessage",value:function(e){if(ty(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();var t=function(e,t){return e&&e.length>0?(ty(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?B_(e.updateTime):B_(t);return n.isEqual(_y.min())&&(n=B_(t)),new Gk(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=B_(e.commitTime);return this.listener.cu(n,t)}return ty(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}},{key:"hu",value:function(){var e={};e.database=Y_(this.serializer),this.Wo(e)}},{key:"uu",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return ew(t.serializer,e)}))};this.Wo(n)}}]),n}(Gx),Xx=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o;return f(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=i,o.serializer=a,o.lu=!1,o}return y(n,[{key:"fu",value:function(){if(this.lu)throw new iy(ry.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Io",value:function(e,t,n){var r=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=c(i,2),o=a[0],u=a[1];return r.connection.Io(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ry.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new iy(ry.UNKNOWN,e.toString())}))}},{key:"vo",value:function(e,t,n,r){var i=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=c(a,2),u=o[0],s=o[1];return i.connection.vo(e,t,n,u,s,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ry.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new iy(ry.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.lu=!0}}]),n}(function(){return y((function e(){f(this,e)}))}());var $x=function(){function e(t,n){f(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}return y(e,[{key:"gu",value:function(){var e=this;0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e._u=null,e.pu("Backend didn't respond within 10 seconds."),e.yu("Offline"),Promise.resolve()})))}},{key:"Iu",value:function(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.yu("Offline")))}},{key:"set",value:function(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}},{key:"yu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"pu",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?($v(t),this.mu=!1):Xv("OnlineStateTracker",t)}},{key:"Tu",value:function(){null!==this._u&&(this._u.cancel(),this._u=null)}}]),e}(),Jx=y((function e(t,n,r,i,a){var o=this;f(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=a,this.Pu.Yr((function(e){r.enqueueAndForget(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=cI(o),!e.t0){e.next=5;break}return Xv("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=ny(t)).vu.add(4),e.next=4,tI(n);case 4:return n.bu.set("Unknown"),n.vu.delete(4),e.next=8,Zx(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this.bu=new $x(r,i)}));function Zx(e){return eI.apply(this,arguments)}function eI(){return(eI=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!cI(t)){e.next=18;break}n=T(t.Ru),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))).apply(this,arguments)}function tI(e){return nI.apply(this,arguments)}function nI(){return(nI=gn(yn().mark((function e(t){var n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=T(t.Ru),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}function rI(e,t){var n=ny(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),sI(n)?uI(n):UI(n).Ko()&&aI(n,t))}function iI(e,t){var n=ny(e),r=UI(n);n.Au.delete(t),r.Ko()&&oI(n,t),0===n.Au.size&&(r.Ko()?r.jo():cI(n)&&n.bu.set("Unknown"))}function aI(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(_y.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}UI(e).su(t)}function oI(e,t){e.Vu.qt(t),UI(e).iu(t)}function uI(e){e.Vu=new A_({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},le:function(t){return e.Au.get(t)||null},ue:function(){return e.datastore.serializer.databaseId}}),UI(e).start(),e.bu.gu()}function sI(e){return cI(e)&&!UI(e).Uo()&&e.Au.size>0}function cI(e){return 0===ny(e).vu.size}function lI(e){e.Vu=void 0}function hI(e){return fI.apply(this,arguments)}function fI(){return(fI=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.Au.forEach((function(e,n){aI(t,e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dI(e,t){return pI.apply(this,arguments)}function pI(){return(pI=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:lI(t),sI(t)?(t.bu.Iu(n),uI(t)):t.bu.set("Unknown");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vI(e,t,n){return yI.apply(this,arguments)}function yI(){return yI=gn(yn().mark((function e(t,n,r){var i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.bu.set("Online"),!(n instanceof N_&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=T(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.Au.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Au.delete(o),t.Vu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Xv("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,mI(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof S_?t.Vu.Ht(n):n instanceof C_?t.Vu.ne(n):t.Vu.Xt(n),r.isEqual(_y.min())){e.next=29;break}return e.prev=14,e.next=17,lx(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Vu.ce(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t,n){var r=e.Au.get(t);if(r){e.Au.set(t,r.withResumeToken(qm.EMPTY_BYTE_STRING,r.snapshotVersion)),oI(e,t);var i=new pw(r.target,t,n,r.sequenceNumber);aI(e,i)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Xv("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,mI(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),yI.apply(this,arguments)}function mI(e,t,n){return gI.apply(this,arguments)}function gI(){return(gI=gn(yn().mark((function e(t,n,r){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Wy(n)){e.next=2;break}throw n;case 2:return t.vu.add(1),e.next=5,tI(t);case 5:t.bu.set("Offline"),r||(r=function(){return lx(t.localStore)}),t.asyncQueue.enqueueRetryable(gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xv("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.vu.delete(1),e.next=6,Zx(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kI(e,t){return t().catch((function(n){return mI(e,n,t)}))}function _I(e){return wI.apply(this,arguments)}function wI(){return(wI=gn(yn().mark((function e(t){var n,r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ny(t),r=VI(n),i=n.Eu.length>0?n.Eu[n.Eu.length-1].batchId:-1;case 2:if(!bI(n)){e.next=19;break}return e.prev=3,e.next=6,dx(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Eu.length&&r.jo(),e.abrupt("break",19);case 10:i=a.batchId,xI(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,mI(n,e.t0);case 17:e.next=2;break;case 19:II(n)&&EI(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function bI(e){return cI(e)&&e.Eu.length<10}function xI(e,t){e.Eu.push(t);var n=VI(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function II(e){return cI(e)&&!VI(e).Uo()&&e.Eu.length>0}function EI(e){VI(e).start()}function TI(e){return SI.apply(this,arguments)}function SI(){return(SI=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:VI(t).hu();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CI(e){return NI.apply(this,arguments)}function NI(){return(NI=gn(yn().mark((function e(t){var n,r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=VI(t),r=T(t.Eu);try{for(r.s();!(i=r.n()).done;)a=i.value,n.uu(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function RI(e,t,n){return AI.apply(this,arguments)}function AI(){return(AI=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Eu.shift(),a=f_.from(i,n,r),e.next=3,kI(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,_I(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function PI(e,t){return DI.apply(this,arguments)}function DI(){return DI=gn(yn().mark((function e(t,n){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&VI(t).ou,!e.t0){e.next=4;break}return e.next=4,function(){var e=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v_(i=n.code)||i===ry.ABORTED){e.next=7;break}return r=t.Eu.shift(),VI(t).Qo(),e.next=5,kI(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,_I(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:II(t)&&EI(t);case 5:case"end":return e.stop()}}),e)}))),DI.apply(this,arguments)}function OI(e,t){return LI.apply(this,arguments)}function LI(){return(LI=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=ny(t)).asyncQueue.verifyOperationInProgress(),Xv("RemoteStore","RemoteStore received new credentials"),i=cI(r),r.vu.add(3),e.next=6,tI(r);case 6:return i&&r.bu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.vu.delete(3),e.next=12,Zx(r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function MI(e,t){return FI.apply(this,arguments)}function FI(){return(FI=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ny(t),!n){e.next=7;break}return r.vu.delete(2),e.next=5,Zx(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.vu.add(2),e.next=12,tI(r);case 12:r.bu.set("Unknown");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function UI(e){return e.Su||(e.Su=function(e,t,n){var r=ny(e);return r.fu(),new Qx(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:hI.bind(null,e),ao:dI.bind(null,e),nu:vI.bind(null,e)}),e.Ru.push(function(){var t=gn(yn().mark((function t(n){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Su.Qo(),sI(e)?uI(e):e.bu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Su.stop();case 6:lI(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Su}function VI(e){return e.Du||(e.Du=function(e,t,n){var r=ny(e);return r.fu(),new Yx(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:TI.bind(null,e),ao:PI.bind(null,e),au:CI.bind(null,e),cu:RI.bind(null,e)}),e.Ru.push(function(){var t=gn(yn().mark((function t(n){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Du.Qo(),t.next=4,_I(e);case 4:t.next=9;break;case 6:return t.next=8,e.Du.stop();case 8:e.Eu.length>0&&(Xv("RemoteStore","Stopping write stream with ".concat(e.Eu.length," pending writes")),e.Eu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Du}var jI=function(){function e(t,n,r,i,a){f(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new ay,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return y(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new iy(ry.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function qI(e,t){if($v("AsyncQueue","".concat(t,": ").concat(e)),Wy(e))return new iy(ry.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var BI=function(){function e(t){f(this,e),this.comparator=t?function(e,n){return t(e,n)||Ey.comparator(e.key,n.key)}:function(e,t){return Ey.comparator(e.key,t.key)},this.keyedMap=wk(),this.sortedSet=new Dm(this.comparator)}return y(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),zI=function(){function e(){f(this,e),this.Cu=new Dm(Ey.comparator)}return y(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):ey():this.Cu=this.Cu.insert(t,e)}},{key:"xu",value:function(){var e=[];return this.Cu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),WI=function(){function e(t,n,r,i,a,o,u,s,c){f(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=s,this.hasCachedResults=c}return y(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lk(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,BI.emptySet(n),o,r,i,!0,!1,a)}}]),e}(),HI=y((function e(){f(this,e),this.Nu=void 0,this.listeners=[]})),KI=y((function e(){f(this,e),this.queries=new mk((function(e){return hk(e)}),lk),this.onlineState="Unknown",this.ku=new Set}));function GI(e,t){return QI.apply(this,arguments)}function QI(){return QI=gn(yn().mark((function e(t,n){var r,i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ny(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new HI),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Nu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=qI(e.t0,"Initialization of query '".concat(fk(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,o),o.listeners.push(n),n.Mu(r.onlineState),o.Nu&&n.$u(o.Nu)&&ZI(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),QI.apply(this,arguments)}function YI(e,t){return XI.apply(this,arguments)}function XI(){return XI=gn(yn().mark((function e(t,n){var r,i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ny(t),i=n.query,a=!1,(o=r.queries.get(i))&&(u=o.listeners.indexOf(n))>=0&&(o.listeners.splice(u,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)}))),XI.apply(this,arguments)}function $I(e,t){var n,r=ny(e),i=!1,a=T(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,s=r.queries.get(u);if(s){var c,l=T(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.$u(o)&&(i=!0)}}catch(h){l.e(h)}finally{l.f()}s.Nu=o}}}catch(h){a.e(h)}finally{a.f()}i&&ZI(r)}function JI(e,t,n){var r=ny(e),i=r.queries.get(t);if(i){var a,o=T(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(t)}function ZI(e){e.ku.forEach((function(e){e.next()}))}var eE=function(){function e(t,n,r){f(this,e),this.query=t,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}return y(e,[{key:"$u",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=T(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new WI(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),a=!0):this.qu(e,this.onlineState)&&(this.Uu(e),a=!0),this.Bu=e,a}},{key:"onError",value:function(e){this.Ou.error(e)}},{key:"Mu",value:function(e){this.onlineState=e;var t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}},{key:"qu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Lu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Uu",value:function(e){e=WI.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}]),e}(),tE=function(){function e(t,n){f(this,e),this.Gu=t,this.byteLength=n}return y(e,[{key:"Qu",value:function(){return"metadata"in this.Gu}}]),e}(),nE=function(){function e(t){f(this,e),this.serializer=t}return y(e,[{key:"rr",value:function(e){return K_(this.serializer,e)}},{key:"ur",value:function(e){return e.metadata.exists?J_(this.serializer,e.document,!1):_g.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}},{key:"cr",value:function(e){return B_(e)}}]),e}(),rE=function(){function e(t,n,r){f(this,e),this.ju=t,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=iE(t)}return y(e,[{key:"zu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;var n=by.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"Wu",value:function(e){var t,n=new Map,r=new nE(this.serializer),i=T(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,u=r.rr(a.metadata.name),s=T(a.metadata.queries);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(n.get(c)||Ck()).add(u);n.set(c,l)}}catch(h){s.e(h)}finally{s.f()}}}}catch(h){i.e(h)}finally{i.f()}return n}},{key:"complete",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wx(this.localStore,new nE(this.serializer),this.documents,this.ju.id);case 2:t=e.sent,n=this.Wu(this.documents),r=T(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,xx(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function iE(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var aE=y((function e(t){f(this,e),this.key=t})),oE=y((function e(t){f(this,e),this.key=t})),uE=function(){function e(t,n){f(this,e),this.query=t,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Ck(),this.mutatedKeys=Ck(),this.tc=vk(t),this.ec=new BI(this.tc)}return y(e,[{key:"nc",get:function(){return this.Yu}},{key:"sc",value:function(e,t){var n=this,r=t?t.ic:new zI,i=t?t.ec:this.ec,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=dk(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.rc(l,h)||(r.track({type:2,doc:h}),p=!0,(s&&n.tc(h,s)>0||c&&n.tc(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(s||c)&&(u=!0)),p&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{ec:o,ic:r,zi:u,mutatedKeys:a}}},{key:"rc",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;var a=e.ic.xu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ey()}};return n(e)-n(t)}(e.type,t.type)||r.tc(e.doc,t.doc)})),this.oc(n);var o=t?this.uc():[],u=0===this.Zu.size&&this.current?1:0,s=u!==this.Xu;return this.Xu=u,0!==a.length||s?{snapshot:new WI(this.query,e.ec,i,a,e.mutatedKeys,0===u,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}},{key:"Mu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new zI,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}},{key:"ac",value:function(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}},{key:"oc",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Yu=t.Yu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Yu=t.Yu.delete(e)})),this.current=e.current)}},{key:"uc",value:function(){var e=this;if(!this.current)return[];var t=this.Zu;this.Zu=Ck(),this.ec.forEach((function(t){e.ac(t.key)&&(e.Zu=e.Zu.add(t.key))}));var n=[];return t.forEach((function(t){e.Zu.has(t)||n.push(new oE(t))})),this.Zu.forEach((function(e){t.has(e)||n.push(new aE(e))})),n}},{key:"hc",value:function(e){this.Yu=e.ir,this.Zu=Ck();var t=this.sc(e.documents);return this.applyChanges(t,!0)}},{key:"lc",value:function(){return WI.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}]),e}(),sE=y((function e(t,n,r){f(this,e),this.query=t,this.targetId=n,this.view=r})),cE=y((function e(t){f(this,e),this.key=t,this.fc=!1})),lE=function(){function e(t,n,r,i,a,o){f(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new mk((function(e){return hk(e)}),lk),this._c=new Map,this.mc=new Set,this.gc=new Dm(Ey.comparator),this.yc=new Map,this.Ic=new qb,this.Tc={},this.Ec=new Map,this.Ac=yb.Mn(),this.onlineState="Unknown",this.vc=void 0}return y(e,[{key:"isPrimaryClient",get:function(){return!0===this.vc}}]),e}();function hE(e,t){return fE.apply(this,arguments)}function fE(){return fE=gn(yn().mark((function e(t,n){var r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=iT(t),!(o=r.wc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.lc(),e.next=15;break;case 6:return e.next=8,px(r.localStore,uk(n));case 8:return u=e.sent,s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=13,dE(r,n,i,"current"===s,u.resumeToken);case 13:a=e.sent,r.isPrimaryClient&&rI(r.remoteStore,u);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)}))),fE.apply(this,arguments)}function dE(e,t,n,r,i){return pE.apply(this,arguments)}function pE(){return pE=gn(yn().mark((function e(t,n,r,i,a){var o,u,s,c,l,h;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Rc=function(e,n,r){return function(){var e=gn(yn().mark((function e(t,n,r,i){var a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.sc(r),e.t0=a.zi,!e.t0){e.next=6;break}return e.next=5,mx(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.sc(t,a)}));case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(OE(t,n.targetId,u.cc),u.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,mx(t.localStore,n,!0);case 3:return o=e.sent,u=new uE(n,o.ir),s=u.sc(o.documents),c=T_.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),l=u.applyChanges(s,t.isPrimaryClient,c),OE(t,r,l.cc),h=new sE(n,r,u),e.abrupt("return",(t.wc.set(n,h),t._c.has(r)?t._c.get(r).push(n):t._c.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}}),e)}))),pE.apply(this,arguments)}function vE(e,t){return yE.apply(this,arguments)}function yE(){return(yE=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ny(t),i=r.wc.get(n),!((a=r._c.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r._c.set(i.targetId,a.filter((function(e){return!lk(e,n)}))),void r.wc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,vx(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),iI(r.remoteStore,i.targetId),PE(r,i.targetId)})).catch(Fy);case 9:e.next=14;break;case 11:return PE(r,i.targetId),e.next=14,vx(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mE(e,t,n){return gE.apply(this,arguments)}function gE(){return gE=gn(yn().mark((function e(t,n,r){var i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=aT(t),e.prev=1,e.next=4,function(e,t){var n,r,i=ny(e),a=ky.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Ck());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var u=kk(),s=Ck();return i.Zi.getEntries(e,o).next((function(e){(u=e).forEach((function(e,t){t.isValidDocument()||(s=s.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,u)})).next((function(r){n=r;var o,u=[],s=T(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=e_(c,n.get(c.key).overlayedDocument);null!=l&&u.push(new r_(c.key,l,kg(l.value.mapValue),Qk.exists(!0)))}}catch(h){s.e(h)}finally{s.f()}return i.mutationQueue.addMutationBatch(e,a,u,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:bk(n)}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.Tc[e.currentUser.toKey()];r||(r=new Dm(yy)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,FE(i,a.changes);case 9:return e.next=11,_I(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=qI(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),gE.apply(this,arguments)}function kE(e,t){return _E.apply(this,arguments)}function _E(){return(_E=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),e.prev=1,e.next=4,hx(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.yc.get(t);n&&(ty(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.fc=!0:e.modifiedDocuments.size>0?ty(n.fc):e.removedDocuments.size>0&&(ty(n.fc),n.fc=!1))})),e.next=8,FE(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Fy(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function wE(e,t,n){var r=ny(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.wc.forEach((function(e,n){var r=n.view.Mu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=ny(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=T(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Mu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&ZI(n)}(r.eventManager,t),i.length&&r.dc.nu(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function bE(e,t,n){return xE.apply(this,arguments)}function xE(){return xE=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,c;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=ny(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.yc.get(n),!(o=a&&a.key)){e.next=14;break}return u=(u=new Dm(Ey.comparator)).insert(o,_g.newNoDocument(o,_y.min())),s=Ck().add(o),c=new E_(_y.min(),new Map,new Dm(yy),u,s),e.next=9,kE(i,c);case 9:i.gc=i.gc.remove(o),i.yc.delete(n),ME(i),e.next=16;break;case 14:return e.next=16,vx(i.localStore,n,!1).then((function(){return PE(i,n,r)})).catch(Fy);case 16:case"end":return e.stop()}}),e)}))),xE.apply(this,arguments)}function IE(e,t){return EE.apply(this,arguments)}function EE(){return(EE=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),i=n.batch.batchId,e.prev=1,e.next=4,cx(r.localStore,n);case 4:return a=e.sent,AE(r,i,null),RE(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,FE(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Fy(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function TE(e,t,n){return SE.apply(this,arguments)}function SE(){return(SE=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ny(t),e.prev=1,e.next=4,function(e,t){var n=ny(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return ty(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,AE(i,n,r),RE(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,FE(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Fy(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function CE(e,t){return NE.apply(this,arguments)}function NE(){return(NE=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return cI((r=ny(t)).remoteStore)||Xv("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=ny(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.Ec.get(i)||[]).push(n),r.Ec.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=qI(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function RE(e,t){(e.Ec.get(t)||[]).forEach((function(e){e.resolve()})),e.Ec.delete(t)}function AE(e,t,n){var r=ny(e),i=r.Tc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function PE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=T(e._c.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.wc.delete(a),n&&e.dc.Pc(a,n)}}catch(o){i.e(o)}finally{i.f()}e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((function(t){e.Ic.containsKey(t)||DE(e,t)}))}function DE(e,t){e.mc.delete(t.path.canonicalString());var n=e.gc.get(t);null!==n&&(iI(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),ME(e))}function OE(e,t,n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof aE?(e.Ic.addReference(a.key,t),LE(e,a)):a instanceof oE?(Xv("SyncEngine","Document no longer in limbo: "+a.key),e.Ic.removeReference(a.key,t),e.Ic.containsKey(a.key)||DE(e,a.key)):ey()}}catch(o){i.e(o)}finally{i.f()}}function LE(e,t){var n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Xv("SyncEngine","New document in limbo: "+n),e.mc.add(r),ME(e))}function ME(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){var t=e.mc.values().next().value;e.mc.delete(t);var n=new Ey(by.fromString(t)),r=e.Ac.next();e.yc.set(r,new cE(n)),e.gc=e.gc.insert(n,r),rI(e.remoteStore,new pw(uk(tk(n.path)),r,"TargetPurposeLimboResolution",$y.ct))}}function FE(e,t,n){return UE.apply(this,arguments)}function UE(){return UE=gn(yn().mark((function e(t,n,r){var i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ny(t),a=[],o=[],u=[],e.t0=i.wc.isEmpty(),e.t0){e.next=9;break}return i.wc.forEach((function(e,t){u.push(i.Rc(t,n,r).then((function(e){if((e||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){a.push(e);var n=rx.Li(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(u);case 6:return i.dc.nu(a),e.next=9,function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o,u,s,c,l;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Vy.forEach(n,(function(t){return Vy.forEach(t.Fi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Vy.forEach(t.Bi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Wy(e.t0)){e.next=10;break}throw e.t0;case 10:Xv("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=T(n);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.targetId,o.fromCache||(s=r.Ji.get(u),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.Ji=r.Ji.insert(u,l))}catch(h){i.e(h)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return e.stop()}}),e)}))),UE.apply(this,arguments)}function VE(e,t){return jE.apply(this,arguments)}function jE(){return(jE=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=ny(t)).currentUser.isEqual(n)){e.next=11;break}return Xv("SyncEngine","User change. New user:",n.toKey()),e.next=5,ux(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.Ec.forEach((function(e){e.forEach((function(e){e.reject(new iy(ry.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,FE(r,i.er);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qE(e,t){var n=ny(e),r=n.yc.get(t);if(r&&r.fc)return Ck().add(r.key);var i=Ck(),a=n._c.get(t);if(!a)return i;var o,u=T(a);try{for(u.s();!(o=u.n()).done;){var s=o.value,c=n.wc.get(s);i=i.unionWith(c.view.nc)}}catch(l){u.e(l)}finally{u.f()}return i}function BE(e,t){return zE.apply(this,arguments)}function zE(){return(zE=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),e.next=3,mx(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.hc(i),e.abrupt("return",(r.isPrimaryClient&&OE(r,n.targetId,a.cc),a));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function WE(e,t){return HE.apply(this,arguments)}function HE(){return(HE=gn(yn().mark((function e(t,n){var r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),e.abrupt("return",kx(r.localStore,n).then((function(e){return FE(r,e)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function KE(e,t,n,r){return GE.apply(this,arguments)}function GE(){return GE=gn(yn().mark((function e(t,n,r,i){var a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ny(t),e.next=3,function(e,t){var n=ny(e),r=ny(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Sn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Vy.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,_I(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(AE(a,n,i||null),RE(a,n),function(e,t){ny(ny(e).mutationQueue).Cn(t)}(a.localStore,n)):ey();case 11:return e.next=13,FE(a,o);case 13:e.next=16;break;case 15:Xv("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),GE.apply(this,arguments)}function QE(e,t){return YE.apply(this,arguments)}function YE(){return(YE=gn(yn().mark((function e(t,n){var r,i,a,o,u,s,c,l;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(iT(r=ny(t)),aT(r),!0!==n||!0===r.vc){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,XE(r,i.toArray());case 5:return a=e.sent,r.vc=!0,e.next=9,MI(r.remoteStore,!0);case 9:o=T(a);try{for(o.s();!(u=o.n()).done;)s=u.value,rI(r.remoteStore,s)}catch(h){o.e(h)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.vc){e.next=25;break}return c=[],l=Promise.resolve(),r._c.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then((function(){return PE(r,t),vx(r.localStore,t,!0)})),iI(r.remoteStore,t)})),e.next=19,l;case 19:return e.next=21,XE(r,c);case 21:return function(e){var t=ny(e);t.yc.forEach((function(e,n){iI(t.remoteStore,n)})),t.Ic.Ts(),t.yc=new Map,t.gc=new Dm(Ey.comparator)}(r),r.vc=!1,e.next=25,MI(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function XE(e,t,n){return $E.apply(this,arguments)}function $E(){return $E=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f,d,p,v,y,m;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=ny(t),a=[],o=[],u=T(n),e.prev=2,u.s();case 4:if((s=u.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(h=i._c.get(c))||0===h.length){e.next=34;break}return e.next=11,px(i.localStore,uk(h[0]));case 11:l=e.sent,f=T(h),e.prev=13,f.s();case 15:if((d=f.n()).done){e.next=24;break}return p=d.value,v=i.wc.get(p),e.next=20,BE(i,v);case 20:(y=e.sent).snapshot&&o.push(y.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),f.e(e.t0);case 29:return e.prev=29,f.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,gx(i.localStore,c);case 36:return m=e.sent,e.next=39,px(i.localStore,m);case 39:return l=e.sent,e.next=42,dE(i,JE(m),c,!1,l.resumeToken);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),u.e(e.t1);case 50:return e.prev=50,u.f(),e.finish(50);case 53:return e.abrupt("return",(i.dc.nu(o),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),$E.apply(this,arguments)}function JE(e){return ek(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function ZE(e){var t=ny(e);return ny(ny(t.localStore).persistence).$i()}function eT(e,t,n,r){return tT.apply(this,arguments)}function tT(){return tT=gn(yn().mark((function e(t,n,r,i){var a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=ny(t)).vc){e.next=3;break}return e.abrupt("return",void Xv("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((o=a._c.get(n))&&o.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,kx(a.localStore,pk(o[0]));case 10:return u=e.sent,s=E_.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,qm.EMPTY_BYTE_STRING),e.next=14,FE(a,u,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,vx(a.localStore,n,!0);case 17:return PE(a,n,i),e.abrupt("break",20);case 19:ey();case 20:case"end":return e.stop()}}),e)}))),tT.apply(this,arguments)}function nT(e,t,n){return rT.apply(this,arguments)}function rT(){return(rT=gn(yn().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=iT(t)).vc){e.next=45;break}a=T(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=21;break}if(u=o.value,!i._c.has(u)){e.next=10;break}return Xv("SyncEngine","Adding an already active target "+u),e.abrupt("continue",19);case 10:return e.next=12,gx(i.localStore,u);case 12:return s=e.sent,e.next=15,px(i.localStore,s);case 15:return c=e.sent,e.next=18,dE(i,JE(s),c.targetId,!1,c.resumeToken);case 18:rI(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=T(r),e.prev=30,f=yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=i._c.has(t),!e.t0){e.next=5;break}return e.next=5,vx(i.localStore,t,!1).then((function(){iI(i.remoteStore,t),PE(i,t)})).catch(Fy);case 5:case"end":return e.stop()}}),e)})),l.s();case 33:if((h=l.n()).done){e.next=37;break}return e.delegateYield(f(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])})))).apply(this,arguments)}function iT(e){var t=ny(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=kE.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=qE.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=bE.bind(null,t),t.dc.nu=$I.bind(null,t.eventManager),t.dc.Pc=JI.bind(null,t.eventManager),t}function aT(e){var t=ny(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=IE.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=TE.bind(null,t),t}function oT(e,t,n){var r=ny(e);(function(){var e=gn(yn().mark((function e(t,n,r){var i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=ny(e),r=B_(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.qs.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(iE(i)),a=new rE(i,t.localStore,n.serializer),e.next=15,n.bc();case 15:o=e.sent;case 16:if(!o){e.next=26;break}return e.next=19,a.zu(o);case 19:return(u=e.sent)&&r._updateProgress(u),e.next=23,n.bc();case 23:o=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,FE(t,s.Ju,void 0);case 31:return e.next=33,function(e,t){var n=ny(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.qs.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.Hu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Jv("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var uT=function(){function e(){f(this,e),this.synchronizeTabs=!1}return y(e,[{key:"initialize",value:function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.serializer=Hx(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),e.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return ox(this.persistence,new ix,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new Gb(Yb.zs,this.serializer)}},{key:"createSharedClientState",value:function(e){return new Ox}},{key:"terminate",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),sT=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this)).Vc=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return y(n,[{key:"initialize",value:function(){var e=gn(yn().mark((function e(t){var r=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qr(k(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Vc.initialize(this,t);case 4:return e.next=6,aT(this.Vc.syncEngine);case 6:return e.next=8,_I(this.Vc.remoteStore);case 8:return e.next=10,this.persistence.Ii((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createLocalStore",value:function(e){return ox(this.persistence,new ix,e.initialUser,this.serializer)}},{key:"createGarbageCollectionScheduler",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new xb(n,e.asyncQueue,t)}},{key:"createIndexBackfillerScheduler",value:function(e,t){var n=new Xy(t,this.persistence);return new Yy(e.asyncQueue,n)}},{key:"createPersistence",value:function(e){var t=nx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?sb.withCacheSize(this.cacheSizeBytes):sb.DEFAULT;return new Zb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,zx(),Wx(),this.serializer,this.sharedClientState,!!this.forceOwnership)}},{key:"createSharedClientState",value:function(e){return new Ox}}]),n}(uT),cT=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,r,!1)).Vc=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return y(n,[{key:"initialize",value:function(){var e=gn(yn().mark((function e(t){var r,i=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qr(k(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Vc.syncEngine,e.t0=this.sharedClientState instanceof Dx,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={jr:KE.bind(null,r),zr:eT.bind(null,r),Wr:nT.bind(null,r),$i:ZE.bind(null,r),Qr:WE.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.Ii(function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,QE(i.Vc.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSharedClientState",value:function(e){var t=zx();if(!Dx.D(t))throw new iy(ry.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=nx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Dx(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(sT),lT=function(){function e(){f(this,e)}return y(e,[{key:"initialize",value:function(){var e=gn(yn().mark((function e(t,n){var r=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return wE(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=VE.bind(null,this.syncEngine),e.next=12,MI(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new KI}},{key:"createDatastore",value:function(e){var t,n=Hx(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Bx(t));return function(e,t,n,r){return new Xx(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return wE(o.syncEngine,e,0)},a=Mx.D()?new Mx:new Lx,new Jx(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new lE(e,t,n,r,i,a);return o&&(u.vc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ny(t),Xv("RemoteStore","RemoteStore shutting down."),n.vu.add(5),e.next=5,tI(n);case 5:n.Pu.shutdown(),n.bu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function hT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return gn(yn().mark((function r(){var i;return yn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.resolve()}}var fT=function(){function e(t){f(this,e),this.observer=t,this.muted=!1}return y(e,[{key:"next",value:function(e){this.observer.next&&this.Sc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Sc(this.observer.error,e):$v("Uncaught Error in snapshot listener:",e.toString())}},{key:"Dc",value:function(){this.muted=!0}},{key:"Sc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),dT=function(){function e(t,n){var r=this;f(this,e),this.Cc=t,this.serializer=n,this.metadata=new ay,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then((function(e){e&&e.Qu()?r.metadata.resolve(e.Gu.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.Gu))))}),(function(e){return r.metadata.reject(e)}))}return y(e,[{key:"close",value:function(){return this.Cc.cancel()}},{key:"getMetadata",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bc",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Nc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Nc",value:function(){var e=gn(yn().mark((function e(){var t,n,r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.kc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.xc.decode(t),r=Number(n),isNaN(r)&&this.Mc("length string (".concat(n,") is not valid number")),e.next=9,this.$c(r);case 9:return i=e.sent,e.abrupt("return",new tE(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Oc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"kc",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Oc()<0)){e.next=7;break}return e.next=3,this.Fc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Oc())<0&&this.Mc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"$c",value:function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Fc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Mc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.xc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Mc",value:function(e){throw this.Cc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Fc",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Cc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),pT=function(){function e(t){f(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return y(e,[{key:"lookup",value:function(){var e=gn(yn().mark((function e(t){var n,r=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new iy(ry.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),i=Y_(r.serializer)+"/documents",a={documents:n.map((function(e){return H_(r.serializer,e)}))},e.next=5,r.vo("BatchGetDocuments",i,a,n.length);case 5:return o=e.sent,u=new Map,o.forEach((function(e){var t=Z_(r.serializer,e);u.set(t.key.toString(),t)})),s=[],e.abrupt("return",(n.forEach((function(e){var t=u.get(e.toString());ty(!!t),s.push(t)})),s));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new c_(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=gn(yn().mark((function e(){var t,n=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=Ey.fromPath(t);n.mutations.push(new l_(r,n.precondition(r)))})),e.next=7,function(){var e=gn(yn().mark((function e(t,n){var r,i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ny(t),i=Y_(r.serializer)+"/documents",a={writes:n.map((function(e){return ew(r.serializer,e)}))},e.next=3,r.Io("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ey();t=_y.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new iy(ry.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(_y.min())?Qk.exists(!1):Qk.updateTime(t):Qk.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(_y.min()))throw new iy(ry.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qk.updateTime(t)}return Qk.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),vT=function(){function e(t,n,r,i,a){f(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.Bc=r.maxAttempts,this.qo=new Kx(this.asyncQueue,"transaction_retry")}return y(e,[{key:"run",value:function(){this.Bc-=1,this.Lc()}},{key:"Lc",value:function(){var e=this;this.qo.No(gn(yn().mark((function t(){var n,r;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new pT(e.datastore),(r=e.qc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Uc(t)}))}))})).catch((function(t){e.Uc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"qc",value:function(e){try{var t=this.updateFunction(e);return!Jy(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Uc",value:function(e){var t=this;this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Lc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"Kc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!v_(t)}return!1}}]),e}(),yT=function(){function e(t,n,r,i){var a=this;f(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Kv.UNAUTHENTICATED,this.clientId=vy.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xv("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Xv("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return y(e,[{key:"getConfiguration",value:function(){var e=gn(yn().mark((function e(){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new iy(ry.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new ay;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(gn(yn().mark((function n(){var r;return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e._onlineComponents,!n.t0){n.next=5;break}return n.next=5,e._onlineComponents.terminate();case 5:if(n.t1=e._offlineComponents,!n.t1){n.next=9;break}return n.next=9,e._offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=qI(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function mT(e,t){return gT.apply(this,arguments)}function gT(){return gT=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Xv("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,ux(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t._offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),gT.apply(this,arguments)}function kT(e,t){return _T.apply(this,arguments)}function _T(){return(_T=gn(yn().mark((function e(t,n){var r,i;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,bT(t);case 3:return r=e.sent,Xv("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return OI(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return OI(n.remoteStore,t)})),t._onlineComponents=n;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wT(e){return"FirebaseError"===e.name?e.code===ry.FAILED_PRECONDITION||e.code===ry.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function bT(e){return xT.apply(this,arguments)}function xT(){return(xT=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._offlineComponents){e.next=21;break}if(!t._uninitializedComponentsProvider){e.next=18;break}return Xv("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,mT(t,t._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),wT(n=e.t0)){e.next=13;break}throw n;case 13:return Jv("Error using user provided cache. Falling back to memory cache: "+n),e.next=16,mT(t,new uT);case 16:e.next=21;break;case 18:return Xv("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,mT(t,new uT);case 21:return e.abrupt("return",t._offlineComponents);case 22:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function IT(e){return ET.apply(this,arguments)}function ET(){return(ET=gn(yn().mark((function e(t){return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t._onlineComponents,e.t0){e.next=11;break}if(!t._uninitializedComponentsProvider){e.next=8;break}return Xv("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,kT(t,t._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return Xv("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,kT(t,new lT);case 11:return e.abrupt("return",t._onlineComponents);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TT(e){return bT(e).then((function(e){return e.persistence}))}function ST(e){return bT(e).then((function(e){return e.localStore}))}function CT(e){return IT(e).then((function(e){return e.remoteStore}))}function NT(e){return IT(e).then((function(e){return e.syncEngine}))}function RT(e){return IT(e).then((function(e){return e.datastore}))}function AT(e){return PT.apply(this,arguments)}function PT(){return(PT=gn(yn().mark((function e(t){var n,r;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,IT(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=hE.bind(null,n.syncEngine),r.onUnlisten=vE.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function DT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function i(){return yn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new fT({next:function(a){t.enqueueAndForget((function(){return YI(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new iy(ry.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new iy(ry.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new eE(tk(n.path),a,{includeMetadataChanges:!0,Ku:!0});return GI(e,o)},i.next=3,AT(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function OT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function i(){return yn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new fT({next:function(n){t.enqueueAndForget((function(){return YI(e,o)})),n.fromCache&&"server"===r.source?i.reject(new iy(ry.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new eE(n,a,{includeMetadataChanges:!0,Ku:!0});return GI(e,o)},i.next=3,AT(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function LT(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}var MT=new Map;function FT(e,t,n){if(!n)throw new iy(ry.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function UT(e,t,n,r){if(!0===t&&!0===r)throw new iy(ry.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function VT(e){if(!Ey.isDocumentKey(e))throw new iy(ry.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function jT(e){if(Ey.isDocumentKey(e))throw new iy(ry.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function qT(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":ey()}function BT(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new iy(ry.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=qT(e);throw new iy(ry.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function zT(e,t){if(t<=0)throw new iy(ry.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var WT=function(){function e(t){var n,r;if(f(this,e),void 0===t.host){if(void 0!==t.ssl)throw new iy(ry.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new iy(ry.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}UT("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LT(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new iy(ry.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new iy(ry.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new iy(ry.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}return y(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}]),e}(),HT=function(){function e(t,n,r,i){f(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WT({}),this._settingsFrozen=!1}return y(e,[{key:"app",get:function(){if(!this._app)throw new iy(ry.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new iy(ry.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WT(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new uy;switch(e.type){case"firstParty":return new hy(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new iy(ry.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=MT.get(e);t&&(Xv("ComponentProvider","Removing Datastore"),MT.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function KT(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=BT(e,HT))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Jv("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=Kv.MOCK_USER;else{o=Lt(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new iy(ry.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Kv(s)}e._authCredentials=new sy(new oy(o,u))}}var GT=function(){function e(t,n,r){f(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return y(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new YT(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),QT=function(){function e(t,n,r){f(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return y(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),YT=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this,e,r,tk(i)))._path=i,a.type="collection",a}return y(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new GT(this.firestore,null,new Ey(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(QT);function XT(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=vn(e),FT("collection","path",t),e instanceof HT){var a=by.fromString.apply(by,[t].concat(r));return jT(a),new YT(e,null,a)}if(!(e instanceof GT||e instanceof YT))throw new iy(ry.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(by.fromString.apply(by,[t].concat(r)));return jT(o),new YT(e.firestore,null,o)}function $T(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=vn(e),1===arguments.length&&(t=vy.A()),FT("doc","path",t),e instanceof HT){var a=by.fromString.apply(by,[t].concat(r));return VT(a),new GT(e,null,new Ey(a))}if(!(e instanceof GT||e instanceof YT))throw new iy(ry.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(by.fromString.apply(by,[t].concat(r)));return VT(o),new GT(e.firestore,e instanceof YT?e.converter:null,new Ey(o))}function JT(e,t){return e=vn(e),t=vn(t),(e instanceof GT||e instanceof YT)&&(t instanceof GT||t instanceof YT)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function ZT(e,t){return e=vn(e),t=vn(t),e instanceof QT&&t instanceof QT&&e.firestore===t.firestore&&lk(e._query,t._query)&&e.converter===t.converter}var eS=function(){function e(){var t=this;f(this,e),this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Kx(this,"async_queue_retry"),this.Xc=function(){var e=Wx();e&&Xv("AsyncQueue","Visibility state changed to "+e.visibilityState),t.qo.Mo()};var n=Wx();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Xc)}return y(e,[{key:"isShuttingDown",get:function(){return this.jc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Zc(),this.ta(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;var t=Wx();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Zc(),this.jc)return new Promise((function(){}));var n=new ay;return this.ta((function(){return t.jc&&t.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Qc.push(e),t.ea()}))}},{key:"ea",value:function(){var e=gn(yn().mark((function e(){var t=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Qc.length){e.next=14;break}return e.prev=1,e.next=4,this.Qc[0]();case 4:this.Qc.shift(),this.qo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),Wy(e.t0)){e.next=12;break}throw e.t0;case 12:Xv("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Qc.length>0&&this.qo.No((function(){return t.ea()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"ta",value:function(e){var t=this,n=this.Gc.then((function(){return t.Hc=!0,e().catch((function(e){t.Wc=e,t.Hc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw $v("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Hc=!1,e}))}));return this.Gc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);var i=jI.createAndSchedule(this,e,t,n,(function(e){return r.na(e)}));return this.zc.push(i),i}},{key:"Zc",value:function(){this.Wc&&ey()}},{key:"verifyOperationInProgress",value:function(){}},{key:"sa",value:function(){var e=gn(yn().mark((function e(){var t;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Gc,e.next=3,t;case 3:if(t!==this.Gc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ia",value:function(e){var t,n=T(this.zc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ra",value:function(e){var t=this;return this.sa().then((function(){t.zc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=T(t.zc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.sa()}))}},{key:"oa",value:function(e){this.Yc.push(e)}},{key:"na",value:function(e){var t=this.zc.indexOf(e);this.zc.splice(t,1)}}]),e}();function tS(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=T(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var nS=function(){function e(){f(this,e),this._progressObserver={},this._taskCompletionResolver=new ay,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return y(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),rS=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o;return f(this,n),(o=t.call(this,e,r,i,a)).type="firestore",o._queue=new eS,o._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]",o}return y(n,[{key:"_terminate",value:function(){return this._firestoreClient||aS(this),this._firestoreClient.terminate()}}]),n}(HT);function iS(e){return e._firestoreClient||aS(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function aS(e){var t,n,r,i=e._freezeSettings(),a=function(e,t,n,r){return new Ym(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,LT(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new yT(e._authCredentials,e._appCheckCredentials,e._queue,a),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function oS(e,t,n){var r=new ay;return e.asyncQueue.enqueue(gn(yn().mark((function i(){var a;return yn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,mT(e,n);case 3:return i.next=5,kT(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),wT(a=i.t0)){i.next=13;break}throw a;case 13:Jv("Error enabling indexeddb cache. Falling back to memory cache: "+a),r.reject(a);case 14:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function uS(e){return function(e){return e.asyncQueue.enqueue(gn(yn().mark((function t(){var n,r;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,TT(e);case 2:return n=t.sent,t.next=5,CT(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=ny(e);return t.vu.delete(0),Zx(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(iS(e=BT(e,rS)))}function sS(e){return function(e){return e.asyncQueue.enqueue(gn(yn().mark((function t(){var n,r;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,TT(e);case 2:return n=t.sent,t.next=5,CT(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=ny(t)).vu.add(0),e.next=4,tI(n);case 4:n.bu.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(iS(e=BT(e,rS)))}function cS(e,t){var n=iS(e=BT(e,rS)),r=new nS;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new dT(e,t)}(function(e,t){if(e instanceof Uint8Array)return hT(e,t);if(e instanceof ArrayBuffer)return hT(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?k_().encode(e):e),t)}(n,Hx(t));e.asyncQueue.enqueueAndForget(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=oT,t.next=3,NT(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function lS(e,t){return function(e,t){return e.asyncQueue.enqueue(gn(yn().mark((function n(){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=ny(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.qs.getNamedQuery(e,t)}))},n.next=3,ST(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(iS(e=BT(e,rS)),t).then((function(t){return t?new QT(e,null,t.query):null}))}function hS(e){if(e._initialized||e._terminated)throw new iy(ry.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var fS=function(){function e(t){f(this,e),this._byteString=t}return y(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(qm.fromBase64String(t))}catch(t){throw new iy(ry.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(qm.fromUint8Array(t))}}]),e}(),dS=function(){function e(){f(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new iy(ry.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Iy(n)}return y(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var pS=y((function e(t){f(this,e),this._methodName=t})),vS=function(){function e(t,n){if(f(this,e),!isFinite(t)||t<-90||t>90)throw new iy(ry.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new iy(ry.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return y(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return yy(this._lat,e._lat)||yy(this._long,e._long)}}]),e}(),yS=/^__.*__$/,mS=function(){function e(t,n,r){f(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return y(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new r_(e,this.data,this.fieldMask,t,this.fieldTransforms):new n_(e,this.data,t,this.fieldTransforms)}}]),e}(),gS=function(){function e(t,n,r){f(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return y(e,[{key:"toMutation",value:function(e,t){return new r_(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function kS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ey()}}var _S=function(){function e(t,n,r,i,a,o){f(this,e),this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ua(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return y(e,[{key:"path",get:function(){return this.settings.path}},{key:"ca",get:function(){return this.settings.ca}},{key:"aa",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ha",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}},{key:"da",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}},{key:"wa",value:function(e){return this.aa({path:void 0,la:!0})}},{key:"_a",value:function(e){return jS(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"ua",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.fa(this.path.get(e))}},{key:"fa",value:function(e){if(0===e.length)throw this._a("Document fields must not be empty");if(kS(this.ca)&&yS.test(e))throw this._a('Document fields cannot begin and end with "__"')}}]),e}(),wS=function(){function e(t,n,r){f(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Hx(t)}return y(e,[{key:"ya",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new _S({ca:e,methodName:t,ga:n,path:Iy.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),e}();function bS(e){var t=e._freezeSettings(),n=Hx(e._databaseId);return new wS(e._databaseId,!!t.ignoreUndefinedProperties,n)}function xS(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.ya(a.merge||a.mergeFields?2:0,t,n,i);MS("Data must be an object, but it was:",o,r);var u,s,c=OS(r,o);if(a.merge)u=new Vm(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=T(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=FS(t,l.value,n);if(!o.contains(d))throw new iy(ry.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));qS(h,d)||h.push(d)}}catch(p){f.e(p)}finally{f.f()}u=new Vm(h),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new mS(new gg(c),u,s)}var IS=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.ca)throw 1===e.ca?e._a("".concat(this._methodName,"() can only appear at the top level of your update data")):e._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(pS);function ES(e,t,n){return new _S({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var TS=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"_toFieldTransform",value:function(e){return new Kk(e.path,new Uk)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(pS),SS=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e)).pa=r,i}return y(n,[{key:"_toFieldTransform",value:function(e){var t=ES(this,e,!0),n=this.pa.map((function(e){return DS(e,t)})),r=new Vk(n);return new Kk(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(pS),CS=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e)).pa=r,i}return y(n,[{key:"_toFieldTransform",value:function(e){var t=ES(this,e,!0),n=this.pa.map((function(e){return DS(e,t)})),r=new qk(n);return new Kk(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(pS),NS=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e)).Ia=r,i}return y(n,[{key:"_toFieldTransform",value:function(e){var t=new zk(e.serializer,Dk(e.serializer,this.Ia));return new Kk(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(pS);function RS(e,t,n,r){var i=e.ya(1,t,n);MS("Data must be an object, but it was:",i,r);var a=[],o=gg.empty();Am(r,(function(e,r){var u=VS(t,e,n);r=vn(r);var s=i.da(u);if(r instanceof IS)a.push(u);else{var c=DS(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new Vm(a);return new gS(o,u,i.fieldTransforms)}function AS(e,t,n,r,i,a){var o=e.ya(1,t,n),u=[FS(t,r,n)],s=[i];if(a.length%2!=0)throw new iy(ry.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(FS(t,a[c])),s.push(a[c+1]);for(var l=[],h=gg.empty(),f=u.length-1;f>=0;--f)if(!qS(l,u[f])){var d=u[f],p=s[f];p=vn(p);var v=o.da(d);if(p instanceof IS)l.push(d);else{var y=DS(p,v);null!=y&&(l.push(d),h.set(d,y))}}var m=new Vm(l);return new gS(h,m,o.fieldTransforms)}function PS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return DS(n,e.ya(r?4:3,t))}function DS(e,t){if(LS(e=vn(e)))return MS("Unsupported field value:",t,e),OS(e,t);if(e instanceof pS)return function(e,t){if(!kS(t.ca))throw t._a("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t._a("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=T(e);try{for(a.s();!(n=a.n()).done;){var o=DS(n.value,t.wa(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=vn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Dk(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=ky.fromDate(e);return{timestampValue:V_(t.serializer,n)}}if(e instanceof ky){var r=new ky(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:V_(t.serializer,r)}}if(e instanceof vS)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof fS)return{bytesValue:j_(t.serializer,e._byteString)};if(e instanceof GT){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t._a("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:z_(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a("Unsupported field value: ".concat(qT(e)))}(e,t)}function OS(e,t){var n={};return Pm(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Am(e,(function(e,r){var i=DS(r,t.ha(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function LS(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ky||e instanceof vS||e instanceof fS||e instanceof GT||e instanceof pS)}function MS(e,t,n){if(!LS(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=qT(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function FS(e,t,n){if((t=vn(t))instanceof dS)return t._internalPath;if("string"==typeof t)return VS(e,t);throw jS("Field path arguments must be of type string or ",e,!1,void 0,n)}var US=new RegExp("[~\\*/\\[\\]]");function VS(e,t,n){if(t.search(US)>=0)throw jS("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return x(dS,h(t.split(".")))._internalPath}catch(r){throw jS("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function jS(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new iy(ry.INVALID_ARGUMENT,u+e+s)}function qS(e,t){return e.some((function(e){return e.isEqual(t)}))}var BS=function(){function e(t,n,r,i,a){f(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return y(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new GT(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new zS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(WS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),zS=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"data",value:function(){return Qr(k(n.prototype),"data",this).call(this)}}]),n}(BS);function WS(e,t){return"string"==typeof t?VS(e,t):t instanceof dS?t._internalPath:t._delegate._internalPath}function HS(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new iy(ry.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var KS=y((function e(){f(this,e)})),GS=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n)}(KS);function QS(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof KS&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof XS})).length,n=e.filter((function(e){return e instanceof YS})).length;if(t>1||t>0&&n>0)throw new iy(ry.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var o,u=T(n);try{for(u.s();!(o=u.n()).done;){e=o.value._apply(e)}}catch(s){u.e(s)}finally{u.f()}return e}var YS=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this))._field=e,a._op=r,a._value=i,a.type="where",a}return y(n,[{key:"_apply",value:function(e){var t=this._parse(e);return sC(e._query,t),new QT(e.firestore,e.converter,sk(e._query,t))}},{key:"_parse",value:function(e){var t=bS(e.firestore),n=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new iy(ry.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){uC(o,a);var s,c=[],l=T(o);try{for(l.s();!(s=l.n()).done;){var h=s.value;c.push(oC(r,e,h))}}catch(f){l.e(f)}finally{l.f()}u={arrayValue:{values:c}}}else u=oC(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||uC(o,a),u=PS(n,"where",o,"in"===a||"not-in"===a);return Sg.create(i,a,u)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(GS);var XS=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).type=e,i._queryConstraints=r,i}return y(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:Cg.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=T(t.getFlattenedFilters());try{for(i.s();!(n=i.n()).done;){var a=n.value;sC(r,a),r=sk(r,a)}}catch(o){i.e(o)}finally{i.f()}}(e._query,t),new QT(e.firestore,e.converter,sk(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(KS);var $S=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._field=e,i._direction=r,i.type="orderBy",i}return y(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new iy(ry.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new iy(ry.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ig(t,n);return function(e,t){if(null===rk(e)){var n=ik(e);null!==n&&cC(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new QT(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new Zg(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(GS);var JS=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this)).type=e,a._limit=r,a._limitType=i,a}return y(n,[{key:"_apply",value:function(e){return new QT(e.firestore,e.converter,ck(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(GS);var ZS=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return y(n,[{key:"_apply",value:function(e){var t=aC(e,this.type,this._docOrFields,this._inclusive);return new QT(e.firestore,e.converter,function(e,t){return new Zg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(GS);function eC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ZS._create("startAt",t,!0)}function tC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ZS._create("startAfter",t,!1)}var nC=function(e){g(n,e);var t=b(n);function n(e,r,i){var a;return f(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return y(n,[{key:"_apply",value:function(e){var t=aC(e,this.type,this._docOrFields,this._inclusive);return new QT(e.firestore,e.converter,function(e,t){return new Zg(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(GS);function rC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nC._create("endBefore",t,!1)}function iC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nC._create("endAt",t,!0)}function aC(e,t,n,r){if(n[0]=vn(n[0]),n[0]instanceof BS)return function(e,t,n,r,i){if(!r)throw new iy(ry.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],u=T(ok(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s.field.isKeyField())o.push(og(t,r.key));else{var c=r.data.field(s.field);if(Km(c))throw new iy(ry.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new iy(ry.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(h){u.e(h)}finally{u.f()}return new wg(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=bS(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new iy(ry.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new iy(ry.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!ak(e)&&-1!==c.indexOf("/"))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(by.fromString(c));if(!Ey.isDocumentKey(l))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var h=new Ey(l);u.push(og(t,h))}else{var f=PS(n,r,c);u.push(f)}}return new wg(u,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function oC(e,t,n){if("string"==typeof(n=vn(n))){if(""===n)throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ak(t)&&-1!==n.indexOf("/"))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(by.fromString(n));if(!Ey.isDocumentKey(r))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return og(e,new Ey(r))}if(n instanceof GT)return og(e,n._key);throw new iy(ry.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(qT(n),"."))}function uC(e,t){if(!Array.isArray(e)||0===e.length)throw new iy(ry.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function sC(e,t){if(t.isInequality()){var n=ik(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=rk(e);null!==i&&cC(e,r,i)}var a=function(e,t){var n,r=T(e);try{for(r.s();!(n=r.n()).done;){var i,a=T(n.value.getFlattenedFilters());try{for(a.s();!(i=a.n()).done;){var o=i.value;if(t.indexOf(o.op)>=0)return o.op}}catch(u){a.e(u)}finally{a.f()}}}catch(u){r.e(u)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==a)throw a===t.op?new iy(ry.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new iy(ry.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function cC(e,t,n){if(!n.isEqual(t))throw new iy(ry.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var lC=function(){function e(){f(this,e)}return y(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Zm(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wm(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ey()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return Am(e,(function(e,i){r[e]=t.convertValue(i,n)})),r}},{key:"convertGeoPoint",value:function(e){return new vS(Wm(e.latitude),Wm(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Gm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Qm(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=zm(e);return new ky(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=by.fromString(e);ty(dw(n));var r=new Xm(n.get(1),n.get(3)),i=new Ey(n.popFirst(5));return r.isEqual(t)||$v("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function hC(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var fC=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).firestore=e,r}return y(n,[{key:"convertBytes",value:function(e){return new fS(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new GT(this.firestore,null,t)}}]),n}(lC);var dC=function(){function e(t,n){f(this,e),this.hasPendingWrites=t,this.fromCache=n}return y(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),pC=function(e){g(n,e);var t=b(n);function n(e,r,i,a,o,u){var s;return f(this,n),(s=t.call(this,e,r,i,a,u))._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return y(n,[{key:"exists",value:function(){return Qr(k(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new vC(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(WS("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(BS),vC=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qr(k(n.prototype),"data",this).call(this,e)}}]),n}(pC),yC=function(){function e(t,n,r,i){f(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new dC(i.hasPendingWrites,i.fromCache),this.query=r}return y(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new vC(n._firestore,n._userDataWriter,r.key,r,new dC(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new iy(ry.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new vC(e._firestore,e._userDataWriter,t.doc.key,t.doc,new dC(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new vC(e._firestore,e._userDataWriter,t.doc.key,t.doc,new dC(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:mC(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function mC(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ey()}}function gC(e,t){return e instanceof pC&&t instanceof pC?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof yC&&t instanceof yC&&e._firestore===t._firestore&&ZT(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}var kC=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).firestore=e,r}return y(n,[{key:"convertBytes",value:function(e){return new fS(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new GT(this.firestore,null,t)}}]),n}(lC);function _C(e){e=BT(e,GT);var t=BT(e.firestore,rS),n=iS(t),r=new kC(t);return function(e,t){var n=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function r(){return yn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=gn(yn().mark((function e(t,n,r){var i,a;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=ny(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new iy(ry.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=qI(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,ST(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new pC(t,r,e._key,n,new dC(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function wC(e){e=BT(e,QT);var t=BT(e.firestore,rS),n=iS(t),r=new kC(t);return function(e,t){var n=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function r(){return yn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=gn(yn().mark((function e(t,n,r){var i,a,o,u,s;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,mx(t,n,!0);case 3:i=e.sent,a=new uE(n,i.ir),o=a.sc(i.documents),u=a.applyChanges(o,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=qI(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,ST(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new yC(t,r,e,n)}))}function bC(e,t,n){e=BT(e,GT);var r=BT(e.firestore,rS),i=hC(e.converter,t,n);return TC(r,[xS(bS(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Qk.none())])}function xC(e,t,n){e=BT(e,GT);for(var r=BT(e.firestore,rS),i=bS(r),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return TC(r,[("string"==typeof(t=vn(t))||t instanceof dS?AS(i,"updateDoc",e._key,t,n,o):RS(i,"updateDoc",e._key,t)).toMutation(e._key,Qk.exists(!0))])}function IC(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=vn(e);var u={includeMetadataChanges:!1},s=0;"object"!=typeof n[s]||tS(n[s])||(u=n[s],s++);var c,l,h,f={includeMetadataChanges:u.includeMetadataChanges};if(tS(n[s])){var d=n[s];n[s]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[s+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[s+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof GT)l=BT(e.firestore,rS),h=tk(e._key.path),c={next:function(t){n[s]&&n[s](SC(l,e,t))},error:n[s+1],complete:n[s+2]};else{var p=BT(e,QT);l=BT(p.firestore,rS),h=p._query;var v=new kC(l);c={next:function(e){n[s]&&n[s](new yC(l,v,p,e))},error:n[s+1],complete:n[s+2]},HS(e._query)}return function(e,t,n,r){var i=new fT(r),a=new eE(t,i,n);return e.asyncQueue.enqueueAndForget(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=GI,t.next=3,AT(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.Dc(),e.asyncQueue.enqueueAndForget(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=YI,t.next=3,AT(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(iS(l),h,f,c)}function EC(e,t){return function(e,t){var n=new fT(t);return e.asyncQueue.enqueueAndForget(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){ny(e).ku.add(t),t.next()},t.next=3,AT(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.Dc(),e.asyncQueue.enqueueAndForget(gn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){ny(e).ku.delete(t)},t.next=3,AT(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(iS(e=BT(e,rS)),tS(t)?t:{next:t})}function TC(e,t){return function(e,t){var n=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function r(){return yn().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=mE,r.next=3,NT(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(iS(e),t)}function SC(e,t,n){var r=n.docs.get(t._key),i=new kC(e);return new pC(e,i,t._key,r,new dC(n.hasPendingWrites,n.fromCache),t.converter)}var CC={maxAttempts:5},NC=function(){function e(t,n){f(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=bS(t)}return y(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=RC(e,this._firestore),i=hC(r.converter,t,n),a=xS(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Qk.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=RC(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=vn(t))||t instanceof dS?AS(this._dataReader,"WriteBatch.update",i._key,t,n,o):RS(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Qk.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=RC(e,this._firestore);return this._mutations=this._mutations.concat(new c_(t._key,Qk.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new iy(ry.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function RC(e,t){if((e=vn(e)).firestore!==t)throw new iy(ry.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var AC=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,r))._firestore=e,i}return y(n,[{key:"get",value:function(e){var t=this,r=RC(e,this._firestore),i=new kC(this._firestore);return Qr(k(n.prototype),"get",this).call(this,e).then((function(e){return new pC(t._firestore,i,r._key,e._document,new dC(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){f(this,e),this._firestore=t,this._transaction=n,this._dataReader=bS(t)}return y(e,[{key:"get",value:function(e){var t=this,n=RC(e,this._firestore),r=new fC(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return ey();var i=e[0];if(i.isFoundDocument())return new BS(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new BS(t._firestore,r,n._key,null,n.converter);throw ey()}))}},{key:"set",value:function(e,t,n){var r=RC(e,this._firestore),i=hC(r.converter,t,n),a=xS(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=RC(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=vn(t))||t instanceof dS?AS(this._dataReader,"Transaction.update",i._key,t,n,o):RS(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=RC(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function PC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new SS("arrayUnion",t)}function DC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new CS("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Gv=e}(vr),sr(new kn("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new rS(new cy(e.getProvider("auth-internal")),new dy(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new iy(ry.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xm(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),wr(Hv,"3.12.1",e),wr(Hv,"3.12.1","esm2017")}();function OC(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new iy("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function LC(){if("undefined"===typeof Uint8Array)throw new iy("unimplemented","Uint8Arrays are not available in this environment.")}function MC(){if("undefined"==typeof atob)throw new iy("unimplemented","Blobs are unavailable in Firestore in this environment.")}var FC=function(){function e(t){f(this,e),this._delegate=t}return y(e,[{key:"toBase64",value:function(){return MC(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return LC(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return MC(),new e(fS.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return LC(),new e(fS.fromUint8Array(t))}}]),e}();function UC(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=T(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var VC=function(){function e(){f(this,e)}return y(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){hS(e=BT(e,rS));var n=iS(e);if(n._uninitializedComponentsProvider)throw new iy(ry.FAILED_PRECONDITION,"SDK cache is already specified.");Jv("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var r=e._freezeSettings(),i=new lT;return oS(n,i,new sT(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){hS(e=BT(e,rS));var t=iS(e);if(t._uninitializedComponentsProvider)throw new iy(ry.FAILED_PRECONDITION,"SDK cache is already specified.");Jv("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var n=e._freezeSettings(),r=new lT;return oS(t,r,new cT(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new iy(ry.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new ay;return e._queue.enqueueAndForgetEvenWhileRestricted(gn(yn().mark((function n(){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=gn(yn().mark((function e(t){var n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qy.D()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,qy.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(nx(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),jC=function(){function e(t,n,r){var i=this;f(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof Xm||(this._appCompat=t)}return y(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Jv("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};KT(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return uS(this._delegate)}},{key:"disableNetwork",value:function(){return sS(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&UT("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){var t=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function n(){return yn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=CE,n.next=3,NT(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(iS(BT(this._delegate,rS)))}},{key:"onSnapshotsInSync",value:function(e){return EC(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new iy("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new eN(this,XT(this._delegate,e))}catch(t){throw KC(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new HC(this,$T(this._delegate,e))}catch(t){throw KC(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new $C(this,function(e,t){if(e=BT(e,HT),FT("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new iy(ry.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new QT(e,null,function(e){return new Zg(by.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw KC(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return function(e,t,n){e=BT(e,rS);var r=Object.assign(Object.assign({},CC),n);return function(e){if(e.maxAttempts<1)throw new iy(ry.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new ay;return e.asyncQueue.enqueueAndForget(gn(yn().mark((function i(){var a;return yn().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,RT(e);case 2:a=i.sent,new vT(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}}),i)})))),r.promise}(iS(e),(function(n){return t(new AC(e,n))}),r)}(this._delegate,(function(n){return e(new BC(t,n))}))}},{key:"batch",value:function(){var e=this;return iS(this._delegate),new zC(new NC(this._delegate,(function(t){return TC(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return cS(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return lS(this._delegate,e).then((function(e){return e?new $C(t,e):null}))}}]),e}(),qC=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).firestore=e,r}return y(n,[{key:"convertBytes",value:function(e){return new FC(new fS(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return HC.forKey(t,this.firestore,null)}}]),n}(lC);var BC=function(){function e(t,n){f(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new qC(t)}return y(e,[{key:"get",value:function(e){var t=this,n=tN(e);return this._delegate.get(n).then((function(e){return new YC(t._firestore,new pC(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=tN(e);return n?(OC("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=tN(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=tN(e);return this._delegate.delete(t),this}}]),e}(),zC=function(){function e(t){f(this,e),this._delegate=t}return y(e,[{key:"set",value:function(e,t,n){var r=tN(e);return n?(OC("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=tN(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=tN(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),WC=function(){function e(t,n,r){f(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return y(e,[{key:"fromFirestore",value:function(e,t){var n=new vC(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new XC(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new qC(t),n),i.set(n,a)),a}}]),e}();WC.INSTANCES=new WeakMap;var HC=function(){function e(t,n){f(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new qC(t)}return y(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new eN(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new eN(this.firestore,XT(this._delegate,e))}catch(t){throw KC(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=vn(e))instanceof GT&&JT(this._delegate,e)}},{key:"set",value:function(e,t){t=OC("DocumentReference.set",t);try{return t?bC(this._delegate,e,t):bC(this._delegate,e)}catch(n){throw KC(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?xC(this._delegate,e):xC.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw KC(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return TC(BT((e=this._delegate).firestore,rS),[new c_(e._key,Qk.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=GC(n),a=QC(n,(function(t){return new YC(e.firestore,new pC(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return IC(this._delegate,i,a)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?_C(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=BT(e,GT);var t=BT(e.firestore,rS);return DT(iS(t),e._key,{source:"server"}).then((function(n){return SC(t,e,n)}))}(this._delegate):function(e){e=BT(e,GT);var t=BT(e.firestore,rS);return DT(iS(t),e._key).then((function(n){return SC(t,e,n)}))}(this._delegate)).then((function(e){return new YC(t.firestore,new pC(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(WC.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new iy("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new GT(n._delegate,r,new Ey(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new GT(n._delegate,r,t))}}]),e}();function KC(e,t,n){return e.message=e.message.replace(t,n),e}function GC(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!UC(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function QC(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=UC(e[0])?e[0]:UC(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var YC=function(){function e(t,n){f(this,e),this._firestore=t,this._delegate=n}return y(e,[{key:"ref",get:function(){return new HC(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return gC(this._delegate,e._delegate)}}]),e}(),XC=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||ey(),t}}]),n}(YC),$C=function(){function e(t,n){f(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new qC(t)}return y(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,QS(this._delegate,function(e,t,n){var r=t,i=WS("where",e);return YS._create(i,r,n)}(t,n,r)))}catch(i){throw KC(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,QS(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=WS("orderBy",e);return $S._create(n,t)}(t,n)))}catch(r){throw KC(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,QS(this._delegate,(zT("limit",n=t),JS._create("limit",n,"F"))))}catch(r){throw KC(r,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,QS(this._delegate,(zT("limitToLast",n=t),JS._create("limitToLast",n,"L"))))}catch(r){throw KC(r,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){try{return new e(this.firestore,QS(this._delegate,eC.apply(void 0,arguments)))}catch(t){throw KC(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,QS(this._delegate,tC.apply(void 0,arguments)))}catch(t){throw KC(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,QS(this._delegate,rC.apply(void 0,arguments)))}catch(t){throw KC(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,QS(this._delegate,iC.apply(void 0,arguments)))}catch(t){throw KC(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return ZT(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?wC(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=BT(e,QT);var t=BT(e.firestore,rS),n=iS(t),r=new kC(t);return OT(n,e._query,{source:"server"}).then((function(n){return new yC(t,r,e,n)}))}(this._delegate):function(e){e=BT(e,QT);var t=BT(e.firestore,rS),n=iS(t),r=new kC(t);return HS(e._query),OT(n,e._query).then((function(n){return new yC(t,r,e,n)}))}(this._delegate)).then((function(e){return new ZC(t.firestore,new yC(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=GC(n),a=QC(n,(function(t){return new ZC(e.firestore,new yC(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return IC(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(WC.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),JC=function(){function e(t,n){f(this,e),this._firestore=t,this._delegate=n}return y(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new XC(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),ZC=function(){function e(t,n){f(this,e),this._firestore=t,this._delegate=n}return y(e,[{key:"query",get:function(){return new $C(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new XC(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new JC(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new XC(n._firestore,r))}))}},{key:"isEqual",value:function(e){return gC(this._delegate,e._delegate)}}]),e}(),eN=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return y(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new HC(this.firestore,e):null}},{key:"doc",value:function(e){try{return new HC(this.firestore,void 0===e?$T(this._delegate):$T(this._delegate,e))}catch(t){throw KC(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=BT(e.firestore,rS),r=$T(e),i=hC(e.converter,t);return TC(n,[xS(bS(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Qk.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new HC(t.firestore,e)}))}},{key:"isEqual",value:function(e){return JT(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(WC.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}($C);function tN(e){return BT(e,GT)}var nN=function(){function e(){f(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=x(dS,n)}return y(e,[{key:"isEqual",value:function(e){return(e=vn(e))instanceof dS&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(Iy.keyField().canonicalString())}}]),e}(),rN=function(){function e(t){f(this,e),this._delegate=t}return y(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new TS("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new IS("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=PC.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=DC.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=new NS("increment",t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),iN={Firestore:jC,GeoPoint:vS,Timestamp:ky,Blob:FC,Transaction:BC,WriteBatch:zC,DocumentReference:HC,DocumentSnapshot:YC,Query:$C,QueryDocumentSnapshot:XC,QuerySnapshot:ZC,CollectionReference:eN,FieldPath:nN,FieldValue:rN,setLogLevel:function(e){var t;t=e,Qv.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!function(e){!function(e,t){e.INTERNAL.registerComponent(new kn("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},iN)))}(e,(function(e,t){return new jC(e,t,new VC)})),e.registerVersion("@firebase/firestore-compat","0.3.10")}(Gr);var aN,oN="firebasestorage.googleapis.com",uN="storageBucket",sN=function(e){g(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return f(this,n),(i=t.call(this,cN(e),"Firebase Storage: ".concat(r," (").concat(cN(e),")"))).status_=a,i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(w(i),n.prototype),i}return y(n,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return cN(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),n}(Wt);function cN(e){return"storage/"+e}function lN(){return new sN(aN.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function hN(){return new sN(aN.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function fN(){return new sN(aN.CANCELED,"User canceled the upload/download.")}function dN(){return new sN(aN.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function pN(e){return new sN(aN.INVALID_ARGUMENT,e)}function vN(){return new sN(aN.APP_DELETED,"The Firebase app was deleted.")}function yN(e){return new sN(aN.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mN(e,t){return new sN(aN.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function gN(e){throw new sN(aN.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(aN||(aN={}));var kN,_N=function(){function e(t,n){f(this,e),this.bucket=t,this.path_=n}return y(e,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(t,n){var r,i;try{r=e.makeFromUrl(t,n)}catch(a){return new e(t,"")}if(""===r.path)return r;throw i=t,new sN(aN.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}},{key:"makeFromUrl",value:function(t,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var a=new RegExp("^gs://"+i+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var u=n.replace(/[.]/g,"\\."),s=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(u,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===oN?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<s.length;c++){var l=s[c],h=l.regex.exec(t);if(h){var f=h[l.indices.bucket],d=h[l.indices.path];d||(d=""),r=new e(f,d),l.postModify(r);break}}if(null==r)throw function(e){return new sN(aN.INVALID_URL,"Invalid URL '"+e+"'.")}(t);return r}}]),e}(),wN=function(){function e(t){f(this,e),this.promise_=Promise.reject(t)}return y(e,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),e}();function bN(e){return"string"===typeof e||e instanceof String}function xN(e){return IN()&&e instanceof Blob}function IN(){return"undefined"!==typeof Blob&&!Ut()}function EN(e,t,n,r){if(r<t)throw pN("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw pN("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function TN(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function SN(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function CN(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(kN||(kN={}));var NN=function(){function e(t,n,r,i,a,o,u,s,c,l,h){var d=this,p=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];f(this,e),this.url_=t,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=o,this.callback_=u,this.errorCallback_=s,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){d.resolve_=e,d.reject_=t,d.start_()}))}return y(e,[{key:"start_",value:function(){var e=this,t=function(t,n){var r=e.resolve_,i=e.reject_,a=n.connection;if(n.wasSuccessCode)try{var o=e.callback_(a,a.getResponse());!function(e){return void 0!==e}(o)?r():r(o)}catch(s){i(s)}else if(null!==a){var u=lN();u.serverResponse=a.getErrorText(),e.errorCallback_?i(e.errorCallback_(a,u)):i(u)}else{if(n.canceled)i(e.appDelete_?vN():fN());else i(hN())}};this.canceled_?t(0,new RN(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,i=null,a=null,o=!1,u=0;function s(){return 2===u}var c=!1;function l(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout((function(){i=null,e(d,s())}),t)}function f(){a&&clearTimeout(a)}function d(e){if(c)f();else{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return f(),void l.call.apply(l,[null,e].concat(n));var a;if(s()||o)return f(),void l.call.apply(l,[null,e].concat(n));r<64&&(r*=2),1===u?(u=2,a=0):a=1e3*(r+Math.random()),h(a)}}var p=!1;function v(e){p||(p=!0,f(),c||(null!==i?(e||(u=2),clearTimeout(i),h(0)):e||(u=1)))}return h(0),a=setTimeout((function(){o=!0,v(!0)}),n),v}((function(t,n){if(n)t(!1,new RN(!1,null,!0));else{var r=e.connectionFactory_();e.pendingConnection_=r;var i=function(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)};null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(){null!==e.progressCallback_&&r.removeUploadProgressListener(i),e.pendingConnection_=null;var n=r.getErrorCode()===kN.NO_ERROR,a=r.getStatus();if(!n||CN(a,e.additionalRetryCodes_)&&e.retry){var o=r.getErrorCode()===kN.ABORT;t(!1,new RN(!1,null,o))}else{var u=-1!==e.successCodes_.indexOf(a);t(!0,new RN(u,r))}}))}}),t,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),e}(),RN=y((function e(t,n,r){f(this,e),this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}));function AN(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function PN(){for(var e=AN(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){for(var i=new e,a=0;a<n.length;a++)i.append(n[a]);return i.getBlob()}if(IN())return new Blob(n);throw new sN(aN.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function DN(e){if("undefined"===typeof atob)throw t="base-64",new sN(aN.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}var ON={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},LN=y((function e(t,n){f(this,e),this.data=t,this.contentType=n||null}));function MN(e,t){switch(e){case ON.RAW:return new LN(FN(t));case ON.BASE64:case ON.BASE64URL:return new LN(UN(e,t));case ON.DATA_URL:return new LN(function(e){var t=new VN(e);return t.base64?UN(ON.BASE64,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(n){throw mN(ON.DATA_URL,"Malformed data URL.")}return FN(t)}(t.rest)}(t),new VN(t).contentType)}throw lN()}function FN(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function UN(e,t){switch(e){case ON.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw mN(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case ON.BASE64URL:var i=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(i||a)throw mN(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=DN(t)}catch(c){if(c.message.includes("polyfill"))throw c;throw mN(e,"Invalid character found")}for(var u=new Uint8Array(o.length),s=0;s<o.length;s++)u[s]=o.charCodeAt(s);return u}var VN=y((function e(t){f(this,e),this.base64=!1,this.contentType=null;var n=t.match(/^data:([^,]+)?,/);if(null===n)throw mN(ON.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}));var jN=function(){function e(t,n){f(this,e);var r=0,i="";xN(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}return y(e,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(t,n){if(xN(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}var i=new Uint8Array(this.data_.buffer,t,n-t);return new e(i,!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(IN()){var i=n.map((function(t){return t instanceof e?t.data_:t}));return new e(PN.apply(null,i))}var a=n.map((function(e){return bN(e)?MN(ON.RAW,e).data:e.data_})),o=0;a.forEach((function(e){o+=e.byteLength}));var u=new Uint8Array(o),s=0;return a.forEach((function(e){for(var t=0;t<e.length;t++)u[s++]=e[t]})),new e(u,!0)}}]),e}();function qN(e){var t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function BN(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function zN(e,t){return t}var WN=y((function e(t,n,r,i){f(this,e),this.server=t,this.local=n||t,this.writable=!!r,this.xform=i||zN})),HN=null;function KN(){if(HN)return HN;var e=[];e.push(new WN("bucket")),e.push(new WN("generation")),e.push(new WN("metageneration")),e.push(new WN("name","fullPath",!0));var t=new WN("name");t.xform=function(e,t){return function(e){return!bN(e)||e.length<2?e:BN(e)}(t)},e.push(t);var n=new WN("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new WN("timeCreated")),e.push(new WN("updated")),e.push(new WN("md5Hash",null,!0)),e.push(new WN("cacheControl",null,!0)),e.push(new WN("contentDisposition",null,!0)),e.push(new WN("contentEncoding",null,!0)),e.push(new WN("contentLanguage",null,!0)),e.push(new WN("contentType",null,!0)),e.push(new WN("metadata","customMetadata",!0)),HN=e}function GN(e,t,n){for(var r={type:"file"},i=n.length,a=0;a<i;a++){var o=n[a];r[o.local]=o.xform(r,t[o.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new _N(n,r);return t._makeStorageReference(i)}})}(r,e),r}function QN(e,t,n){var r=qN(t);return null===r?null:GN(e,r,n)}function YN(e,t){for(var n={},r=t.length,i=0;i<r;i++){var a=t[i];a.writable&&(n[a.server]=e[a.local])}return JSON.stringify(n)}var XN="prefixes",$N="items";function JN(e,t,n){var r=qN(n);return null===r?null:function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[XN]){var i,a=T(n[XN]);try{for(a.s();!(i=a.n()).done;){var o=i.value.replace(/\/$/,""),u=e._makeStorageReference(new _N(t,o));r.prefixes.push(u)}}catch(f){a.e(f)}finally{a.f()}}if(n[$N]){var s,c=T(n[$N]);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=e._makeStorageReference(new _N(t,l.name));r.items.push(h)}}catch(f){c.e(f)}finally{c.f()}}return r}(e,t,r)}var ZN=y((function e(t,n,r,i){f(this,e),this.url=t,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function eR(e){if(!e)throw lN()}function tR(e,t){return function(n,r){var i=QN(e,r,t);return eR(null!==i),i}}function nR(e,t){return function(n,r){var i=QN(e,r,t);return eR(null!==i),function(e,t,n,r){var i=qN(t);if(null===i)return null;if(!bN(i.downloadTokens))return null;var a=i.downloadTokens;if(0===a.length)return null;var o=encodeURIComponent;return a.split(",").map((function(t){var i=e.bucket,a=e.fullPath;return TN("/b/"+o(i)+"/o/"+o(a),n,r)+SN({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function rR(e){return function(t,n){var r,i,a;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new sN(aN.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new sN(aN.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,r=new sN(aN.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new sN(aN.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function iR(e){var t=rR(e);return function(n,r){var i,a=t(n,r);return 404===n.getStatus()&&(i=e.path,a=new sN(aN.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),a.serverResponse=r.serverResponse,a}}function aR(e,t,n){var r=TN(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new ZN(r,"GET",tR(e,n),i);return a.errorHandler=iR(t),a}function oR(e,t,n,r,i){var a={};t.isRoot?a.prefix="":a.prefix=t.path+"/",n&&n.length>0&&(a.delimiter=n),r&&(a.pageToken=r),i&&(a.maxResults=i);var o=TN(t.bucketOnlyServerUrl(),e.host,e._protocol),u=e.maxOperationRetryTime,s=new ZN(o,"GET",function(e,t){return function(n,r){var i=JN(e,t,r);return eR(null!==i),i}}(e,t.bucket),u);return s.urlParams=a,s.errorHandler=rR(t),s}function uR(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function sR(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};var u=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+u;var s=uR(t,r,i),c="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+YN(s,n)+"\r\n--"+u+"\r\nContent-Type: "+s.contentType+"\r\n\r\n",l="\r\n--"+u+"--",h=jN.getBlob(c,r,l);if(null===h)throw dN();var f={name:s.fullPath},d=TN(a,e.host,e._protocol),p=e.maxUploadRetryTime,v=new ZN(d,"POST",tR(e,n),p);return v.urlParams=f,v.headers=o,v.body=h.uploadData(),v.errorHandler=rR(t),v}var cR=y((function e(t,n,r,i){f(this,e),this.current=t,this.total=n,this.finalized=!!r,this.metadata=i||null}));function lR(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){eR(!1)}return eR(!!n&&-1!==(t||["active"]).indexOf(n)),n}var hR=262144;function fR(e,t,n,r,i,a,o,u){var s=new cR(0,0);if(o?(s.current=o.current,s.total=o.total):(s.current=0,s.total=r.size()),r.size()!==s.total)throw new sN(aN.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=s.total-s.current,l=c;i>0&&(l=Math.min(l,i));var h=s.current,f=h+l,d={"X-Goog-Upload-Command":0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":"".concat(s.current)},p=r.slice(h,f);if(null===p)throw dN();var v=t.maxUploadRetryTime,y=new ZN(n,"POST",(function(e,n){var i,o=lR(e,["active","final"]),u=s.current+l,c=r.size();return i="final"===o?tR(t,a)(e,n):null,new cR(u,c,"final"===o,i)}),v);return y.headers=d,y.body=p.uploadData(),y.progressCallback=u||null,y.errorHandler=rR(e),y}var dR={STATE_CHANGED:"state_changed"},pR={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function vR(e){switch(e){case"running":case"pausing":case"canceling":return pR.RUNNING;case"paused":return pR.PAUSED;case"success":return pR.SUCCESS;case"canceled":return pR.CANCELED;default:return pR.ERROR}}var yR=y((function e(t,n,r){f(this,e);var i=function(e){return"function"===typeof e}(t)||null!=n||null!=r;if(i)this.next=t,this.error=null!==n&&void 0!==n?n:void 0,this.complete=null!==r&&void 0!==r?r:void 0;else{var a=t;this.next=a.next,this.error=a.error,this.complete=a.complete}}));function mR(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((function(){return e.apply(void 0,n)}))}}var gR=null,kR=function(){function e(){var t=this;f(this,e),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kN.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=kN.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=kN.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return y(e,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw gN("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw gN("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw gN("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw gN("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw gN("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),e}(),_R=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),n}(kR);function wR(){return gR?gR():new _R}var bR=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;f(this,e),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=n,this._metadata=i,this._mappings=KN(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){if(r._request=void 0,r._chunkMultiplier=1,e._codeEquals(aN.CANCELED))r._needToFetchStatus=!0,r.completeTransitions_();else{var t=r.isExponentialBackoffExpired();if(CN(e.status,[])){if(!t)return r.sleepTime=Math.max(2*r.sleepTime,1e3),r._needToFetchStatus=!0,void r.completeTransitions_();e=hN()}r._error=e,r._transition("error")}},this._metadataErrorHandler=function(e){r._request=void 0,e._codeEquals(aN.CANCELED)?r.completeTransitions_():(r._error=e,r._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t,r._start()})),this._promise.then(null,(function(){}))}return y(e,[{key:"isExponentialBackoffExpired",value:function(){return this.sleepTime>this.maxSleepTime}},{key:"_makeProgressCallback",value:function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}}},{key:"_shouldDoResumable",value:function(e){return e.size()>262144}},{key:"_start",value:function(){var e=this;"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((function(){e.pendingTimeout=void 0,e._continueUpload()}),this.sleepTime):this._oneShotUpload())}},{key:"_resolveToken",value:function(e){var t=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=c(n,2),i=r[0],a=r[1];switch(t._state){case"running":e(i,a);break;case"canceling":t._transition("canceled");break;case"pausing":t._transition("paused")}}))}},{key:"_createResumable",value:function(){var e=this;this._resolveToken((function(t,n){var r=function(e,t,n,r,i){var a=t.bucketOnlyServerUrl(),o=uR(t,r,i),u={name:o.fullPath},s=TN(a,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=YN(o,n),h=e.maxUploadRetryTime,f=new ZN(s,"POST",(function(e){var t;lR(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){eR(!1)}return eR(bN(t)),t}),h);return f.urlParams=u,f.headers=c,f.body=l,f.errorHandler=rR(t),f}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,wR,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()}),e._errorHandler)}))}},{key:"_fetchStatus",value:function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n,r){var i=function(e,t,n,r){var i=e.maxUploadRetryTime,a=new ZN(n,"POST",(function(e){var t=lR(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(a){eR(!1)}n||eR(!1);var i=Number(n);return eR(!isNaN(i)),new cR(i,r.size(),"final"===t)}),i);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=rR(t),a}(e._ref.storage,e._ref._location,t,e._blob),a=e._ref.storage._makeRequest(i,wR,n,r);e._request=a,a.getPromise().then((function(t){e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()}),e._errorHandler)}))}},{key:"_continueUpload",value:function(){var e=this,t=hR*this._chunkMultiplier,n=new cR(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,a){var o;try{o=fR(e._ref._location,e._ref.storage,r,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(s){return e._error=s,void e._transition("error")}var u=e._ref.storage._makeRequest(o,wR,i,a,!1);e._request=u,u.getPromise().then((function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition("success")):e.completeTransitions_()}),e._errorHandler)}))}},{key:"_increaseMultiplier",value:function(){2*(hR*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}},{key:"_fetchMetadata",value:function(){var e=this;this._resolveToken((function(t,n){var r=aR(e._ref.storage,e._ref._location,e._mappings),i=e._ref.storage._makeRequest(r,wR,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._transition("success")}),e._metadataErrorHandler)}))}},{key:"_oneShotUpload",value:function(){var e=this;this._resolveToken((function(t,n){var r=sR(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(r,wR,t,n);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition("success")}),e._errorHandler)}))}},{key:"_updateProgress",value:function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}},{key:"_transition",value:function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=fN(),this._state=e,this._notifyObservers()}}},{key:"completeTransitions_",value:function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}},{key:"snapshot",get:function(){var e=vR(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}},{key:"on",value:function(e,t,n,r){var i=this,a=new yR(t||void 0,n||void 0,r||void 0);return this._addObserver(a),function(){i._removeObserver(a)}}},{key:"then",value:function(e,t){return this._promise.then(e,t)}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"_addObserver",value:function(e){this._observers.push(e),this._notifyObserver(e)}},{key:"_removeObserver",value:function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}},{key:"_notifyObservers",value:function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))}},{key:"_finishPromise",value:function(){if(void 0!==this._resolve){var e=!0;switch(vR(this._state)){case pR.SUCCESS:mR(this._resolve.bind(null,this.snapshot))();break;case pR.CANCELED:case pR.ERROR:mR(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}},{key:"_notifyObserver",value:function(e){switch(vR(this._state)){case pR.RUNNING:case pR.PAUSED:e.next&&mR(e.next.bind(e,this.snapshot))();break;case pR.SUCCESS:e.complete&&mR(e.complete.bind(e))();break;default:e.error&&mR(e.error.bind(e,this._error))()}}},{key:"resume",value:function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}},{key:"pause",value:function(){var e="running"===this._state;return e&&this._transition("pausing"),e}},{key:"cancel",value:function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}]),e}(),xR=function(){function e(t,n){f(this,e),this._service=t,this._location=n instanceof _N?n:_N.makeFromUrl(n,t.host)}return y(e,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(t,n){return new e(t,n)}},{key:"root",get:function(){var e=new _N(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return BN(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new _N(this._location.bucket,t);return new e(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw yN(e)}}]),e}();function IR(e,t,n){return ER.apply(this,arguments)}function ER(){return(ER=gn(yn().mark((function e(t,n,r){var i,a,o,u;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={pageToken:r},e.next=3,TR(t,o);case 3:if(u=e.sent,(i=n.prefixes).push.apply(i,h(u.prefixes)),(a=n.items).push.apply(a,h(u.items)),null==u.nextPageToken){e.next=9;break}return e.next=9,IR(t,n,u.nextPageToken);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TR(e,t){null!=t&&"number"===typeof t.maxResults&&EN("options.maxResults",1,1e3,t.maxResults);var n=t||{},r=oR(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,wR)}function SR(e,t){e._throwIfRoot("updateMetadata");var n=function(e,t,n,r){var i=TN(t.fullServerUrl(),e.host,e._protocol),a=YN(n,r),o=e.maxOperationRetryTime,u=new ZN(i,"PATCH",tR(e,r),o);return u.headers={"Content-Type":"application/json; charset=utf-8"},u.body=a,u.errorHandler=iR(t),u}(e.storage,e._location,t,KN());return e.storage.makeRequestWithTokens(n,wR)}function CR(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=TN(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,a=new ZN(r,"GET",nR(e,n),i);return a.errorHandler=iR(t),a}(e.storage,e._location,KN());return e.storage.makeRequestWithTokens(t,wR).then((function(e){if(null===e)throw new sN(aN.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function NR(e){e._throwIfRoot("deleteObject");var t=function(e,t){var n=TN(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new ZN(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=iR(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,wR)}function RR(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new _N(e._location.bucket,n);return new xR(e.storage,r)}function AR(e,t){if(e instanceof OR){var n=e;if(null==n._bucket)throw new sN(aN.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uN+"' property when initializing the app?");var r=new xR(n,n._bucket);return null!=t?AR(r,t):r}return void 0!==t?RR(e,t):e}function PR(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof OR)return new xR(e,t);throw pN("To use ref(service, url), the first argument must be a Storage instance.")}return AR(e,t)}function DR(e,t){var n=null===t||void 0===t?void 0:t[uN];return null==n?null:_N.makeFromBucketSpec(n,e)}var OR=function(){function e(t,n,r,i,a){f(this,e),this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=oN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?_N.makeFromBucketSpec(i,this._host):DR(this._host,this.app.options)}return y(e,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=_N.makeFromBucketSpec(this._url,e):this._bucket=DR(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){EN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){EN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._overrideAuthToken){e.next=2;break}return e.abrupt("return",this._overrideAuthToken);case 2:if(!(t=this._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,t.getToken();case 6:if(null===(n=e.sent)){e.next=9;break}return e.abrupt("return",n.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=gn(yn().mark((function e(){var t,n;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,t.getToken();case 4:return n=e.sent,e.abrupt("return",n.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new xR(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var i=this,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new wN(vN());var o=function(e,t,n,r,i,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=SN(e.urlParams),s=e.url+u,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new NN(s,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,a);return this._requests.add(o),o.getPromise().then((function(){return i._requests.delete(o)}),(function(){return i._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(){var e=gn(yn().mark((function e(t,n){var r,i,a,o;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return r=e.sent,i=c(r,2),a=i[0],o=i[1],e.abrupt("return",this._makeRequest(t,n,a,o).getPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),LR="@firebase/storage",MR="0.11.2",FR="storage";function UR(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new bR(e,new jN(t),n)}(e=vn(e),t,n)}function VR(e){return function(e){e._throwIfRoot("getMetadata");var t=aR(e.storage,e._location,KN());return e.storage.makeRequestWithTokens(t,wR)}(e=vn(e))}function jR(e){return function(e){var t={prefixes:[],items:[]};return IR(e,t).then((function(){return t}))}(e=vn(e))}function qR(e,t){return PR(e=vn(e),t)}function BR(e,t,n){!function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var i=r.mockUserToken;i&&(e._overrideAuthToken="string"===typeof i?i:Lt(i,e.app.options.projectId))}(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}function zR(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new OR(r,i,a,n,vr)}sr(new kn(FR,zR,"PUBLIC").setMultipleInstances(!0)),wr(LR,MR,""),wr(LR,MR,"esm2017");var WR=function(){function e(t,n,r){f(this,e),this._delegate=t,this.task=n,this.ref=r}return y(e,[{key:"bytesTransferred",get:function(){return this._delegate.bytesTransferred}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"state",get:function(){return this._delegate.state}},{key:"totalBytes",get:function(){return this._delegate.totalBytes}}]),e}(),HR=function(){function e(t,n){f(this,e),this._delegate=t,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return y(e,[{key:"snapshot",get:function(){return new WR(this._delegate.snapshot,this,this._ref)}},{key:"then",value:function(e,t){var n=this;return this._delegate.then((function(t){if(e)return e(new WR(t,n,n._ref))}),t)}},{key:"on",value:function(e,t,n,r){var i=this,a=void 0;return t&&(a="function"===typeof t?function(e){return t(new WR(e,i,i._ref))}:{next:t.next?function(e){return t.next(new WR(e,i,i._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,n||void 0,r||void 0)}}]),e}(),KR=function(){function e(t,n){f(this,e),this._delegate=t,this._service=n}return y(e,[{key:"prefixes",get:function(){var e=this;return this._delegate.prefixes.map((function(t){return new GR(t,e._service)}))}},{key:"items",get:function(){var e=this;return this._delegate.items.map((function(t){return new GR(t,e._service)}))}},{key:"nextPageToken",get:function(){return this._delegate.nextPageToken||null}}]),e}(),GR=function(){function e(t,n){f(this,e),this._delegate=t,this.storage=n}return y(e,[{key:"name",get:function(){return this._delegate.name}},{key:"bucket",get:function(){return this._delegate.bucket}},{key:"fullPath",get:function(){return this._delegate.fullPath}},{key:"toString",value:function(){return this._delegate.toString()}},{key:"child",value:function(t){var n=function(e,t){return RR(e,t)}(this._delegate,t);return new e(n,this.storage)}},{key:"root",get:function(){return new e(this._delegate.root,this.storage)}},{key:"parent",get:function(){var t=this._delegate.parent;return null==t?null:new e(t,this.storage)}},{key:"put",value:function(e,t){return this._throwIfRoot("put"),new HR(UR(this._delegate,e,t),this)}},{key:"putString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ON.RAW,n=arguments.length>2?arguments[2]:void 0;this._throwIfRoot("putString");var r=MN(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new HR(new bR(this._delegate,new jN(r.data,!0),i),this)}},{key:"listAll",value:function(){var e=this;return jR(this._delegate).then((function(t){return new KR(t,e.storage)}))}},{key:"list",value:function(e){var t=this;return function(e,t){return TR(e=vn(e),t)}(this._delegate,e||void 0).then((function(e){return new KR(e,t.storage)}))}},{key:"getMetadata",value:function(){return VR(this._delegate)}},{key:"updateMetadata",value:function(e){return function(e,t){return SR(e=vn(e),t)}(this._delegate,e)}},{key:"getDownloadURL",value:function(){return CR(vn(this._delegate))}},{key:"delete",value:function(){return this._throwIfRoot("delete"),NR(vn(this._delegate))}},{key:"_throwIfRoot",value:function(e){if(""===this._delegate._location.path)throw yN(e)}}]),e}(),QR=function(){function e(t,n){f(this,e),this.app=t,this._delegate=n}return y(e,[{key:"maxOperationRetryTime",get:function(){return this._delegate.maxOperationRetryTime}},{key:"maxUploadRetryTime",get:function(){return this._delegate.maxUploadRetryTime}},{key:"ref",value:function(e){if(YR(e))throw pN("ref() expected a child path but got a URL, use refFromURL instead.");return new GR(qR(this._delegate,e),this)}},{key:"refFromURL",value:function(e){if(!YR(e))throw pN("refFromURL() expected a full URL but got a child path, use ref() instead.");try{_N.makeFromUrl(e,this._delegate.host)}catch(t){throw pN("refFromUrl() expected a valid full URL but got an invalid one.")}return new GR(qR(this._delegate,e),this)}},{key:"setMaxUploadRetryTime",value:function(e){this._delegate.maxUploadRetryTime=e}},{key:"setMaxOperationRetryTime",value:function(e){this._delegate.maxOperationRetryTime=e}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};BR(this._delegate,e,t,n)}}]),e}();function YR(e){return/^[A-Za-z]+:\/\//.test(e)}function XR(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("storage").getImmediate({identifier:n});return new QR(r,i)}!function(e){var t={TaskState:pR,TaskEvent:dR,StringFormat:ON,Storage:QR,Reference:GR};e.INTERNAL.registerComponent(new kn("storage-compat",XR,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.2")}(Gr);var $R="@firebase/database",JR="0.14.4",ZR="";function eA(e){ZR=e}var tA=function(){function e(t){f(this,e),this.domStorage_=t,this.prefix_="firebase:"}return y(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Qt(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Gt(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),nA=function(){function e(){f(this,e),this.cache_={},this.isInMemoryStorage=!0}return y(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return Xt(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),rA=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new tA(t)}}catch(n){}return new nA},iA=rA("localStorage"),aA=rA("sessionStorage"),oA=new Rn("@firebase/database"),uA=function(){var e=1;return function(){return e++}}(),sA=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,bt(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new on;n.update(t);var r=n.digest();return Et.encodeByteArray(r)},cA=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?Qt(r):r,t+=" "}return t},lA=null,hA=!0,fA=function(e,t){bt(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(oA.logLevel=xn.VERBOSE,lA=oA.log.bind(oA),t&&aA.set("logging_enabled",!0)):"function"===typeof e?lA=e:(lA=null,aA.remove("logging_enabled"))},dA=function(){if(!0===hA&&(hA=!1,null===lA&&!0===aA.get("logging_enabled")&&fA(!0)),lA){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=cA.apply(null,t);lA(r)}},pA=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];dA.apply(void 0,[e].concat(n))}},vA=function(){var e="FIREBASE INTERNAL ERROR: "+cA.apply(void 0,arguments);oA.error(e)},yA=function(){var e="FIREBASE FATAL ERROR: ".concat(cA.apply(void 0,arguments));throw oA.error(e),new Error(e)},mA=function(){var e="FIREBASE WARNING: "+cA.apply(void 0,arguments);oA.warn(e)},gA=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},kA="[MIN_NAME]",_A="[MAX_NAME]",wA=function(e,t){if(e===t)return 0;if(e===kA||t===_A)return-1;if(t===kA||e===_A)return 1;var n=NA(e),r=NA(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},bA=function(e,t){return e===t?0:e<t?-1:1},xA=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Qt(t))},IA=function e(t){if("object"!==typeof t||null===t)return Qt(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=Qt(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},EA=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function TA(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var SA=function(e){bt(!gA(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(t?1:0),u.reverse();var s=u.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var CA=new RegExp("^-?(0*)\\d{1,10}$"),NA=function(e){if(CA.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},RA=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw mA("Exception was thrown by user callback.",e),t}),Math.floor(0))}},AA=function(e,t){var n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n},PA=function(){function e(t,n){var r=this;f(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return y(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){mA('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),DA=function(){function e(t,n,r){var i=this;f(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return i.auth_=e}))}return y(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(dA("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',mA(e)}}]),e}(),OA=function(){function e(t){f(this,e),this.accessToken=t}return y(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();OA.OWNER="owner";var LA="5",MA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,FA="ac",UA="websocket",VA="long_polling",jA=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];f(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=iA.get("host:"+t)||this._host}return y(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&iA.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function qA(e,t,n){var r;if(bt("string"===typeof t,"typeof type must == string"),bt("object"===typeof n,"typeof params must == object"),t===UA)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==VA)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return TA(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var BA=function(){function e(){f(this,e),this.counters_={}}return y(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Xt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return Rt(void 0,this.counters_)}}]),e}(),zA={},WA={};function HA(e){var t=e.toString();return zA[t]||(zA[t]=new BA),zA[t]}var KA=function(){function e(t){f(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return y(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&RA((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),GA="start",QA=function(){function e(t,n,r,i,a,o,u){var s=this;f(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pA(t),this.stats_=HA(n),this.urlFn=function(e){return s.appCheckToken&&(e[FA]=s.appCheckToken),qA(n,VA,e)}}return y(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new KA(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Bt()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new YA((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===GA)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var e={};e[GA]="t",e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=LA,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e[FA]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&MA.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=Qt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=St(t),r=EA(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!Bt()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=Qt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!Bt()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),YA=function(){function e(t,n,r,i){if(f(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Bt())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=uA(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11))a='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){dA("frame writing exception"),u.stack&&dA(u.stack),dA(u)}}}return y(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;Bt()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){dA("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||dA("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),XA=null;"undefined"!==typeof MozWebSocket?XA=MozWebSocket:"undefined"!==typeof WebSocket&&(XA=WebSocket);var $A=function(){function e(t,n,r,i,a,o,u){f(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pA(this.connId),this.stats_=HA(n),this.connURL=e.connectionURL_(n,o,u,i,r),this.nodeAdmin=n.nodeAdmin}return y(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,iA.set("previous_websocket_failure",!0);try{var r;if(Bt()){var i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(LA,"/").concat(ZR,"/").concat(process.platform,"/").concat(i),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"/Make-Tasty-App",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new XA(this.connURL,[],r)}catch(s){this.log_("Error instantiating WebSocket.");var u=s.message||s.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){iA.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Gt(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(bt(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=Qt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=EA(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=LA,!Bt()&&"undefined"!==typeof location&&location.hostname&&MA.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a[FA]=r),i&&(a.p=i),qA(e,UA,a)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==XA&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return iA.isInMemoryStorage||!0===iA.get("previous_websocket_failure")}}]),e}();$A.responsesRequiredToBeHealthy=2,$A.healthyTimeout=3e4;var JA=function(){function e(t){f(this,e),this.initTransports_(t)}return y(e,[{key:"initTransports_",value:function(t){var n=$A&&$A.isAvailable(),r=n&&!$A.previouslyFailed();if(t.webSocketOnly&&(n||mA("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[$A];else{var i,a=this.transports_=[],o=T(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var u=i.value;u&&u.isAvailable()&&a.push(u)}}catch(s){o.e(s)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[QA,$A]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();JA.globalTransportInitialized_=!1;var ZA=function(){function e(t,n,r,i,a,o,u,s,c,l){f(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=s,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pA("c:"+this.id+":"),this.transportManager_=new JA(n),this.log_("Connection created"),this.start_()}return y(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=AA((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=xA("t",e),n=xA("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=xA("t",e),n=xA("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=xA("t",e);if("d"in e){var n=e.d;if("h"===t){var r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?vA("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vA("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),LA!==n&&mA("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),AA((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):AA((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(iA.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),eP=function(){function e(){f(this,e)}return y(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),tP=function(){function e(t){f(this,e),this.allowedEvents_=t,this.listeners_={},bt(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return y(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=h(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){bt(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),nP=function(e){g(n,e);var t=b(n);function n(){var e;return f(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Ft()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return y(n,[{key:"getInitialEvent",value:function(e){return bt("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(tP),rP=32,iP=768,aP=function(){function e(t,n){if(f(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return y(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function oP(){return new aP("")}function uP(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function sP(e){return e.pieces_.length-e.pieceNum_}function cP(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new aP(e.pieces_,t)}function lP(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function hP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function fP(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new aP(t,0)}function dP(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof aP)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new aP(n,0)}function pP(e){return e.pieceNum_>=e.pieces_.length}function vP(e,t){var n=uP(e),r=uP(t);if(null===n)return t;if(n===r)return vP(cP(e),cP(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function yP(e,t){for(var n=hP(e,0),r=hP(t,0),i=0;i<n.length&&i<r.length;i++){var a=wA(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function mP(e,t){if(sP(e)!==sP(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function gP(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(sP(e)>sP(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var kP=y((function e(t,n){f(this,e),this.errorPrefix_=n,this.parts_=hP(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=pn(this.parts_[r]);_P(this)}));function _P(e){if(e.byteLength_>iP)throw new Error(e.errorPrefix_+"has a key path longer than "+iP+" bytes ("+e.byteLength_+").");if(e.parts_.length>rP)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+rP+") or object contains a cycle "+wP(e))}function wP(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var bP=function(e){g(n,e);var t=b(n);function n(){var e,r,i;return f(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(i="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(i="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return y(n,[{key:"getInitialEvent",value:function(e){return bt("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(tP),xP=1e3,IP=function(e){g(n,e);var t=b(n);function n(e,r,i,a,o,u,s,c){var l;if(f(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=u,l.appCheckTokenProvider_=s,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=pA("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=xP,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!Bt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return bP.getInstance().on("visible",l.onVisible_,w(l)),-1===e.host.indexOf("fblocal")&&nP.getInstance().on("online",l.onOnline_,w(l)),l}return y(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Qt(i)),bt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new Ot,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),bt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),bt(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var u=o.d,s=o.s;n.warnOnListenWarnings_(u,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==s&&t.removeListen_(i,a),e.onComplete&&e.onComplete(s,u))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=Yt(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=Yt(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),bt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+Qt(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):vA("Unrecognized action received from server: "+Qt(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;bt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xP,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xP,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=xP),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=gn(yn().mark((function e(){var t,r,i,a,o,u,s,l,h,f,d,p,v,y,m=this;return yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,u=!1,s=null,l=function(){s?s.close():(u=!0,i())},h=function(e){bt(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)},this.realtime_={close:l,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);case 19:d=e.sent,p=c(d,2),v=p[0],y=p[1],u?dA("getToken() completed but was canceled"):(dA("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=y&&y.token,s=new ZA(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,(function(e){mA(e+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),o)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),u||(this.repoInfo_.nodeAdmin&&mA(e.t0),l());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){dA("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){dA("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Jt(this.interruptReasons_)&&(this.reconnectDelay_=xP,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return IA(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new aP(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){dA("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){dA("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=T(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=T(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(s){r.e(s)}finally{r.f()}}}catch(s){t.e(s)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)}},{key:"sendConnectStats_",value:function(){var e={},t="js";Bt()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+ZR.replace(/\./g,"-")]=1,Ft()?e["framework.cordova"]=1:jt()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=nP.getInstance().currentlyOnline();return Jt(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&Xt(e,"w")){var n=$t(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();mA("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),n}(eP);IP.nextPersistentConnectionId_=0,IP.nextConnectionId_=0;var EP,TP=function(){function e(t,n){f(this,e),this.name=t,this.node=n}return y(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),SP=function(){function e(){f(this,e)}return y(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new TP(kA,e),r=new TP(kA,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return TP.MIN}}]),e}(),CP=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"compare",value:function(e,t){return wA(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw xt("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return TP.MIN}},{key:"maxPost",value:function(){return new TP(_A,EP)}},{key:"makePost",value:function(e,t){return bt("string"===typeof e,"KeyIndex indexValue must always be a string."),new TP(e,EP)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return EP},set:function(e){EP=e}}]),n}(SP),NP=new CP,RP=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;f(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return y(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),AP=function(){function e(t,n,r,i,a){f(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:OP.EMPTY_NODE,this.right=null!=a?a:OP.EMPTY_NODE}return y(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return OP.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return OP.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();AP.RED=!0,AP.BLACK=!1;var PP,DP=function(){function e(){f(this,e)}return y(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new AP(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),OP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;f(this,e),this.comparator_=t,this.root_=n}return y(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,AP.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,AP.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new RP(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new RP(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new RP(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new RP(this.root_,null,this.comparator_,!0,e)}}]),e}();function LP(e,t){return wA(e.name,t.name)}function MP(e,t){return wA(e,t)}OP.EMPTY_NODE=new DP;var FP,UP,VP,jP=function(e){return"number"===typeof e?"number:"+SA(e):"string:"+e},qP=function(e){if(e.isLeafNode()){var t=e.val();bt("string"===typeof t||"number"===typeof t||"object"===typeof t&&Xt(t,".sv"),"Priority must be a string or number.")}else bt(e===PP||e.isEmpty(),"priority of unexpected type.");bt(e===PP||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},BP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;f(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,bt(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),qP(this.priorityNode_)}return y(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return pP(t)?this:".priority"===uP(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=uP(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(bt(".priority"!==r||1===sP(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(cP(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+jP(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?SA(this.value_):this.value_,this.lazyHash_=sA(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(bt(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return bt(i>=0,"Unknown leaf type: "+n),bt(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return FP},set:function(e){FP=e}}]),e}();BP.VALUE_TYPE_ORDER=["object","boolean","number","string"];var zP,WP,HP=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?wA(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return TP.MIN}},{key:"maxPost",value:function(){return new TP(_A,new BP("[PRIORITY-POST]",VP))}},{key:"makePost",value:function(e,t){var n=UP(e);return new TP(t,new BP("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(SP),KP=new HP,GP=Math.log(2),QP=function(){function e(t){f(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/GP,10)),this.current_=this.count-1;var r,i=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&i}return y(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),YP=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,u=i-r;if(0===u)return null;if(1===u)return a=e[r],o=n?n(a):a,new AP(o,a.node,AP.BLACK,null,null);var s=parseInt(u/2,10)+r,c=t(r,s),l=t(s+1,i);return a=e[s],o=n?n(a):a,new AP(o,a.node,AP.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,u=function(t,r){var a=o-t,u=o;o-=t;var c=i(a+1,u),l=e[a],h=n?n(l):l;s(new AP(h,l.node,r,null,c))},s=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?u(h,AP.BLACK):(u(h,AP.BLACK),u(h,AP.RED))}return a}(new QP(e.length));return new OP(r||t,a)},XP={},$P=function(){function e(t,n){f(this,e),this.indexes_=t,this.indexSet_=n}return y(e,[{key:"get",value:function(e){var t=$t(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof OP?t:null}},{key:"hasIndex",value:function(e){return Xt(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){bt(t!==NP,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(TP.Wrap),u=o.getNext();u;)a=a||t.isDefinedOn(u.node),i.push(u),u=o.getNext();r=a?YP(i,t.getCompare()):XP;var s=t.toString(),c=Object.assign({},this.indexSet_);c[s]=t;var l=Object.assign({},this.indexes_);return l[s]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(Zt(this.indexes_,(function(e,i){var a=$t(r.indexSet_,i);if(bt(a,"Missing index implementation for "+i),e===XP){if(a.isDefinedOn(t.node)){for(var o=[],u=n.getIterator(TP.Wrap),s=u.getNext();s;)s.name!==t.name&&o.push(s),s=u.getNext();return o.push(t),YP(o,a.getCompare())}return XP}var c=n.get(t.name),l=e;return c&&(l=l.remove(new TP(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(Zt(this.indexes_,(function(e){if(e===XP)return e;var r=n.get(t.name);return r?e.remove(new TP(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return bt(XP&&KP,"ChildrenNode.ts has not been loaded"),zP=zP||new e({".priority":XP},{".priority":KP})}}]),e}(),JP=function(){function e(t,n,r){f(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&qP(this.priorityNode_),this.children_.isEmpty()&&bt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return y(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||WP}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?WP:t}},{key:"getChild",value:function(e){var t=uP(e);return null===t?this:this.getImmediateChild(t).getChild(cP(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(bt(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new TP(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?WP:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=uP(e);if(null===n)return t;bt(".priority"!==uP(e)||1===sP(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(cP(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(KP,(function(o,u){n[o]=u.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!t&&a&&i<2*r){var o=[];for(var u in n)o[u]=n[u];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+jP(this.getPriority().val())+":"),this.forEachChild(KP,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":sA(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new TP(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new TP(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new TP(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,TP.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,TP.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ZP?-1:0}},{key:"withIndex",value:function(t){if(t===NP||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===NP||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(KP),r=t.getIterator(KP),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===NP?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return WP||(WP=new e(new OP(MP),null,$P.Default))}}]),e}();JP.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var ZP=new(function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.call(this,new OP(MP),JP.EMPTY_NODE,$P.Default)}return y(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return JP.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(JP));Object.defineProperties(TP,{MIN:{value:new TP(kA,JP.EMPTY_NODE)},MAX:{value:new TP(_A,ZP)}}),CP.__EMPTY_NODE=JP.EMPTY_NODE,BP.__childrenNodeConstructor=JP,PP=ZP,function(e){VP=e}(ZP);var eD=!0;function tD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return JP.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),bt(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e)return new BP(e,tD(t));if(e instanceof Array||!eD){var n=JP.EMPTY_NODE;return TA(e,(function(t,r){if(Xt(e,t)&&"."!==t.substring(0,1)){var i=tD(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(tD(t))}var r=[],i=!1;if(TA(e,(function(e,t){if("."!==e.substring(0,1)){var n=tD(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new TP(e,n)))}})),0===r.length)return JP.EMPTY_NODE;var a=YP(r,LP,(function(e){return e.name}),MP);if(i){var o=YP(r,KP.getCompare());return new JP(a,tD(t),new $P({".priority":o},{".priority":KP}))}return new JP(a,tD(t),$P.Default)}!function(e){UP=e}(tD);var nD=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this)).indexPath_=e,bt(!pP(e)&&".priority"!==uP(e),"Can't create PathIndex with empty path or .priority key"),r}return y(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?wA(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=tD(e),r=JP.EMPTY_NODE.updateChild(this.indexPath_,n);return new TP(t,r)}},{key:"maxPost",value:function(){var e=JP.EMPTY_NODE.updateChild(this.indexPath_,ZP);return new TP(_A,e)}},{key:"toString",value:function(){return hP(this.indexPath_,0).join("/")}}]),n}(SP),rD=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?wA(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return TP.MIN}},{key:"maxPost",value:function(){return TP.MAX}},{key:"makePost",value:function(e,t){var n=tD(e);return new TP(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(SP),iD=new rD;function aD(e){return{type:"value",snapshotNode:e}}function oD(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function uD(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function sD(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var cD=function(){function e(t){f(this,e),this.index_=t}return y(e,[{key:"updateChild",value:function(e,t,n,r,i,a){bt(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(uD(t,o)):bt(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(oD(t,n)):a.trackChildChange(sD(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(KP,(function(e,r){t.hasChild(e)||n.trackChildChange(uD(e,r))})),t.isLeafNode()||t.forEachChild(KP,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(sD(t,r,i))}else n.trackChildChange(oD(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?JP.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),lD=function(){function e(t){f(this,e),this.indexedFilter_=new cD(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return y(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){var t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}},{key:"updateChild",value:function(e,t,n,r,i,a){return this.matches(new TP(t,n))||(n=JP.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,a)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=JP.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(JP.EMPTY_NODE);var i=this;return t.forEachChild(KP,(function(e,t){i.matches(new TP(e,t))||(r=r.updateImmediateChild(e,JP.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),hD=function(){function e(t){var n=this;f(this,e),this.withinDirectionalStart=function(e){return n.reverse_?n.withinEndPost(e):n.withinStartPost(e)},this.withinDirectionalEnd=function(e){return n.reverse_?n.withinStartPost(e):n.withinEndPost(e)},this.withinStartPost=function(e){var t=n.index_.compare(n.rangedFilter_.getStartPost(),e);return n.startIsInclusive_?t<=0:t<0},this.withinEndPost=function(e){var t=n.index_.compare(e,n.rangedFilter_.getEndPost());return n.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new lD(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}return y(e,[{key:"updateChild",value:function(e,t,n,r,i,a){return this.rangedFilter_.matches(new TP(t,n))||(n=JP.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,a):this.fullLimitUpdateChild_(e,t,n,i,a)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=JP.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=JP.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(this.withinDirectionalStart(o)){if(!this.withinDirectionalEnd(o))break;r=r.updateImmediateChild(o.name,o.node),a++}}}else{var u;r=(r=t.withIndex(this.index_)).updatePriority(JP.EMPTY_NODE),u=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);for(var s=0;u.hasNext();){var c=u.getNext();s<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?s++:r=r.updateImmediateChild(c.name,JP.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var u=e;bt(u.numChildren()===this.limit_,"");var s=new TP(t,n),c=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(s);if(u.hasChild(t)){for(var h=u.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||u.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:a(f,s);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(sD(t,n,h)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(uD(t,h));var p=u.updateImmediateChild(t,JP.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(oD(f.name,f.node)),p.updateImmediateChild(f.name,f.node)):p}return n.isEmpty()?e:l&&a(c,s)>=0?(null!=i&&(i.trackChildChange(uD(c.name,c.node)),i.trackChildChange(oD(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(c.name,JP.EMPTY_NODE)):e}}]),e}(),fD=function(){function e(){f(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=KP}return y(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return bt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return bt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:kA}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return bt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return bt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_A}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return bt(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===KP}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function dD(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function pD(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function vD(e,t){var n=e.copy();return n.index_=t,n}function yD(e){var t,n={};if(e.isDefault())return n;if(e.index_===KP?t="$priority":e.index_===iD?t="$value":e.index_===NP?t="$key":(bt(e.index_ instanceof nD,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Qt(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=Qt(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+Qt(e.indexStartName_))}if(e.endSet_){var i=e.endBeforeSet_?"endBefore":"endAt";n[i]=Qt(e.indexEndValue_),e.endNameSet_&&(n[i]+=","+Qt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function mD(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==KP&&(t.i=e.index_.toString()),t}var gD=function(e){g(n,e);var t=b(n);function n(e,r,i,a){var o;return f(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=pA("p:rest:"),o.listens_={},o}return y(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var u=n.getListenId_(e,r),s={};this.listens_[u]=s;var c=yD(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),$t(a.listens_,u)===s)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=yD(e._queryParams),r=e._path.toString(),i=new Ot;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=c(i,2),o=a[0],u=a[1];o&&o.accessToken&&(n.auth=o.accessToken),u&&u.token&&(n.ac=u.token);var s=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+nn(n);t.log_("Sending REST request for "+s);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(r&&4===l.readyState){t.log_("REST Response for "+s+" received. status:",l.status,"response:",l.responseText);var e=null;if(l.status>=200&&l.status<300){try{e=Gt(l.responseText)}catch(n){mA("Failed to parse JSON response for "+s+": "+l.responseText)}r(null,e)}else 401!==l.status&&404!==l.status&&mA("Got unsuccessful REST response for "+s+" Status: "+l.status),r(l.status);r=null}},l.open("GET",s,!0),l.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(bt(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(eP),kD=function(){function e(){f(this,e),this.rootNode_=JP.EMPTY_NODE}return y(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function _D(){return{value:null,children:new Map}}function wD(e,t,n){if(pP(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=uP(t);e.children.has(r)||e.children.set(r,_D()),wD(e.children.get(r),t=cP(t),n)}}function bD(e,t){if(pP(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(KP,(function(t,n){wD(e,new aP(t),n)})),bD(e,t)}if(e.children.size>0){var r=uP(t);if(t=cP(t),e.children.has(r))bD(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function xD(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){xD(r,new aP(t.toString()+"/"+e),n)}))}var ID,ED=function(){function e(t){f(this,e),this.collection_=t,this.last_=null}return y(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&TA(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),TD=function(){function e(t,n){f(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new ED(t);var r=1e4+2e4*Math.random();AA(this.reportStats_.bind(this),Math.floor(r))}return y(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;TA(t,(function(t,i){i>0&&Xt(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),AA(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function SD(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ID||(ID={}));var CD,ND=function(){function e(t,n,r){f(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=ID.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return y(e,[{key:"operationForChild",value:function(t){if(pP(this.path)){if(null!=this.affectedTree.value)return bt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new aP(t));return new e(oP(),n,this.revert)}return bt(uP(this.path)===t,"operationForChild called for unrelated child."),new e(cP(this.path),this.affectedTree,this.revert)}}]),e}(),RD=function(){function e(t,n){f(this,e),this.source=t,this.path=n,this.type=ID.LISTEN_COMPLETE}return y(e,[{key:"operationForChild",value:function(t){return pP(this.path)?new e(this.source,oP()):new e(this.source,cP(this.path))}}]),e}(),AD=function(){function e(t,n,r){f(this,e),this.source=t,this.path=n,this.snap=r,this.type=ID.OVERWRITE}return y(e,[{key:"operationForChild",value:function(t){return pP(this.path)?new e(this.source,oP(),this.snap.getImmediateChild(t)):new e(this.source,cP(this.path),this.snap)}}]),e}(),PD=function(){function e(t,n,r){f(this,e),this.source=t,this.path=n,this.children=r,this.type=ID.MERGE}return y(e,[{key:"operationForChild",value:function(t){if(pP(this.path)){var n=this.children.subtree(new aP(t));return n.isEmpty()?null:n.value?new AD(this.source,oP(),n.value):new e(this.source,oP(),n)}return bt(uP(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,cP(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),DD=function(){function e(t,n,r){f(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return y(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(pP(e))return this.isFullyInitialized()&&!this.filtered_;var t=uP(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),OD=y((function e(t){f(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()}));function LD(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw xt("Should only compare child_ events.");var r=new TP(t.childName,t.snapshotNode),i=new TP(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function MD(e,t){return{eventCache:e,serverCache:t}}function FD(e,t,n,r){return MD(new DD(t,n,r),e.serverCache)}function UD(e,t,n,r){return MD(e.eventCache,new DD(t,n,r))}function VD(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function jD(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var qD=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(CD||(CD=new OP(bA)),CD);f(this,e),this.value=t,this.children=n}return y(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:oP(),value:this.value};if(pP(e))return null;var n=uP(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(cP(e),t);return null!=i?{path:dP(new aP(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(pP(t))return this;var n=uP(t),r=this.children.get(n);return null!==r?r.subtree(cP(t)):new e(null)}},{key:"set",value:function(t,n){if(pP(t))return new e(n,this.children);var r=uP(t),i=(this.children.get(r)||new e(null)).set(cP(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(pP(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=uP(t),r=this.children.get(n);if(r){var i,a=r.remove(cP(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(pP(e))return this.value;var t=uP(e),n=this.children.get(t);return n?n.get(cP(e)):null}},{key:"setTree",value:function(t,n){if(pP(t))return n;var r,i=uP(t),a=(this.children.get(i)||new e(null)).setTree(cP(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(oP(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(dP(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,oP(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(pP(e))return null;var i=uP(e),a=this.children.get(i);return a?a.findOnPath_(cP(e),dP(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,oP(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(pP(t))return this;this.value&&r(n,this.value);var i=uP(t),a=this.children.get(i);return a?a.foreachOnPath_(cP(t),dP(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(oP(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(dP(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return TA(t,(function(e,t){n=n.set(new aP(e),t)})),n}}]),e}(),BD=function(){function e(t){f(this,e),this.writeTree_=t}return y(e,null,[{key:"empty",value:function(){return new e(new qD(null))}}]),e}();function zD(e,t,n){if(pP(t))return new BD(new qD(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=vP(i,t);return a=a.updateChild(o,n),new BD(e.writeTree_.set(i,a))}var u=new qD(n),s=e.writeTree_.setTree(t,u);return new BD(s)}function WD(e,t,n){var r=e;return TA(n,(function(e,n){r=zD(r,dP(t,e),n)})),r}function HD(e,t){if(pP(t))return BD.empty();var n=e.writeTree_.setTree(t,new qD(null));return new BD(n)}function KD(e,t){return null!=GD(e,t)}function GD(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(vP(n.path,t)):null}function QD(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(KP,(function(e,n){t.push(new TP(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new TP(e,n.value))})),t}function YD(e,t){if(pP(t))return e;var n=GD(e,t);return new BD(null!=n?new qD(n):e.writeTree_.subtree(t))}function XD(e){return e.writeTree_.isEmpty()}function $D(e,t){return JD(oP(),e.writeTree_,t)}function JD(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(bt(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=JD(dP(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(dP(e,".priority"),r)),n}function ZD(e,t){return fO(t,e)}function eO(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));bt(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var u=e.allWrites[o];u.visible&&(o>=n&&tO(u,r.path)?i=!1:gP(r.path,u.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=rO(e.allWrites,nO,oP()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=HD(e.visibleWrites,r.path):TA(r.children,(function(t){e.visibleWrites=HD(e.visibleWrites,dP(r.path,t))}));return!0}return!1}function tO(e,t){if(e.snap)return gP(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&gP(dP(e.path,n),t))return!0;return!1}function nO(e){return e.visible}function rO(e,t,n){for(var r=BD.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,u=void 0;if(a.snap)gP(n,o)?r=zD(r,u=vP(n,o),a.snap):gP(o,n)&&(u=vP(o,n),r=zD(r,oP(),a.snap.getChild(u)));else{if(!a.children)throw xt("WriteRecord should have .snap or .children");if(gP(n,o))r=WD(r,u=vP(n,o),a.children);else if(gP(o,n))if(pP(u=vP(o,n)))r=WD(r,oP(),a.children);else{var s=$t(a.children,uP(u));if(s){var c=s.getChild(cP(u));r=zD(r,oP(),c)}}}}}return r}function iO(e,t,n,r,i){if(r||i){var a=YD(e.visibleWrites,t);if(!i&&XD(a))return n;if(i||null!=n||KD(a,oP())){return $D(rO(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(gP(e.path,t)||gP(t,e.path))}),t),n||JP.EMPTY_NODE)}return null}var o=GD(e.visibleWrites,t);if(null!=o)return o;var u=YD(e.visibleWrites,t);return XD(u)?n:null!=n||KD(u,oP())?$D(u,n||JP.EMPTY_NODE):null}function aO(e,t,n,r){return iO(e.writeTree,e.treePath,t,n,r)}function oO(e,t){return function(e,t,n){var r=JP.EMPTY_NODE,i=GD(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(KP,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=YD(e.visibleWrites,t);return n.forEachChild(KP,(function(e,t){var n=$D(YD(a,new aP(e)),t);r=r.updateImmediateChild(e,n)})),QD(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return QD(YD(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function uO(e,t,n,r){return function(e,t,n,r,i){bt(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=dP(t,n);if(KD(e.visibleWrites,a))return null;var o=YD(e.visibleWrites,a);return XD(o)?i.getChild(n):$D(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function sO(e,t){return function(e,t){return GD(e.visibleWrites,t)}(e.writeTree,dP(e.treePath,t))}function cO(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var u,s=YD(e.visibleWrites,t),c=GD(s,oP());if(null!=c)u=c;else{if(null==n)return[];u=$D(s,n)}if((u=u.withIndex(o)).isEmpty()||u.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function lO(e,t,n){return function(e,t,n,r){var i=dP(t,n),a=GD(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?$D(YD(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function hO(e,t){return fO(dP(e.treePath,t),e.writeTree)}function fO(e,t){return{treePath:e,writeTree:t}}var dO=function(){function e(){f(this,e),this.changeMap=new Map}return y(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;bt("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),bt(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,sD(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,uD(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,oD(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw xt("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,sD(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),pO=new(function(){function e(){f(this,e)}return y(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),vO=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;f(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return y(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new DD(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return lO(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:jD(this.viewCache_),i=cO(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();function yO(e,t,n,r,i){var a,o,u=new dO;if(n.type===ID.OVERWRITE){var s=n;s.source.fromUser?a=kO(e,t,s.path,s.snap,r,i,u):(bt(s.source.fromServer,"Unknown source."),o=s.source.tagged||t.serverCache.isFiltered()&&!pP(s.path),a=gO(e,t,s.path,s.snap,r,i,o,u))}else if(n.type===ID.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var u=t;return r.foreach((function(r,s){var c=dP(n,r);_O(t,uP(c))&&(u=kO(e,u,c,s,i,a,o))})),r.foreach((function(r,s){var c=dP(n,r);_O(t,uP(c))||(u=kO(e,u,c,s,i,a,o))})),u}(e,t,c.path,c.children,r,i,u):(bt(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=bO(e,t,c.path,c.children,r,i,o,u))}else if(n.type===ID.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=sO(r,n))return t;var u,s=new vO(r,t,i),c=t.eventCache.getNode();if(pP(n)||".priority"===uP(n)){var l;if(t.serverCache.isFullyInitialized())l=aO(r,jD(t));else{var h=t.serverCache.getNode();bt(h instanceof JP,"serverChildren would be complete if leaf node"),l=oO(r,h)}u=e.filter.updateFullNode(c,l,a)}else{var f=uP(n),d=lO(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(u=null!=d?e.filter.updateChild(c,f,d,cP(n),s,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,JP.EMPTY_NODE,cP(n),s,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=aO(r,jD(t))).isLeafNode()&&(u=e.filter.updateFullNode(u,o,a))}return o=t.serverCache.isFullyInitialized()||null!=sO(r,oP()),FD(t,u,o,e.filter.filtersNodes())}(e,t,l.path,r,i,u):function(e,t,n,r,i,a,o){if(null!=sO(i,n))return t;var u=t.serverCache.isFiltered(),s=t.serverCache;if(null!=r.value){if(pP(n)&&s.isFullyInitialized()||s.isCompleteForPath(n))return gO(e,t,n,s.getNode().getChild(n),i,a,u,o);if(pP(n)){var c=new qD(null);return s.getNode().forEachChild(NP,(function(e,t){c=c.set(new aP(e),t)})),bO(e,t,n,c,i,a,u,o)}return t}var l=new qD(null);return r.foreach((function(e,t){var r=dP(n,e);s.isCompleteForPath(r)&&(l=l.set(e,s.getNode().getChild(r)))})),bO(e,t,n,l,i,a,u,o)}(e,t,l.path,l.affectedTree,r,i,u)}else{if(n.type!==ID.LISTEN_COMPLETE)throw xt("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=UD(t,a.getNode(),a.isFullyInitialized()||pP(n),a.isFiltered());return mO(e,o,n,r,pO,i)}(e,t,n.path,r,u)}var h=u.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=VD(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(aD(VD(t)))}}(t,a,h),{viewCache:a,changes:h}}function mO(e,t,n,r,i,a){var o,u,s=t.eventCache;if(null!=sO(r,n))return t;if(pP(n))if(bt(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=jD(t),l=oO(r,c instanceof JP?c:JP.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=aO(r,jD(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=uP(n);if(".priority"===f){bt(1===sP(n),"Can't have a priority with additional path components");var d=s.getNode(),p=uO(r,n,d,u=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):s.getNode()}else{var v,y=cP(n);if(s.isCompleteForChild(f)){u=t.serverCache.getNode();var m=uO(r,n,s.getNode(),u);v=null!=m?s.getNode().getImmediateChild(f).updateChild(y,m):s.getNode().getImmediateChild(f)}else v=lO(r,f,t.serverCache);o=null!=v?e.filter.updateChild(s.getNode(),f,v,y,i,a):s.getNode()}}return FD(t,o,s.isFullyInitialized()||pP(n),e.filter.filtersNodes())}function gO(e,t,n,r,i,a,o,u){var s,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(pP(n))s=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);s=l.updateFullNode(c.getNode(),h,null)}else{var f=uP(n);if(!c.isCompleteForPath(n)&&sP(n)>1)return t;var d=cP(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);s=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,pO,null)}var v=UD(t,s,c.isFullyInitialized()||pP(n),l.filtersNodes());return mO(e,v,n,i,new vO(i,v,a),u)}function kO(e,t,n,r,i,a,o){var u,s,c=t.eventCache,l=new vO(i,t,a);if(pP(n))s=e.filter.updateFullNode(t.eventCache.getNode(),r,o),u=FD(t,s,!0,e.filter.filtersNodes());else{var h=uP(n);if(".priority"===h)s=e.filter.updatePriority(t.eventCache.getNode(),r),u=FD(t,s,c.isFullyInitialized(),c.isFiltered());else{var f,d=cP(n),p=c.getNode().getImmediateChild(h);if(pP(d))f=r;else{var v=l.getCompleteChild(h);f=null!=v?".priority"===lP(d)&&v.getChild(fP(d)).isEmpty()?v:v.updateChild(d,r):JP.EMPTY_NODE}if(p.equals(f))u=t;else u=FD(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return u}function _O(e,t){return e.eventCache.isCompleteForChild(t)}function wO(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function bO(e,t,n,r,i,a,o,u){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var s,c=t;s=pP(n)?r:new qD(null).setTree(n,r);var l=t.serverCache.getNode();return s.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var s=wO(0,t.serverCache.getNode().getImmediateChild(n),r);c=gO(e,c,new aP(n),s,i,a,o,u)}})),s.children.inorderTraversal((function(n,r){var s=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!s){var h=wO(0,t.serverCache.getNode().getImmediateChild(n),r);c=gO(e,c,new aP(n),h,i,a,o,u)}})),c}var xO,IO=function(){function e(t,n){f(this,e),this.query_=t,this.eventRegistrations_=[];var r,i=this.query_._queryParams,a=new cD(i.getIndex()),o=(r=i).loadsAllData()?new cD(r.getIndex()):r.hasLimit()?new hD(r):new lD(r);this.processor_=function(e){return{filter:e}}(o);var u=n.serverCache,s=n.eventCache,c=a.updateFullNode(JP.EMPTY_NODE,u.getNode(),null),l=o.updateFullNode(JP.EMPTY_NODE,s.getNode(),null),h=new DD(c,u.isFullyInitialized(),a.filtersNodes()),d=new DD(l,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=MD(d,h),this.eventGenerator_=new OD(this.query_)}return y(e,[{key:"query",get:function(){return this.query_}}]),e}();function EO(e,t){var n=jD(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!pP(t)&&!n.getImmediateChild(uP(t)).isEmpty())?n.getChild(t):null}function TO(e){return 0===e.eventRegistrations_.length}function SO(e,t,n){var r=[];if(n){bt(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],o=0;o<e.eventRegistrations_.length;++o){var u=e.eventRegistrations_[o];if(u.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(o+1));break}}else a.push(u)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function CO(e,t,n,r){t.type===ID.MERGE&&null!==t.source.queryId&&(bt(jD(e.viewCache_),"We should always have a full cache before handling merges"),bt(VD(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,u=yO(e.processor_,o,t,n,r);return i=e.processor_,a=u.viewCache,bt(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),bt(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),bt(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=u.viewCache,NO(e,u.changes,u.viewCache.eventCache.getNode(),null)}function NO(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),LD(e,i,"child_removed",t,r,n),LD(e,i,"child_added",t,r,n),LD(e,i,"child_moved",a,r,n),LD(e,i,"child_changed",t,r,n),LD(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var RO,AO=y((function e(){f(this,e),this.views=new Map}));function PO(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return bt(null!=a,"SyncTree gave us an op for an invalid query."),CO(a,t,n,r)}var o,u=[],s=T(e.views.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u=u.concat(CO(c,t,n,r))}}catch(l){s.e(l)}finally{s.f()}return u}function DO(e,t,n,r,i){var a=t._queryIdentifier,o=e.views.get(a);if(!o){var u=aO(n,i?r:null),s=!1;u?s=!0:r instanceof JP?(u=oO(n,r),s=!1):(u=JP.EMPTY_NODE,s=!1);var c=MD(new DD(u,s,!1),new DD(r,i,!1));return new IO(t,c)}return o}function OO(e,t,n,r,i,a){var o=DO(e,t,r,i,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(KP,(function(e,t){r.push(oD(e,t))})),n.isFullyInitialized()&&r.push(aD(n.getNode())),NO(e,r,n.getNode(),t)}(o,n)}function LO(e,t,n,r){var i=t._queryIdentifier,a=[],o=[],u=jO(e);if("default"===i){var s,l=T(e.views.entries());try{for(l.s();!(s=l.n()).done;){var h=c(s.value,2),f=h[0],d=h[1];o=o.concat(SO(d,n,r)),TO(d)&&(e.views.delete(f),d.query._queryParams.loadsAllData()||a.push(d.query))}}catch(v){l.e(v)}finally{l.f()}}else{var p=e.views.get(i);p&&(o=o.concat(SO(p,n,r)),TO(p)&&(e.views.delete(i),p.query._queryParams.loadsAllData()||a.push(p.query)))}return u&&!jO(e)&&a.push(new(bt(xO,"Reference.ts has not been loaded"),xO)(t._repo,t._path)),{removed:a,events:o}}function MO(e){var t,n=[],r=T(e.views.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.query._queryParams.loadsAllData()||n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}function FO(e,t){var n,r=null,i=T(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||EO(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}function UO(e,t){if(t._queryParams.loadsAllData())return qO(e);var n=t._queryIdentifier;return e.views.get(n)}function VO(e,t){return null!=UO(e,t)}function jO(e){return null!=qO(e)}function qO(e){var t,n=T(e.views.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.query._queryParams.loadsAllData())return r}}catch(i){n.e(i)}finally{n.f()}return null}var BO=1,zO=y((function e(t){f(this,e),this.listenProvider_=t,this.syncPointTree_=new qD(null),this.pendingWriteTree_={visibleWrites:BD.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function WO(e,t,n,r,i){return function(e,t,n,r,i){bt(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=zD(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?ZO(e,new AD({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function HO(e,t,n,r){!function(e,t,n,r){bt(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=WD(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=qD.fromObject(n);return ZO(e,new PD({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function KO(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(eO(e.pendingWriteTree_,t)){var i=new qD(null);return null!=r.snap?i=i.set(oP(),!0):TA(r.children,(function(e){i=i.set(new aP(e),!0)})),ZO(e,new ND(r.path,i,n))}return[]}function GO(e,t,n){return ZO(e,new AD({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function QO(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t._path,o=e.syncPointTree_.get(a),u=[];if(o&&("default"===t._queryIdentifier||VO(o,t))){var s=LO(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(a));var c=s.removed;if(u=s.events,!i){var l=-1!==c.findIndex((function(e){return e._queryParams.loadsAllData()})),h=e.syncPointTree_.findOnPath(a,(function(e,t){return jO(t)}));if(l&&!h){var f=e.syncPointTree_.subtree(a);if(!f.isEmpty())for(var d=function(e){return e.fold((function(e,t,n){if(t&&jO(t))return[qO(t)];var r=[];return t&&(r=MO(t)),TA(n,(function(e,t){r=r.concat(t)})),r}))}(f),p=0;p<d.length;++p){var v=d[p],y=v.query,m=nL(e,v);e.listenProvider_.startListening(sL(y),rL(e,y),m.hashFn,m.onComplete)}}if(!h&&c.length>0&&!r)if(l){e.listenProvider_.stopListening(sL(t),null)}else c.forEach((function(t){var n=e.queryToTagMap.get(iL(t));e.listenProvider_.stopListening(sL(t),n)}))}!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=iL(r),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}(e,c)}return u}function YO(e,t,n,r){var i=aL(e,r);if(null!=i){var a=oL(i),o=a.path,u=a.queryId,s=vP(o,t);return uL(e,o,new AD(SD(u),s,n))}return[]}function XO(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t._path,a=null,o=!1;e.syncPointTree_.foreachOnPath(i,(function(e,t){var n=vP(e,i);a=a||FO(t,n),o=o||jO(t)}));var u,s=e.syncPointTree_.get(i);(s?(o=o||jO(s),a=a||FO(s,oP())):(s=new AO,e.syncPointTree_=e.syncPointTree_.set(i,s)),null!=a)?u=!0:(u=!1,a=JP.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((function(e,t){var n=FO(t,oP());n&&(a=a.updateImmediateChild(e,n))})));var c=VO(s,t);if(!c&&!t._queryParams.loadsAllData()){var l=iL(t);bt(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=BO++;e.queryToTagMap.set(l,h),e.tagToQueryMap.set(h,l)}var f=OO(s,t,n,ZD(e.pendingWriteTree_,i),a,u);if(!c&&!o&&!r){var d=UO(s,t);f=f.concat(function(e,t,n){var r=t._path,i=rL(e,t),a=nL(e,n),o=e.listenProvider_.startListening(sL(t),i,a.hashFn,a.onComplete),u=e.syncPointTree_.subtree(r);if(i)bt(!jO(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var s=u.fold((function(e,t,n){if(!pP(e)&&t&&jO(t))return[qO(t).query];var r=[];return t&&(r=r.concat(MO(t).map((function(e){return e.query})))),TA(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<s.length;++c){var l=s[c];e.listenProvider_.stopListening(sL(l),rL(e,l))}return o}(e,t,d))}return f}function $O(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=FO(n,vP(e,t));if(r)return r}));return iO(r,t,i,n,!0)}function JO(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=vP(e,n);r=r||FO(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||FO(i,oP()):(i=new AO,e.syncPointTree_=e.syncPointTree_.set(n,i));var a=null!=r,o=a?new DD(r,!0,!1):null;return function(e){return VD(e.viewCache_)}(DO(i,t,ZD(e.pendingWriteTree_,t._path),a?o.getNode():JP.EMPTY_NODE,a))}function ZO(e,t){return eL(t,e.syncPointTree_,null,ZD(e.pendingWriteTree_,oP()))}function eL(e,t,n,r){if(pP(e.path))return tL(e,t,n,r);var i=t.get(oP());null==n&&null!=i&&(n=FO(i,oP()));var a=[],o=uP(e.path),u=e.operationForChild(o),s=t.children.get(o);if(s&&u){var c=n?n.getImmediateChild(o):null,l=hO(r,o);a=a.concat(eL(u,s,c,l))}return i&&(a=a.concat(PO(i,e,r,n))),a}function tL(e,t,n,r){var i=t.get(oP());null==n&&null!=i&&(n=FO(i,oP()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,u=hO(r,t),s=e.operationForChild(t);s&&(a=a.concat(tL(s,i,o,u)))})),i&&(a=a.concat(PO(i,e,r,n))),a}function nL(e,t){var n=t.query,r=rL(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||JP.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=aL(e,n);if(r){var i=oL(r),a=i.path,o=i.queryId,u=vP(a,t);return uL(e,a,new RD(SD(o),u))}return[]}(e,n._path,r):function(e,t){return ZO(e,new RD({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return QO(e,n,null,i)}}}function rL(e,t){var n=iL(t);return e.queryToTagMap.get(n)}function iL(e){return e._path.toString()+"$"+e._queryIdentifier}function aL(e,t){return e.tagToQueryMap.get(t)}function oL(e){var t=e.indexOf("$");return bt(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new aP(e.substr(0,t))}}function uL(e,t,n){var r=e.syncPointTree_.get(t);return bt(r,"Missing sync point for query tag that we're tracking"),PO(r,n,ZD(e.pendingWriteTree_,t),null)}function sL(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(bt(RO,"Reference.ts has not been loaded"),RO)(e._repo,e._path):e}var cL=function(){function e(t){f(this,e),this.node_=t}return y(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),lL=function(){function e(t,n){f(this,e),this.syncTree_=t,this.path_=n}return y(e,[{key:"getImmediateChild",value:function(t){var n=dP(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return $O(this.syncTree_,this.path_)}}]),e}(),hL=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},fL=function(e,t,n){return e&&"object"===typeof e?(bt(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?dL(e[".sv"],t,n):"object"===typeof e[".sv"]?pL(e[".sv"],t):void bt(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},dL=function(e,t,n){if("timestamp"===e)return n.timestamp;bt(!1,"Unexpected server value: "+e)},pL=function(e,t,n){e.hasOwnProperty("increment")||bt(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&bt(!1,"Unexpected increment value: "+r);var i=t.node();if(bt(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},vL=function(e,t,n,r){return mL(t,new lL(n,e),r)},yL=function(e,t,n){return mL(e,new cL(t),n)};function mL(e,t,n){var r,i=e.getPriority().val(),a=fL(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,u=fL(o.getValue(),t,n);return u!==o.getValue()||a!==o.getPriority().val()?new BP(u,tD(a)):e}var s=e;return r=s,a!==s.getPriority().val()&&(r=r.updatePriority(new BP(a))),s.forEachChild(KP,(function(e,i){var a=mL(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}var gL=y((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};f(this,e),this.name=t,this.parent=n,this.node=r}));function kL(e,t){for(var n=t instanceof aP?t:new aP(t),r=e,i=uP(n);null!==i;){var a=$t(r.node.children,i)||{children:{},childCount:0};r=new gL(i,r,a),i=uP(n=cP(n))}return r}function _L(e){return e.node.value}function wL(e,t){e.node.value=t,TL(e)}function bL(e){return e.node.childCount>0}function xL(e,t){TA(e.node.children,(function(n,r){t(new gL(n,e,r))}))}function IL(e,t,n,r){n&&!r&&t(e),xL(e,(function(e){IL(e,t,!0,r)})),n&&r&&t(e)}function EL(e){return new aP(null===e.parent?e.name:EL(e.parent)+"/"+e.name)}function TL(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===_L(e)&&!bL(e)}(n),i=Xt(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,TL(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,TL(e))}(e.parent,e.name,e)}var SL=/[\[\].#$\/\u0000-\u001F\u007F]/,CL=/[\[\].#$\u0000-\u001F\u007F]/,NL=10485760,RL=function(e){return"string"===typeof e&&0!==e.length&&!SL.test(e)},AL=function(e){return"string"===typeof e&&0!==e.length&&!CL.test(e)},PL=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!gA(e)||e&&"object"===typeof e&&Xt(e,".sv")},DL=function(e,t,n,r){r&&void 0===t||OL(hn(e,"value"),t,n)},OL=function e(t,n,r){var i=r instanceof aP?new kP(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+wP(i));if("function"===typeof n)throw new Error(t+"contains a function "+wP(i)+" with contents = "+n.toString());if(gA(n))throw new Error(t+"contains "+n.toString()+" "+wP(i));if("string"===typeof n&&n.length>NL/3&&pn(n)>NL)throw new Error(t+"contains a string greater than "+NL+" utf8 bytes "+wP(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,o=!1;if(TA(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!RL(n)))throw new Error(t+" contains an invalid key ("+n+") "+wP(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=pn(t),_P(e)}(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=pn(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&o)throw new Error(t+' contains ".value" child '+wP(i)+" in addition to actual children.")}},LL=function(e,t,n,r){if(!r||void 0!==t){var i=hn(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];TA(t,(function(e,t){var r=new aP(e);if(OL(i,t,dP(n,r)),".priority"===lP(r)&&!PL(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=hP(r=t[n]),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!RL(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(yP);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&gP(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}},ML=function(e,t,n){if(!n||void 0!==t){if(gA(t))throw new Error(hn(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!PL(t))throw new Error(hn(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},FL=function(e,t,n,r){if((!r||void 0!==n)&&!RL(n))throw new Error(hn(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},UL=function(e,t,n,r){if((!r||void 0!==n)&&!AL(n))throw new Error(hn(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},VL=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),UL(e,t,n,r)},jL=function(e,t){if(".info"===uP(t))throw new Error(e+" failed = Can't modify data under /.info/")},qL=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!RL(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),AL(e)}(n))throw new Error(hn(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},BL=y((function e(){f(this,e),this.eventLists_=[],this.recursionDepth_=0}));function zL(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||mP(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function WL(e,t,n){zL(e,n),KL(e,(function(e){return mP(e,t)}))}function HL(e,t,n){zL(e,n),KL(e,(function(e){return gP(e,t)||gP(t,e)}))}function KL(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(GL(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function GL(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();lA&&dA("event: "+n.toString()),RA(r)}}}var QL="repo_interrupt",YL=25,XL=function(){function e(t,n,r,i){f(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new BL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=_D(),this.transactionQueueTree_=new gL,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return y(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function $L(e,t,n){if(e.stats_=HA(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new gD(e.repoInfo_,(function(t,n,r,i){eM(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return tM(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Qt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new IP(e.repoInfo_,t,(function(t,n,r,i){eM(e,t,n,r,i)}),(function(t){tM(e,t)}),(function(t){!function(e,t){TA(t,(function(t,n){nM(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return WA[n]||(WA[n]=t()),WA[n]}(e.repoInfo_,(function(){return new TD(e.stats_,e.server_)})),e.infoData_=new kD,e.infoSyncTree_=new zO({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=GO(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),nM(e,"connected",!1),e.serverSyncTree_=new zO({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);HL(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function JL(e){var t=e.infoData_.getNode(new aP(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function ZL(e){return hL({timestamp:JL(e)})}function eM(e,t,n,r,i){e.dataUpdateCount++;var a=new aP(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var u=Zt(n,(function(e){return tD(e)}));o=function(e,t,n,r){var i=aL(e,r);if(i){var a=oL(i),o=a.path,u=a.queryId,s=vP(o,t),c=qD.fromObject(n);return uL(e,o,new PD(SD(u),s,c))}return[]}(e.serverSyncTree_,a,u,i)}else{var s=tD(n);o=YO(e.serverSyncTree_,a,s,i)}else if(r){var c=Zt(n,(function(e){return tD(e)}));o=function(e,t,n){var r=qD.fromObject(n);return ZO(e,new PD({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=tD(n);o=GO(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=dM(e,a)),HL(e.eventQueue_,h,o)}function tM(e,t){nM(e,"connected",t),!1===t&&function(e){cM(e,"onDisconnectEvents");var t=ZL(e),n=_D();xD(e.onDisconnect_,oP(),(function(r,i){var a=vL(r,i,e.serverSyncTree_,t);wD(n,r,a)}));var r=[];xD(n,oP(),(function(t,n){r=r.concat(GO(e.serverSyncTree_,t,n));var i=gM(e,t);dM(e,i)})),e.onDisconnect_=_D(),HL(e.eventQueue_,oP(),r)}(e)}function nM(e,t,n){var r=new aP("/.info/"+t),i=tD(n);e.infoData_.updateSnapshot(r,i);var a=GO(e.infoSyncTree_,r,i);HL(e.eventQueue_,r,a)}function rM(e){return e.nextWriteId_++}function iM(e,t,n,r,i){cM(e,"set",{path:t.toString(),value:n,priority:r});var a=ZL(e),o=tD(n,r),u=$O(e.serverSyncTree_,t),s=yL(o,u,a),c=rM(e),l=WO(e.serverSyncTree_,t,s,c,!0);zL(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),(function(n,r){var a="ok"===n;a||mA("set at "+t+" failed: "+n);var o=KO(e.serverSyncTree_,c,!a);HL(e.eventQueue_,t,o),lM(e,i,n,r)}));var h=gM(e,t);dM(e,h),HL(e.eventQueue_,h,[])}function aM(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&bD(e.onDisconnect_,t),lM(e,n,r,i)}))}function oM(e,t,n,r){var i=tD(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,a){"ok"===n&&wD(e.onDisconnect_,t,i),lM(e,r,n,a)}))}function uM(e,t,n){var r;r=".info"===uP(t._path)?QO(e.infoSyncTree_,t,n):QO(e.serverSyncTree_,t,n),WL(e.eventQueue_,t._path,r)}function sM(e){e.persistentConnection_&&e.persistentConnection_.interrupt(QL)}function cM(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];dA.apply(void 0,[t].concat(r))}function lM(e,t,n,r){t&&RA((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}}))}function hM(e,t,n){return $O(e.serverSyncTree_,t,n)||JP.EMPTY_NODE}function fM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||mM(e,t),_L(t)){var n=vM(e,t);bt(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=hM(e,t,r),a=i,o=i.hash(),u=0;u<n.length;u++){var s=n[u];bt(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;var c=vP(t,s.path);a=a.updateChild(c,s.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){cM(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(KO(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},u=0;u<n.length;u++)o(u);mM(e,kL(e.transactionQueueTree_,t)),fM(e,e.transactionQueueTree_),HL(e.eventQueue_,t,i);for(var s=0;s<a.length;s++)RA(a[s])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{mA("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}dM(e,t)}}),o)}(e,EL(t),n)}else bL(t)&&xL(t,(function(t){fM(e,t)}))}function dM(e,t){var n=pM(e,t),r=EL(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})),o=a.map((function(e){return e.currentWriteId})),u=function(a){var u,s,c=t[a],l=vP(n,c.path),h=!1;if(bt(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,i=i.concat(KO(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=YL)h=!0,u="maxretry",i=i.concat(KO(e.serverSyncTree_,c.currentWriteId,!0));else{var f=hM(e,c.path,o);c.currentInputSnapshot=f;var d=t[a].update(f.val());if(void 0!==d){OL("transaction failed: Data returned ",d,c.path);var p=tD(d);"object"===typeof d&&null!=d&&Xt(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=c.currentWriteId,y=ZL(e),m=yL(p,f,y);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=m,c.currentWriteId=rM(e),o.splice(o.indexOf(v),1),i=(i=i.concat(WO(e.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat(KO(e.serverSyncTree_,v,!0))}else h=!0,u="nodata",i=i.concat(KO(e.serverSyncTree_,c.currentWriteId,!0))}HL(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,s=t[a].unwatcher,setTimeout(s,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(u),!1,null)}))))},s=0;s<t.length;s++)u(s);mM(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)RA(r[c]);fM(e,e.transactionQueueTree_)}(e,vM(e,n),r),r}function pM(e,t){var n,r=e.transactionQueueTree_;for(n=uP(t);null!==n&&void 0===_L(r);)r=kL(r,n),n=uP(t=cP(t));return r}function vM(e,t){var n=[];return yM(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function yM(e,t,n){var r=_L(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);xL(t,(function(t){yM(e,t,n)}))}function mM(e,t){var n=_L(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,wL(t,n.length>0?n:void 0)}xL(t,(function(t){mM(e,t)}))}function gM(e,t){var n=EL(pM(e,t)),r=kL(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){kM(e,t)})),kM(e,r),IL(r,(function(t){kM(e,t)})),n}function kM(e,t){var n=_L(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(bt(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(bt(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(KO(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?wL(t,void 0):n.length=a+1,HL(e.eventQueue_,EL(t),i);for(var u=0;u<r.length;u++)RA(r[u])}}var _M=function(e,t){var n=wM(e),r=n.namespace;"firebase.com"===n.domain&&yA(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||yA("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&mA("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new jA(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new aP(n.pathString)}},wM=function(e){var t="",n="",r="",i="",a="",o=!0,u="https",s=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(u=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=T(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):mA("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===u||"wss"===u,s=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:u,pathString:i,namespace:a}},bM="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",xM=function(){var e=0,t=[];return function(n){var r,i=n===e;e=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=bM.charAt(n%64),n=Math.floor(n/64);bt(0===n,"Cannot push at time == 0");var o=a.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=bM.charAt(t[r]);return bt(20===o.length,"nextPushId: Length should be 20."),o}}(),IM=function(){function e(t,n,r,i){f(this,e),this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}return y(e,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+Qt(this.snapshot.exportVal())}}]),e}(),EM=function(){function e(t,n,r){f(this,e),this.eventRegistration=t,this.error=n,this.path=r}return y(e,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),e}(),TM=function(){function e(t,n){f(this,e),this.snapshotCallback=t,this.cancelCallback=n}return y(e,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return bt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),e}(),SM=function(){function e(t,n){f(this,e),this._repo=t,this._path=n}return y(e,[{key:"cancel",value:function(){var e=new Ot;return aM(this._repo,this._path,e.wrapCallback((function(){}))),e.promise}},{key:"remove",value:function(){jL("OnDisconnect.remove",this._path);var e=new Ot;return oM(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise}},{key:"set",value:function(e){jL("OnDisconnect.set",this._path),DL("OnDisconnect.set",e,this._path,!1);var t=new Ot;return oM(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}},{key:"setWithPriority",value:function(e,t){jL("OnDisconnect.setWithPriority",this._path),DL("OnDisconnect.setWithPriority",e,this._path,!1),ML("OnDisconnect.setWithPriority",t,!1);var n=new Ot;return function(e,t,n,r,i){var a=tD(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),(function(n,r){"ok"===n&&wD(e.onDisconnect_,t,a),lM(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise}},{key:"update",value:function(e){jL("OnDisconnect.update",this._path),LL("OnDisconnect.update",e,this._path,!1);var t=new Ot;return function(e,t,n,r){if(Jt(n))return dA("onDisconnect().update() called with empty data.  Don't do anything."),void lM(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,a){"ok"===i&&TA(n,(function(n,r){var i=tD(r);wD(e.onDisconnect_,dP(t,n),i)})),lM(0,r,i,a)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}}]),e}(),CM=function(){function e(t,n,r,i){f(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return y(e,[{key:"key",get:function(){return pP(this._path)?null:lP(this._path)}},{key:"ref",get:function(){return new PM(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=mD(this._queryParams),t=IA(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return mD(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=vn(t))instanceof e))return!1;var n=this._repo===t._repo,r=mP(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();function NM(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function RM(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===NP){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==kA)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==_A)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===KP){if(null!=t&&!PL(t)||null!=n&&!PL(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(bt(e.getIndex()instanceof nD||e.getIndex()===iD,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function AM(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var PM=function(e){g(n,e);var t=b(n);function n(e,r){return f(this,n),t.call(this,e,r,new fD,!1)}return y(n,[{key:"parent",get:function(){var e=fP(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(CM),DM=function(){function e(t,n,r){f(this,e),this._node=t,this.ref=n,this._index=r}return y(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(t){var n=new aP(t),r=MM(this.ref,t);return new e(this._node.getChild(n),r,KP)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,MM(n.ref,r),KP))}))}},{key:"hasChild",value:function(e){var t=new aP(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function OM(e,t){return(e=vn(e))._checkNotDeleted("ref"),void 0!==t?MM(e._root,t):e._root}function LM(e,t){(e=vn(e))._checkNotDeleted("refFromURL");var n=_M(t,e._repo.repoInfo_.nodeAdmin);qL("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||yA("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),OM(e,n.path.toString())}function MM(e,t){return null===uP((e=vn(e))._path)?VL("child","path",t,!1):UL("child","path",t,!1),new PM(e._repo,dP(e._path,t))}function FM(e,t){e=vn(e),jL("set",e._path),DL("set",t,e._path,!1);var n=new Ot;return iM(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function UM(e,t){LL("update",t,e._path,!1);var n=new Ot;return function(e,t,n,r){cM(e,"update",{path:t.toString(),value:n});var i=!0,a=ZL(e),o={};if(TA(n,(function(n,r){i=!1,o[n]=vL(dP(t,n),tD(r),e.serverSyncTree_,a)})),i)dA("update() called with empty data.  Don't do anything."),lM(0,r,"ok",void 0);else{var u=rM(e),s=HO(e.serverSyncTree_,t,o,u);zL(e.eventQueue_,s),e.server_.merge(t.toString(),n,(function(n,i){var a="ok"===n;a||mA("update at "+t+" failed: "+n);var o=KO(e.serverSyncTree_,u,!a),s=o.length>0?dM(e,t):t;HL(e.eventQueue_,s,o),lM(0,r,n,i)})),TA(n,(function(n){var r=gM(e,dP(t,n));dM(e,r)})),HL(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function VM(e){e=vn(e);var t=new TM((function(){})),n=new jM(t);return function(e,t,n){var r=JO(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((function(r){var i,a=tD(r).withIndex(t._queryParams.getIndex());if(XO(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())i=GO(e.serverSyncTree_,t._path,a);else{var o=rL(e.serverSyncTree_,t);i=YO(e.serverSyncTree_,t._path,a,o)}return HL(e.eventQueue_,t._path,i),QO(e.serverSyncTree_,t,n,null,!0),a}),(function(n){return cM(e,"get for query "+Qt(t)+" failed: "+n),Promise.reject(new Error(n))}))}(e._repo,e,n).then((function(t){return new DM(t,new PM(e._repo,e._path),e._queryParams.getIndex())}))}var jM=function(){function e(t){f(this,e),this.callbackContext=t}return y(e,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new IM("value",this,new DM(e.snapshotNode,new PM(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new EM(this,e,t):null}},{key:"matches",value:function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),e}(),qM=function(){function e(t,n){f(this,e),this.eventType=t,this.callbackContext=n}return y(e,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new EM(this,e,t):null}},{key:"createEvent",value:function(e,t){bt(null!=e.childName,"Child events should have a childName.");var n=MM(new PM(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new IM(e.type,this,new DM(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),e}();function BM(e,t,n,r,i){var a;if("object"===typeof r&&(a=void 0,i=r),"function"===typeof r&&(a=r),i&&i.onlyOnce){var o=n,u=function(t,n){uM(e._repo,e,c),o(t,n)};u.userCallback=n.userCallback,u.context=n.context,n=u}var s=new TM(n,a||void 0),c="value"===t?new jM(s):new qM(t,s);return function(e,t,n){var r;r=".info"===uP(t._path)?XO(e.infoSyncTree_,t,n):XO(e.serverSyncTree_,t,n),WL(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return uM(e._repo,e,c)}}function zM(e,t,n,r){return BM(e,"value",t,n,r)}function WM(e,t,n,r){return BM(e,"child_added",t,n,r)}function HM(e,t,n,r){return BM(e,"child_changed",t,n,r)}function KM(e,t,n,r){return BM(e,"child_moved",t,n,r)}function GM(e,t,n,r){return BM(e,"child_removed",t,n,r)}function QM(e,t,n){var r=null,i=n?new TM(n):null;"value"===t?r=new jM(i):t&&(r=new qM(t,i)),uM(e._repo,e,r)}var YM=y((function e(){f(this,e)})),XM=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._value=e,i._key=r,i}return y(n,[{key:"_apply",value:function(e){DL("endAt",this._value,e._path,!0);var t=pD(e._queryParams,this._value,this._key);if(AM(t),RM(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new CM(e._repo,e._path,t,e._orderByCalled)}}]),n}(YM);var $M=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._value=e,i._key=r,i}return y(n,[{key:"_apply",value:function(e){DL("endBefore",this._value,e._path,!1);var t=function(e,t,n){var r;return(r=e.index_===NP||n?pD(e,t,n):pD(e,t,kA)).endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(AM(t),RM(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new CM(e._repo,e._path,t,e._orderByCalled)}}]),n}(YM);var JM=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._value=e,i._key=r,i}return y(n,[{key:"_apply",value:function(e){DL("startAt",this._value,e._path,!0);var t=dD(e._queryParams,this._value,this._key);if(AM(t),RM(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new CM(e._repo,e._path,t,e._orderByCalled)}}]),n}(YM);var ZM=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._value=e,i._key=r,i}return y(n,[{key:"_apply",value:function(e){DL("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;return(r=e.index_===NP||n?dD(e,t,n):dD(e,t,_A)).startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(AM(t),RM(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new CM(e._repo,e._path,t,e._orderByCalled)}}]),n}(YM);var eF=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this))._limit=e,r}return y(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new CM(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(YM);var tF=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this))._limit=e,r}return y(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new CM(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(YM);var nF=function(e){g(n,e);var t=b(n);function n(e){var r;return f(this,n),(r=t.call(this))._path=e,r}return y(n,[{key:"_apply",value:function(e){NM(e,"orderByChild");var t=new aP(this._path);if(pP(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new nD(t),r=vD(e._queryParams,n);return RM(r),new CM(e._repo,e._path,r,!0)}}]),n}(YM);var rF=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"_apply",value:function(e){NM(e,"orderByKey");var t=vD(e._queryParams,NP);return RM(t),new CM(e._repo,e._path,t,!0)}}]),n}(YM);var iF=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"_apply",value:function(e){NM(e,"orderByPriority");var t=vD(e._queryParams,KP);return RM(t),new CM(e._repo,e._path,t,!0)}}]),n}(YM);var aF=function(e){g(n,e);var t=b(n);function n(){return f(this,n),t.apply(this,arguments)}return y(n,[{key:"_apply",value:function(e){NM(e,"orderByValue");var t=vD(e._queryParams,iD);return RM(t),new CM(e._repo,e._path,t,!0)}}]),n}(YM);var oF=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._value=e,i._key=r,i}return y(n,[{key:"_apply",value:function(e){if(DL("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new XM(this._value,this._key)._apply(new JM(this._value,this._key)._apply(e))}}]),n}(YM);function uF(e){for(var t=vn(e),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0,o=r;a<o.length;a++){t=o[a]._apply(t)}return t}!function(e){bt(!xO,"__referenceConstructor has already been defined"),xO=e}(PM),function(e){bt(!RO,"__referenceConstructor has already been defined"),RO=e}(PM);var sF="FIREBASE_DATABASE_EMULATOR_HOST",cF={},lF=!1;function hF(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||yA("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),dA("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,u=_M(a,i),s=u.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"/Make-Tasty-App",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[sF]),c?(o=!0,a="http://".concat(c,"?ns=").concat(s.namespace),s=(u=_M(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new OA(OA.OWNER):new DA(e.name,e.options,t);qL("Invalid Firebase Database URL",u),pP(u.path)||yA("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=cF[t.name];i||(i={},cF[t.name]=i);var a=i[e.toURLString()];a&&yA("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new XL(e,lF,n,r),i[e.toURLString()]=a,a}(s,e,l,new PA(e.name,n));return new fF(h,e)}var fF=function(){function e(t,n){f(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return y(e,[{key:"_repo",get:function(){return this._instanceStarted||($L(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new PM(this._repo,oP())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=cF[t];n&&n[e.key]===e||yA("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),sM(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&yA("Cannot call "+e+" on a deleted database.")}}]),e}();function dF(){JA.IS_TRANSPORT_INITIALIZED&&mA("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function pF(){dF(),QA.forceDisallow()}function vF(){dF(),$A.forceDisallow(),QA.forceAllow()}function yF(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=vn(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&yA("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&yA('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new OA(OA.OWNER);else if(r.mockUserToken){var o="string"===typeof r.mockUserToken?r.mockUserToken:Lt(r.mockUserToken,e.app.options.projectId);a=new OA(o)}!function(e,t,n,r){e.repoInfo_=new jA("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,a)}function mF(e){var t;(e=vn(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(QL)}function gF(e,t){fA(e,t)}var kF={".sv":"timestamp"};var _F=function(){function e(t,n){f(this,e),this.committed=t,this.snapshot=n}return y(e,[{key:"toJSON",value:function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}();function wF(e,t,n){var r;if(e=vn(e),jL("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new Ot,o=zM(e,(function(){}));return function(e,t,n,r,i,a){cM(e,"transaction on "+t);var o={path:t,update:n,onComplete:r,status:null,order:uA(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=hM(e,t,void 0);o.currentInputSnapshot=u;var s=o.update(u.val());if(void 0===s)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{OL("transaction failed: Data returned ",s,o.path),o.status=0;var c,l=kL(e.transactionQueueTree_,t),h=_L(l)||[];h.push(o),wL(l,h),"object"===typeof s&&null!==s&&Xt(s,".priority")?(c=$t(s,".priority"),bt(PL(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=($O(e.serverSyncTree_,t)||JP.EMPTY_NODE).getPriority().val();var f=ZL(e),d=tD(s,c),p=yL(d,u,f);o.currentOutputSnapshotRaw=d,o.currentOutputSnapshotResolved=p,o.currentWriteId=rM(e);var v=WO(e.serverSyncTree_,t,p,o.currentWriteId,o.applyLocally);HL(e.eventQueue_,t,v),fM(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?a.reject(t):(i=new DM(r,new PM(e._repo,e._path),KP),a.resolve(new _F(n,i)))}),o,i),a.promise}IP.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},IP.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){eA(vr),sr(new kn("database",(function(e,t){var n=t.instanceIdentifier;return hF(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),wr($R,JR,e),wr($R,JR,"esm2017")}();var bF=new Rn("@firebase/database-compat"),xF=function(e){var t="FIREBASE WARNING: "+e;bF.warn(t)},IF=function(){function e(t){f(this,e),this._delegate=t}return y(e,[{key:"cancel",value:function(e){ln("OnDisconnect.cancel",0,1,arguments.length),fn("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"remove",value:function(e){ln("OnDisconnect.remove",0,1,arguments.length),fn("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"set",value:function(e,t){ln("OnDisconnect.set",1,2,arguments.length),fn("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"setWithPriority",value:function(e,t,n){ln("OnDisconnect.setWithPriority",2,3,arguments.length),fn("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"update",value:function(e,t){if(ln("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,xF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fn("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}}]),e}(),EF=function(){function e(t,n){f(this,e),this.committed=t,this.snapshot=n}return y(e,[{key:"toJSON",value:function(){return ln("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}(),TF=function(){function e(t,n){f(this,e),this._database=t,this._delegate=n}return y(e,[{key:"val",value:function(){return ln("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}},{key:"exportVal",value:function(){return ln("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}},{key:"toJSON",value:function(){return ln("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"exists",value:function(){return ln("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}},{key:"child",value:function(t){return ln("DataSnapshot.child",0,1,arguments.length),t=String(t),UL("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))}},{key:"hasChild",value:function(e){return ln("DataSnapshot.hasChild",1,1,arguments.length),UL("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}},{key:"getPriority",value:function(){return ln("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}},{key:"forEach",value:function(t){var n=this;return ln("DataSnapshot.forEach",1,1,arguments.length),fn("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))}},{key:"hasChildren",value:function(){return ln("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}},{key:"key",get:function(){return this._delegate.key}},{key:"numChildren",value:function(){return ln("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}},{key:"getRef",value:function(){return ln("DataSnapshot.ref",0,0,arguments.length),new CF(this._database,this._delegate.ref)}},{key:"ref",get:function(){return this.getRef()}}]),e}(),SF=function(){function e(t,n){f(this,e),this.database=t,this._delegate=n}return y(e,[{key:"on",value:function(t,n,r,i){var a,o=this;ln("Query.on",2,4,arguments.length),fn("Query.on","callback",n,!1);var u=e.getCancelAndContextArgs_("Query.on",r,i),s=function(e,t){n.call(u.context,new TF(o.database,e),t)};s.userCallback=n,s.context=u.context;var c=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(t){case"value":return zM(this._delegate,s,c),n;case"child_added":return WM(this._delegate,s,c),n;case"child_removed":return GM(this._delegate,s,c),n;case"child_changed":return HM(this._delegate,s,c),n;case"child_moved":return KM(this._delegate,s,c),n;default:throw new Error(hn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}},{key:"off",value:function(e,t,n){if(ln("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(hn(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),fn("Query.off","callback",t,!0),dn("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,QM(this._delegate,e,r)}else QM(this._delegate,e)}},{key:"get",value:function(){var e=this;return VM(this._delegate).then((function(t){return new TF(e.database,t)}))}},{key:"once",value:function(t,n,r,i){var a=this;ln("Query.once",1,4,arguments.length),fn("Query.once","callback",n,!0);var o=e.getCancelAndContextArgs_("Query.once",r,i),u=new Ot,s=function(e,t){var r=new TF(a.database,e);n&&n.call(o.context,r,t),u.resolve(r)};s.userCallback=n,s.context=o.context;var c=function(e){o.cancel&&o.cancel.call(o.context,e),u.reject(e)};switch(t){case"value":zM(this._delegate,s,c,{onlyOnce:!0});break;case"child_added":WM(this._delegate,s,c,{onlyOnce:!0});break;case"child_removed":GM(this._delegate,s,c,{onlyOnce:!0});break;case"child_changed":HM(this._delegate,s,c,{onlyOnce:!0});break;case"child_moved":KM(this._delegate,s,c,{onlyOnce:!0});break;default:throw new Error(hn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise}},{key:"limitToFirst",value:function(t){return ln("Query.limitToFirst",1,1,arguments.length),new e(this.database,uF(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new eF(e)}(t)))}},{key:"limitToLast",value:function(t){return ln("Query.limitToLast",1,1,arguments.length),new e(this.database,uF(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new tF(e)}(t)))}},{key:"orderByChild",value:function(t){return ln("Query.orderByChild",1,1,arguments.length),new e(this.database,uF(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return UL("orderByChild","path",e,!1),new nF(e)}(t)))}},{key:"orderByKey",value:function(){return ln("Query.orderByKey",0,0,arguments.length),new e(this.database,uF(this._delegate,new rF))}},{key:"orderByPriority",value:function(){return ln("Query.orderByPriority",0,0,arguments.length),new e(this.database,uF(this._delegate,new iF))}},{key:"orderByValue",value:function(){return ln("Query.orderByValue",0,0,arguments.length),new e(this.database,uF(this._delegate,new aF))}},{key:"startAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return ln("Query.startAt",0,2,arguments.length),new e(this.database,uF(this._delegate,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return FL("startAt","key",t,!0),new JM(e,t)}(t,n)))}},{key:"startAfter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return ln("Query.startAfter",0,2,arguments.length),new e(this.database,uF(this._delegate,function(e,t){return FL("startAfter","key",t,!0),new ZM(e,t)}(t,n)))}},{key:"endAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return ln("Query.endAt",0,2,arguments.length),new e(this.database,uF(this._delegate,function(e,t){return FL("endAt","key",t,!0),new XM(e,t)}(t,n)))}},{key:"endBefore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return ln("Query.endBefore",0,2,arguments.length),new e(this.database,uF(this._delegate,function(e,t){return FL("endBefore","key",t,!0),new $M(e,t)}(t,n)))}},{key:"equalTo",value:function(t,n){return ln("Query.equalTo",1,2,arguments.length),new e(this.database,uF(this._delegate,function(e,t){return FL("equalTo","key",t,!0),new oF(e,t)}(t,n)))}},{key:"toString",value:function(){return ln("Query.toString",0,0,arguments.length),this._delegate.toString()}},{key:"toJSON",value:function(){return ln("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"isEqual",value:function(t){if(ln("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(t._delegate)}},{key:"ref",get:function(){return new CF(this.database,new PM(this._delegate._repo,this._delegate._path))}}],[{key:"getCancelAndContextArgs_",value:function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,fn(e,"cancel",r.cancel,!0),r.context=n,dn(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(hn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}}]),e}(),CF=function(e){g(n,e);var t=b(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,new CM(r._repo,r._path,new fD,!1))).database=e,i._delegate=r,i}return y(n,[{key:"getKey",value:function(){return ln("Reference.key",0,0,arguments.length),this._delegate.key}},{key:"child",value:function(e){return ln("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new n(this.database,MM(this._delegate,e))}},{key:"getParent",value:function(){ln("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new n(this.database,e):null}},{key:"getRoot",value:function(){return ln("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}},{key:"set",value:function(e,t){ln("Reference.set",1,2,arguments.length),fn("Reference.set","onComplete",t,!0);var n=FM(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"update",value:function(e,t){if(ln("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,xF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}jL("Reference.update",this._delegate._path),fn("Reference.update","onComplete",t,!0);var i=UM(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}},{key:"setWithPriority",value:function(e,t,n){ln("Reference.setWithPriority",2,3,arguments.length),fn("Reference.setWithPriority","onComplete",n,!0);var r=function(e,t,n){if(jL("setWithPriority",e._path),DL("setWithPriority",t,e._path,!1),ML("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new Ot;return iM(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"remove",value:function(e){ln("Reference.remove",0,1,arguments.length),fn("Reference.remove","onComplete",e,!0);var t,n=(t=this._delegate,jL("remove",t._path),FM(t,null));return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n}},{key:"transaction",value:function(e,t,n){var r=this;ln("Reference.transaction",1,3,arguments.length),fn("Reference.transaction","transactionUpdate",e,!1),fn("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(hn(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);var i=wF(this._delegate,e,{applyLocally:n}).then((function(e){return new EF(e.committed,new TF(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i}},{key:"setPriority",value:function(e,t){ln("Reference.setPriority",1,2,arguments.length),fn("Reference.setPriority","onComplete",t,!0);var n=function(e,t){e=vn(e),jL("setPriority",e._path),ML("setPriority",t,!1);var n=new Ot;return iM(e._repo,dP(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"push",value:function(e,t){var r=this;ln("Reference.push",0,2,arguments.length),fn("Reference.push","onComplete",t,!0);var i=function(e,t){e=vn(e),jL("push",e._path),DL("push",t,e._path,!0);var n,r=JL(e._repo),i=xM(r),a=MM(e,i),o=MM(e,i);return n=null!=t?FM(o,t).then((function(){return o})):Promise.resolve(o),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}(this._delegate,e),a=i.then((function(e){return new n(r.database,e)}));t&&a.then((function(){return t(null)}),(function(e){return t(e)}));var o=new n(this.database,i);return o.then=a.then.bind(a),o.catch=a.catch.bind(a,void 0),o}},{key:"onDisconnect",value:function(){return jL("Reference.onDisconnect",this._delegate._path),new IF(new SM(this._delegate._repo,this._delegate._path))}},{key:"key",get:function(){return this.getKey()}},{key:"parent",get:function(){return this.getParent()}},{key:"root",get:function(){return this.getRoot()}}]),n}(SF),NF=function(){function e(t,n){var r=this;f(this,e),this._delegate=t,this.app=n,this.INTERNAL={delete:function(){return r._delegate._delete()},forceWebSockets:pF,forceLongPolling:vF}}return y(e,[{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};yF(this._delegate,e,t,n)}},{key:"ref",value:function(e){if(ln("database.ref",0,1,arguments.length),e instanceof CF){var t=LM(this._delegate,e.toString());return new CF(this,t)}var n=OM(this._delegate,e);return new CF(this,n)}},{key:"refFromURL",value:function(e){ln("database.refFromURL",1,1,arguments.length);var t=LM(this._delegate,e);return new CF(this,t)}},{key:"goOffline",value:function(){return ln("database.goOffline",0,0,arguments.length),function(e){(e=vn(e))._checkNotDeleted("goOffline"),sM(e._repo)}(this._delegate)}},{key:"goOnline",value:function(){return ln("database.goOnline",0,0,arguments.length),mF(this._delegate)}}]),e}();NF.ServerValue={TIMESTAMP:kF,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}};var RF=Object.freeze({__proto__:null,initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,a=e.namespace,o=e.nodeAdmin,u=void 0!==o&&o;eA(r);var s=new wn("auth-internal",new In("database-standalone"));return s.setComponent(new kn("auth-internal",(function(){return i}),"PRIVATE")),{instance:new NF(hF(t,s,void 0,n,u),t),namespace:a}}}),AF=NF.ServerValue;!function(e){e.INTERNAL.registerComponent(new kn("database-compat",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new NF(i,r)}),"PUBLIC").setServiceProps({Reference:CF,Query:SF,Database:NF,DataSnapshot:TF,enableLogging:gF,INTERNAL:RF,ServerValue:AF}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.3.4")}(Gr);var PF=Gr.initializeApp({apiKey:"AIzaSyDWtgGjBPgSKm0qWbo6WEF96ZGgVtDCxSQ",authDomain:"make-tasty.firebaseapp.com",projectId:"make-tasty",storageBucket:"make-tasty.appspot.com",messagingSenderId:"493037319332",appId:"1:493037319332:web:55f00a60582ca04026a231",measurementId:"G-SK83GVSEVZ"});i.createRoot(document.getElementById("root")).render((0,Qe.jsx)(Ye.Provider,{value:{firebase:PF},children:(0,Qe.jsx)($e,{children:(0,Qe.jsx)(mt,{})})}))}()}();
//# sourceMappingURL=main.aa7c38f3.js.map